swagger: "2.0"
info: { title: "LIT Gateway â€” Search Unified", version: "v2" }
schemes: ["https"]
produces: ["application/json"]

paths:
  /public/status:
    options:
      operationId: cors_status
      security: []
      x-google-backend: { address: __SERVICE_URL__, jwt_audience: __SERVICE_URL__ }
      responses: { "200": { description: "ok" } }
    get:
      operationId: status
      security: []
      x-google-backend: { address: __SERVICE_URL__, jwt_audience: __SERVICE_URL__ }
      responses: { "200": { description: "ok" } }

  /public/getFilterOptions:
    options:
      operationId: cors_getFilterOptions
      security: []
      x-google-backend: { address: __SERVICE_URL__, jwt_audience: __SERVICE_URL__ }
      responses: { "200": { description: "ok" } }
    get:
      operationId: getFilterOptions
      security: []
      x-google-backend: { address: __SERVICE_URL__, jwt_audience: __SERVICE_URL__ }
      responses: { "200": { description: "ok" } }

  /public/searchCompanies:
    options:
      operationId: cors_searchCompanies
      security: []
      x-google-backend: { address: __SERVICE_URL__, jwt_audience: __SERVICE_URL__ }
      responses: { "200": { description: "ok" } }
    post:
      operationId: searchCompanies
      security: []
      x-google-backend: { address: __SERVICE_URL__, jwt_audience: __SERVICE_URL__ }
      parameters:
        - in: body
          name: body
          required: true
          schema:
            type: object
            properties:
              q:        { type: string }
              page:     { type: integer }
              pageSize: { type: integer }
      responses: { "200": { description: "ok" } }

  /public/getCompanyShipments:
    options:
      operationId: cors_getCompanyShipments
      security: []
      x-google-backend: { address: __SERVICE_URL__, jwt_audience: __SERVICE_URL__ }
      responses: { "200": { description: "ok" } }
    get:
      operationId: getCompanyShipments
      security: []
      x-google-backend: { address: __SERVICE_URL__, jwt_audience: __SERVICE_URL__ }
      parameters:
        - { name: company_id, in: query, type: string, required: true }
        - { name: limit,      in: query, type: integer, required: false }
        - { name: offset,     in: query, type: integer, required: false }
      responses: { "200": { description: "ok" } }

  /public/iy/searchShippers:
    options:
      operationId: cors_iySearchShippers
      security: []
      x-google-backend: { address: __SERVICE_URL__, jwt_audience: __SERVICE_URL__ }
      responses: { "200": { description: "ok" } }
    post:
      operationId: iySearchShippers
      security: []
      x-google-backend: { address: __SERVICE_URL__, jwt_audience: __SERVICE_URL__ }
      parameters:
        - in: body
          name: body
          required: true
          schema:
            type: object
            properties:
              q:        { type: string }
              page:     { type: integer }
              pageSize: { type: integer }
      responses: { "200": { description: "ok" } }

  /public/iy/companyBols:
    options:
      operationId: cors_iyCompanyBols
      security: []
      x-google-backend: { address: __SERVICE_URL__, jwt_audience: __SERVICE_URL__ }
      responses: { "200": { description: "ok" } }
    get:
      operationId: iyCompanyBols
      security: []
      x-google-backend: { address: __SERVICE_URL__, jwt_audience: __SERVICE_URL__ }
      parameters:
        - { name: company_id, in: query, type: string,  required: true }
        - { name: limit,      in: query, type: integer, required: false }
        - { name: offset,     in: query, type: integer, required: false }
      responses: { "200": { description: "ok" } }

  /public/iy/companyProfile:
    get:
      summary: Get ImportYeti company profile (normalized)
      operationId: getIyCompanyProfile
      parameters:
        - name: company_id
          in: query
          required: true
          type: string
          description: "Company key, e.g. company/walmart"
            responses:
        "200":
          description: Company profile
          schema:
            type: object
        "400":
          description: Upstream ImportYeti error (auth/credits/etc.)
        "500":
          description: Internal error

      x-google-backend:
        # Use the SAME address as your other /public/iy/* routes
        address: https://search-unified-<YOUR-SERVICE-HASH>-uc.a.run.app
        path_translation: APPEND_PATH_TO_ADDRESS
      x-google-cors:
        allowOrigins: ["*"]
        allowMethods: ["GET", "OPTIONS"]
        allowHeaders: ["content-type", "authorization", "x-api-key"]

  /public/iy/companyLatestBol:
    options:
      operationId: cors_iyCompanyLatestBol
      security: []
      x-google-backend: { address: __SERVICE_URL__, jwt_audience: __SERVICE_URL__ }
      responses: { "200": { description: "ok" } }
    get:
      operationId: iyCompanyLatestBol
      security: []
      x-google-backend: { address: __SERVICE_URL__, jwt_audience: __SERVICE_URL__ }
      parameters:
        - { name: company, in: query, type: string, required: true }
      responses: { "200": { description: "ok" } }

  /public/iy/companyStats:
    options:
      operationId: cors_iyCompanyStats
      security: []
      x-google-backend: { address: __SERVICE_URL__, jwt_audience: __SERVICE_URL__ }
      responses: { "200": { description: "ok" } }
    get:
      operationId: iyCompanyStats
      security: []
      x-google-backend: { address: __SERVICE_URL__, jwt_audience: __SERVICE_URL__ }
      parameters:
        - { name: company, in: query, type: string, required: true }
        - { name: range, in: query, type: string, required: false }
      responses: { "200": { description: "ok" } }

