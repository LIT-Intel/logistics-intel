var Oe=t=>{throw TypeError(t)};var he=(t,s,r)=>s.has(t)||Oe("Cannot "+r);var a=(t,s,r)=>(he(t,s,"read from private field"),r?r.call(t):s.get(t)),N=(t,s,r)=>s.has(t)?Oe("Cannot add the same private member more than once"):s instanceof WeakSet?s.add(t):s.set(t,r),g=(t,s,r,i)=>(he(t,s,"write to private field"),i?i.call(t,r):s.set(t,r),r),y=(t,s,r)=>(he(t,s,"access private method"),r);import{S as mt,p as Te,e as O,s as me,f as se,n as xe,i as fe,h as De,t as xt,k as ce,l as ft,m as pt,o as Ue,q as He,r as h,v as gt,w as bt,j as e,x as yt,B as A,u as vt}from"./index-BmR0vpzv.js";import{User as jt}from"./entities-BF_CoRhL.js";import{I as Nt}from"./input-CifF0tnf.js";import{c as Pe}from"./index-A7ElDbZk.js";import{C as Ve}from"./circle-alert-CL17xs0V.js";import{B as Ke,A as St,C as wt,c as Ct}from"./CompanyDetailModal-B1Jn44qg.js";import{B as qe}from"./badge-mbvrvUdE.js";import{m as Ce}from"./proxy-DqViEuMF.js";import{B as pe}from"./building-2-DH0rhs0O.js";import{T as Ge}from"./trending-up-BiRvvY0v.js";import{C as We}from"./calendar-DZjZSV9o.js";import{S as Je}from"./ship-B_vL_mXG.js";import{L as Ze}from"./loader-circle-D6do2nsL.js";import{c as _e}from"./createLucideIcon-DHDzDx_v.js";import{f as Xe,M as Ye}from"./format-BdGktAaM.js";import{L as _t}from"./list-Dd7mZ1aY.js";import{C as Rt}from"./dropdown-menu-V_i5xLKc.js";import{U as Et}from"./UpgradePrompt-C-BHu7S9.js";import"./functions-7sdcJE3i.js";import{S as Ae}from"./search-Cmow_l64.js";import"./base44Client-C-YMJfZQ.js";import"./dialog-ht-RwzXs.js";import"./index-DMCx0746.js";import"./Combination-DKDTH7Vf.js";import"./index-COfBwzv4.js";import"./tabs-Cp_ulz7J.js";import"./index-CSBlQN7K.js";import"./truck-BRYqsMjm.js";import"./select-Cbc48yfk.js";import"./label-BY-IbUOt.js";import"./plus-BKHYaIzA.js";import"./textarea-1K8hNfDH.js";import"./users-BbIiUK-e.js";import"./message-square-CMNkUvf7.js";import"./trash-2-BiKZvKhI.js";import"./planLimits-C4PMM81i.js";import"./zap-DQXROfQI.js";import"./arrow-right-gOOVZBr_.js";var R,u,re,C,K,J,P,L,ae,Z,X,q,G,B,Y,x,te,ge,be,ye,ve,je,Ne,Se,et,ze,kt=(ze=class extends mt{constructor(s,r){super();N(this,x);N(this,R);N(this,u);N(this,re);N(this,C);N(this,K);N(this,J);N(this,P);N(this,L);N(this,ae);N(this,Z);N(this,X);N(this,q);N(this,G);N(this,B);N(this,Y,new Set);this.options=r,g(this,R,s),g(this,L,null),g(this,P,Te()),this.bindMethods(),this.setOptions(r)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(a(this,u).addObserver(this),Qe(a(this,u),this.options)?y(this,x,te).call(this):this.updateResult(),y(this,x,ve).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return we(a(this,u),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return we(a(this,u),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,y(this,x,je).call(this),y(this,x,Ne).call(this),a(this,u).removeObserver(this)}setOptions(s){const r=this.options,i=a(this,u);if(this.options=a(this,R).defaultQueryOptions(s),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof O(this.options.enabled,a(this,u))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");y(this,x,Se).call(this),a(this,u).setOptions(this.options),r._defaulted&&!me(this.options,r)&&a(this,R).getQueryCache().notify({type:"observerOptionsUpdated",query:a(this,u),observer:this});const l=this.hasListeners();l&&Le(a(this,u),i,this.options,r)&&y(this,x,te).call(this),this.updateResult(),l&&(a(this,u)!==i||O(this.options.enabled,a(this,u))!==O(r.enabled,a(this,u))||se(this.options.staleTime,a(this,u))!==se(r.staleTime,a(this,u)))&&y(this,x,ge).call(this);const o=y(this,x,be).call(this);l&&(a(this,u)!==i||O(this.options.enabled,a(this,u))!==O(r.enabled,a(this,u))||o!==a(this,B))&&y(this,x,ye).call(this,o)}getOptimisticResult(s){const r=a(this,R).getQueryCache().build(a(this,R),s),i=this.createResult(r,s);return Mt(this,i)&&(g(this,C,i),g(this,J,this.options),g(this,K,a(this,u).state)),i}getCurrentResult(){return a(this,C)}trackResult(s,r){return new Proxy(s,{get:(i,l)=>(this.trackProp(l),r==null||r(l),l==="promise"&&!this.options.experimental_prefetchInRender&&a(this,P).status==="pending"&&a(this,P).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),Reflect.get(i,l))})}trackProp(s){a(this,Y).add(s)}getCurrentQuery(){return a(this,u)}refetch({...s}={}){return this.fetch({...s})}fetchOptimistic(s){const r=a(this,R).defaultQueryOptions(s),i=a(this,R).getQueryCache().build(a(this,R),r);return i.fetch().then(()=>this.createResult(i,r))}fetch(s){return y(this,x,te).call(this,{...s,cancelRefetch:s.cancelRefetch??!0}).then(()=>(this.updateResult(),a(this,C)))}createResult(s,r){var ee;const i=a(this,u),l=this.options,o=a(this,C),d=a(this,K),S=a(this,J),n=s!==i?s.state:a(this,re),{state:b}=s;let c={...b},v=!1,f;if(r._optimisticResults){const w=this.hasListeners(),H=!w&&Qe(s,r),D=w&&Le(s,i,r,l);(H||D)&&(c={...c,...pt(b.data,s.options)}),r._optimisticResults==="isRestoring"&&(c.fetchStatus="idle")}let{error:F,errorUpdatedAt:T,status:j}=c;f=c.data;let M=!1;if(r.placeholderData!==void 0&&f===void 0&&j==="pending"){let w;o!=null&&o.isPlaceholderData&&r.placeholderData===(S==null?void 0:S.placeholderData)?(w=o.data,M=!0):w=typeof r.placeholderData=="function"?r.placeholderData((ee=a(this,X))==null?void 0:ee.state.data,a(this,X)):r.placeholderData,w!==void 0&&(j="success",f=Ue(o==null?void 0:o.data,w,r),v=!0)}if(r.select&&f!==void 0&&!M)if(o&&f===(d==null?void 0:d.data)&&r.select===a(this,ae))f=a(this,Z);else try{g(this,ae,r.select),f=r.select(f),f=Ue(o==null?void 0:o.data,f,r),g(this,Z,f),g(this,L,null)}catch(w){g(this,L,w)}a(this,L)&&(F=a(this,L),f=a(this,Z),T=Date.now(),j="error");const E=c.fetchStatus==="fetching",Q=j==="pending",$=j==="error",z=Q&&E,ie=f!==void 0,k={status:j,fetchStatus:c.fetchStatus,isPending:Q,isSuccess:j==="success",isError:$,isInitialLoading:z,isLoading:z,data:f,dataUpdatedAt:c.dataUpdatedAt,error:F,errorUpdatedAt:T,failureCount:c.fetchFailureCount,failureReason:c.fetchFailureReason,errorUpdateCount:c.errorUpdateCount,isFetched:c.dataUpdateCount>0||c.errorUpdateCount>0,isFetchedAfterMount:c.dataUpdateCount>n.dataUpdateCount||c.errorUpdateCount>n.errorUpdateCount,isFetching:E,isRefetching:E&&!Q,isLoadingError:$&&!ie,isPaused:c.fetchStatus==="paused",isPlaceholderData:v,isRefetchError:$&&ie,isStale:Re(s,r),refetch:this.refetch,promise:a(this,P),isEnabled:O(r.enabled,s)!==!1};if(this.options.experimental_prefetchInRender){const w=V=>{k.status==="error"?V.reject(k.error):k.data!==void 0&&V.resolve(k.data)},H=()=>{const V=g(this,P,k.promise=Te());w(V)},D=a(this,P);switch(D.status){case"pending":s.queryHash===i.queryHash&&w(D);break;case"fulfilled":(k.status==="error"||k.data!==D.value)&&H();break;case"rejected":(k.status!=="error"||k.error!==D.reason)&&H();break}}return k}updateResult(){const s=a(this,C),r=this.createResult(a(this,u),this.options);if(g(this,K,a(this,u).state),g(this,J,this.options),a(this,K).data!==void 0&&g(this,X,a(this,u)),me(r,s))return;g(this,C,r);const i=()=>{if(!s)return!0;const{notifyOnChangeProps:l}=this.options,o=typeof l=="function"?l():l;if(o==="all"||!o&&!a(this,Y).size)return!0;const d=new Set(o??a(this,Y));return this.options.throwOnError&&d.add("error"),Object.keys(a(this,C)).some(S=>{const m=S;return a(this,C)[m]!==s[m]&&d.has(m)})};y(this,x,et).call(this,{listeners:i()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&y(this,x,ve).call(this)}},R=new WeakMap,u=new WeakMap,re=new WeakMap,C=new WeakMap,K=new WeakMap,J=new WeakMap,P=new WeakMap,L=new WeakMap,ae=new WeakMap,Z=new WeakMap,X=new WeakMap,q=new WeakMap,G=new WeakMap,B=new WeakMap,Y=new WeakMap,x=new WeakSet,te=function(s){y(this,x,Se).call(this);let r=a(this,u).fetch(this.options,s);return s!=null&&s.throwOnError||(r=r.catch(xe)),r},ge=function(){y(this,x,je).call(this);const s=se(this.options.staleTime,a(this,u));if(fe||a(this,C).isStale||!De(s))return;const i=xt(a(this,C).dataUpdatedAt,s)+1;g(this,q,ce.setTimeout(()=>{a(this,C).isStale||this.updateResult()},i))},be=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(a(this,u)):this.options.refetchInterval)??!1},ye=function(s){y(this,x,Ne).call(this),g(this,B,s),!(fe||O(this.options.enabled,a(this,u))===!1||!De(a(this,B))||a(this,B)===0)&&g(this,G,ce.setInterval(()=>{(this.options.refetchIntervalInBackground||ft.isFocused())&&y(this,x,te).call(this)},a(this,B)))},ve=function(){y(this,x,ge).call(this),y(this,x,ye).call(this,y(this,x,be).call(this))},je=function(){a(this,q)&&(ce.clearTimeout(a(this,q)),g(this,q,void 0))},Ne=function(){a(this,G)&&(ce.clearInterval(a(this,G)),g(this,G,void 0))},Se=function(){const s=a(this,R).getQueryCache().build(a(this,R),this.options);if(s===a(this,u))return;const r=a(this,u);g(this,u,s),g(this,re,s.state),this.hasListeners()&&(r==null||r.removeObserver(this),s.addObserver(this))},et=function(s){He.batch(()=>{s.listeners&&this.listeners.forEach(r=>{r(a(this,C))}),a(this,R).getQueryCache().notify({query:a(this,u),type:"observerResultsUpdated"})})},ze);function It(t,s){return O(s.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&s.retryOnMount===!1)}function Qe(t,s){return It(t,s)||t.state.data!==void 0&&we(t,s,s.refetchOnMount)}function we(t,s,r){if(O(s.enabled,t)!==!1&&se(s.staleTime,t)!=="static"){const i=typeof r=="function"?r(t):r;return i==="always"||i!==!1&&Re(t,s)}return!1}function Le(t,s,r,i){return(t!==s||O(i.enabled,t)===!1)&&(!r.suspense||t.state.status!=="error")&&Re(t,r)}function Re(t,s){return O(s.enabled,t)!==!1&&t.isStaleByTime(se(s.staleTime,t))}function Mt(t,s){return!me(t.getCurrentResult(),s)}var tt=h.createContext(!1),Ft=()=>h.useContext(tt);tt.Provider;function Ot(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var Tt=h.createContext(Ot()),Dt=()=>h.useContext(Tt),Ut=(t,s)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(s.isReset()||(t.retryOnMount=!1))},Pt=t=>{h.useEffect(()=>{t.clearReset()},[t])},At=({result:t,errorResetBoundary:s,throwOnError:r,query:i,suspense:l})=>t.isError&&!s.isReset()&&!t.isFetching&&i&&(l&&t.data===void 0||gt(r,[t.error,i])),Qt=t=>{if(t.suspense){const r=l=>l==="static"?l:Math.max(l??1e3,1e3),i=t.staleTime;t.staleTime=typeof i=="function"?(...l)=>r(i(...l)):r(i),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},Lt=(t,s)=>t.isLoading&&t.isFetching&&!s,Bt=(t,s)=>(t==null?void 0:t.suspense)&&s.isPending,Be=(t,s,r)=>s.fetchOptimistic(t).catch(()=>{r.clearReset()});function $t(t,s,r){var c,v,f,F,T;const i=Ft(),l=Dt(),o=bt(),d=o.defaultQueryOptions(t);(v=(c=o.getDefaultOptions().queries)==null?void 0:c._experimental_beforeQuery)==null||v.call(c,d),d._optimisticResults=i?"isRestoring":"optimistic",Qt(d),Ut(d,l),Pt(l);const S=!o.getQueryCache().get(d.queryHash),[m]=h.useState(()=>new s(o,d)),n=m.getOptimisticResult(d),b=!i&&t.subscribed!==!1;if(h.useSyncExternalStore(h.useCallback(j=>{const M=b?m.subscribe(He.batchCalls(j)):xe;return m.updateResult(),M},[m,b]),()=>m.getCurrentResult(),()=>m.getCurrentResult()),h.useEffect(()=>{m.setOptions(d)},[d,m]),Bt(d,n))throw Be(d,m,l);if(At({result:n,errorResetBoundary:l,throwOnError:d.throwOnError,query:o.getQueryCache().get(d.queryHash),suspense:d.suspense}))throw n.error;if((F=(f=o.getDefaultOptions().queries)==null?void 0:f._experimental_afterQuery)==null||F.call(f,d,n),d.experimental_prefetchInRender&&!fe&&Lt(n,i)){const j=S?Be(d,m,l):(T=o.getQueryCache().get(d.queryHash))==null?void 0:T.promise;j==null||j.catch(xe).finally(()=>{m.updateResult()})}return d.notifyOnChangeProps?n:m.trackResult(n)}function zt(t,s){return $t(t,kt)}/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ht=[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2Z",key:"169p4p"}],["path",{d:"m9 10 2 2 4-4",key:"1gnqz4"}]],st=_e("BookmarkCheck",Ht);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vt=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Kt=_e("ChevronLeft",Vt);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qt=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],Gt=_e("LayoutGrid",qt),rt="https://lit-caller-gw-2e68g4k3.uc.gateway.dev";async function Wt(t){const s=await fetch(`${rt}/public/getFilterOptions`,{signal:t,headers:{accept:"application/json"}});if(!s.ok)throw new Error(`getFilterOptions ${s.status}`);return s.json()}async function Jt(t,s){const r=await fetch(`${rt}/public/searchCompanies`,{method:"POST",headers:{"content-type":"application/json",accept:"application/json"},body:JSON.stringify(t),signal:s});if(!r.ok)throw new Error(`searchCompanies ${r.status}`);return r.json()}function $e({className:t,...s}){return e.jsx("div",{className:yt("animate-pulse rounded-md bg-primary/10",t),...s})}function Zt(t){if(!t)return{};const s=t.data?t.data:t;return{origin_countries:Array.isArray(s.origin_countries)?s.origin_countries:[],destination_countries:Array.isArray(s.destination_countries)?s.destination_countries:[],modes:Array.isArray(s.modes)?s.modes:[]}}function Xt({onChange:t}){const[s,r]=h.useState({origins:[],destinations:[],modes:[]}),[i,l]=h.useState({origin:"",destination:"",mode:"",date_start:"",date_end:""}),{data:o,isLoading:d,error:S}=zt({queryKey:["filter-options"],queryFn:()=>Wt(),staleTime:1e3*60*10});h.useEffect(()=>{if(o){const n=Zt(o);r({origins:n.origin_countries.sort(),destinations:n.destination_countries.sort(),modes:n.modes.sort()})}},[o]),h.useEffect(()=>{const n=setTimeout(()=>{t==null||t(i)},300);return()=>clearTimeout(n)},[i,t]);const m=(n,b)=>{l(c=>({...c,[n]:b}))};return S?e.jsx("div",{className:"bg-red-50 border-l-4 border-red-400 p-4 rounded-md my-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Ve,{className:"h-5 w-5 text-red-400","aria-hidden":"true"})}),e.jsx("div",{className:"ml-3",children:e.jsxs("p",{className:"text-sm text-red-700",children:["Could not load search filters. Please try again later. (",S.message||String(S),")"]})})]})}):d?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6",children:Array.from({length:5}).map((n,b)=>e.jsxs("div",{className:"space-y-2",children:[e.jsx($e,{className:"h-4 w-24"}),e.jsx($e,{className:"h-10 w-full"})]},b))}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"origin",className:"block text-sm font-medium text-gray-700 mb-1",children:"Origin Country"}),e.jsxs("select",{id:"origin",value:i.origin,onChange:n=>m("origin",n.target.value),disabled:d,className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",children:[e.jsx("option",{value:"",children:"Any Origin"}),s.origins.map(n=>e.jsx("option",{value:n,children:n},n))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"destination",className:"block text-sm font-medium text-gray-700 mb-1",children:"Destination Country"}),e.jsxs("select",{id:"destination",value:i.destination,onChange:n=>m("destination",n.target.value),disabled:d,className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",children:[e.jsx("option",{value:"",children:"Any Destination"}),s.destinations.map(n=>e.jsx("option",{value:n,children:n},n))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"mode",className:"block text-sm font-medium text-gray-700 mb-1",children:"Mode"}),e.jsxs("select",{id:"mode",value:i.mode,onChange:n=>m("mode",n.target.value),disabled:d,className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",children:[e.jsx("option",{value:"",children:"Any Mode"}),s.modes.map(n=>e.jsx("option",{value:n,children:n.charAt(0).toUpperCase()+n.slice(1)},n))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"date_start",className:"block text-sm font-medium text-gray-700 mb-1",children:"Date Start"}),e.jsx("input",{type:"date",id:"date_start",value:i.date_start,onChange:n=>m("date_start",n.target.value),className:"block w-full pl-3 pr-2 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"date_end",className:"block text-sm font-medium text-gray-700 mb-1",children:"Date End"}),e.jsx("input",{type:"date",id:"date_end",value:i.date_end,onChange:n=>m("date_end",n.target.value),className:"block w-full pl-3 pr-2 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md"})]})]})}function Yt({company:t,onSelect:s,onSave:r,isSaving:i,isSaved:l,isNew:o,onStartOutreach:d,onDraftRFP:S,savingCompanyId:m}){const n=c=>c?c>=1e6?`${(c/1e6).toFixed(1)}M`:c>=1e3?`${(c/1e3).toFixed(0)}K`:c.toLocaleString():"0",b=m===t.id;return e.jsxs(Ce.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},whileHover:{y:-2},className:"bg-white/90 backdrop-blur-sm rounded-2xl p-5 shadow-lg border border-gray-200/60 hover:shadow-xl transition-all duration-300 cursor-pointer",onClick:()=>s(t),children:[o&&e.jsx("div",{className:"mb-3",children:e.jsx(qe,{className:"bg-gradient-to-r from-green-500 to-emerald-500 text-white",children:"New Shipper"})}),e.jsx("div",{className:"flex justify-between items-start mb-4",children:e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-bold text-gray-900 truncate text-lg mb-1",children:t.name}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(pe,{className:"w-3 h-3"}),e.jsxs("span",{children:["ID: ",t.id]})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-600 font-medium mb-1",children:[e.jsx(Ge,{className:"w-3 h-3"}),"Shipments (12M)"]}),e.jsx("div",{className:"text-lg font-bold text-blue-900",children:n(t.shipments_12m)})]}),e.jsxs("div",{className:"bg-purple-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-purple-600 font-medium mb-1",children:[e.jsx(We,{className:"w-3 h-3"}),"Last Activity"]}),e.jsx("div",{className:"text-sm font-bold text-purple-900",children:t.last_seen?Xe(new Date(t.last_seen),"MMM d"):"N/A"})]})]}),e.jsxs("div",{className:"space-y-2 mb-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Je,{className:"w-3 h-3 text-gray-500"}),e.jsx("span",{className:"text-gray-600",children:"Top Route:"}),e.jsx("span",{className:"font-medium text-gray-900 truncate flex-1",children:t.top_route||"Various routes"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"w-3 h-3 text-gray-500"}),e.jsx("span",{className:"text-gray-600",children:"Top Carrier:"}),e.jsx("span",{className:"font-medium text-gray-900 truncate flex-1",children:t.top_carrier||"Multiple carriers"})]})]}),e.jsxs("div",{className:"flex gap-2",onClick:c=>c.stopPropagation(),children:[e.jsxs(A,{size:"sm",variant:"outline",onClick:()=>r(t),disabled:b||l,className:"flex-1",children:[b&&e.jsx(Ze,{className:"mr-2 h-3 w-3 animate-spin"}),l?e.jsx(st,{className:"w-3 h-3 mr-1 text-blue-600"}):e.jsx(Ke,{className:"w-3 h-3 mr-1"}),l?"Saved":"Save"]}),e.jsxs(A,{size:"sm",onClick:()=>d(t),className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white",children:[e.jsx(Ye,{className:"w-3 h-3 mr-1"}),"Contact"]})]})]})}function es({company:t,onSelect:s,onSave:r,isSaving:i,isSaved:l,isNew:o,onStartOutreach:d,onDraftRFP:S,savingCompanyId:m,index:n=0}){const b=v=>v?v>=1e6?`${(v/1e6).toFixed(1)}M`:v>=1e3?`${(v/1e3).toFixed(0)}K`:v.toLocaleString():"0",c=m===t.id;return e.jsx(Ce.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:n*.05},className:"p-4 hover:bg-gray-50/80 transition-all duration-200 cursor-pointer border-b border-gray-100 last:border-b-0",onClick:()=>s(t),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0 pr-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900 truncate",children:t.name}),o&&e.jsx(qe,{className:"bg-gradient-to-r from-green-500 to-emerald-500 text-white text-xs",children:"New"})]}),e.jsx("div",{className:"flex items-center gap-4 text-sm text-gray-600 mb-2",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(pe,{className:"w-3 h-3"}),e.jsxs("span",{children:["ID: ",t.id]})]})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-1 text-blue-600 font-medium",children:[e.jsx(Ge,{className:"w-3 h-3"}),e.jsx("span",{children:"Shipments (12M):"})]}),e.jsx("span",{className:"font-bold text-blue-900",children:b(t.shipments_12m)})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-1 text-purple-600 font-medium",children:[e.jsx(We,{className:"w-3 h-3"}),e.jsx("span",{children:"Last Activity:"})]}),e.jsx("span",{className:"font-bold text-purple-900",children:t.last_seen?Xe(new Date(t.last_seen),"MMM d"):"N/A"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("div",{className:"flex items-center gap-1 text-gray-500 font-medium",children:[e.jsx(Je,{className:"w-3 h-3"}),e.jsx("span",{children:"Top Route:"})]}),e.jsx("span",{className:"font-medium text-gray-900 truncate",children:t.top_route||"Various routes"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm mt-2",children:e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Top Carrier:"}),e.jsx("span",{className:"ml-1 font-medium text-gray-900 truncate",children:t.top_carrier||"Multiple carriers"})]})})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",onClick:v=>v.stopPropagation(),children:[e.jsxs(A,{size:"sm",variant:"outline",onClick:()=>r(t),disabled:c||l,className:"hidden sm:inline-flex",children:[c&&e.jsx(Ze,{className:"mr-2 h-3 w-3 animate-spin"}),l?e.jsx(st,{className:"w-3 h-3 mr-1 text-blue-600"}):e.jsx(Ke,{className:"w-3 h-3 mr-1"}),l?"Saved":"Save"]}),e.jsxs(A,{size:"sm",onClick:()=>d(t),className:"bg-blue-600 hover:bg-blue-700 text-white hidden sm:inline-flex",children:[e.jsx(Ye,{className:"w-3 h-3 mr-1"}),"Contact"]})]})]})})}function ts({searchResults:t,totalResults:s,isLoading:r,onCompanySelect:i,onSave:l,onStartOutreach:o,onDraftRFP:d,user:S,newShipperEvents:m,savedCompanyIds:n,savingCompanyId:b,viewMode:c,setViewMode:v,currentPage:f,totalPages:F,onPageChange:T}){const j=t&&t.length>0;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Search Results"}),!r&&e.jsxs("p",{className:"text-gray-500 text-sm mt-1",children:["Found ",Number(s||0).toLocaleString()," companies â€¢ Showing ",(t==null?void 0:t.length)||0," on this page"]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-1 bg-gray-100 p-1 rounded-lg",children:[e.jsxs(A,{size:"sm",variant:c==="grid"?"secondary":"ghost",onClick:()=>v("grid"),className:"h-8 px-3",children:[e.jsx(Gt,{className:"w-4 h-4 mr-1"}),"Cards"]}),e.jsxs(A,{size:"sm",variant:c==="list"?"secondary":"ghost",onClick:()=>v("list"),className:"h-8 px-3",children:[e.jsx(_t,{className:"w-4 h-4 mr-1"}),"List"]})]}),F>1&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(A,{variant:"outline",size:"sm",onClick:()=>T(f-1),disabled:f===1||r,className:"h-8",children:e.jsx(Kt,{className:"h-4 w-4"})}),e.jsxs("span",{className:"text-sm text-gray-600 px-2",children:["Page ",f," of ",F]}),e.jsx(A,{variant:"outline",size:"sm",onClick:()=>T(f+1),disabled:f>=F||r,className:"h-8",children:e.jsx(Rt,{className:"h-4 w-4"})})]})]})]}),r?e.jsx("div",{className:`grid gap-4 md:gap-6 ${c==="grid"?"grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4":"grid-cols-1"}`,children:Array.from({length:12}).map((M,E)=>e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-4"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2 mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/3 mb-4"}),e.jsx("div",{className:"h-16 bg-gray-200 rounded mb-4"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded flex-1"}),e.jsx("div",{className:"h-8 bg-gray-200 rounded flex-1"})]})]},E))}):j?e.jsx("div",{className:`grid gap-4 md:gap-6 ${c==="grid"?"grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4":"grid-cols-1"}`,children:e.jsx(St,{children:t.map(M=>{const E=M.company_id||M.id,Q=b===E,$=n.has(E),z=m.includes(E);return c==="grid"?e.jsx(Yt,{company:M,onSelect:i,onSave:l,isSaving:Q,isSaved:$,isNew:z,onStartOutreach:o,onDraftRFP:d,savingCompanyId:b},E):e.jsx(es,{company:M,onSelect:i,onSave:l,isSaving:Q,isSaved:$,isNew:z,onStartOutreach:o,onDraftRFP:d,savingCompanyId:b},E)})})}):e.jsxs(Ce.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center py-16 bg-white rounded-2xl border border-dashed border-gray-300",children:[e.jsx(Ve,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-4 text-lg font-medium text-gray-900",children:"No results found"}),e.jsx("p",{className:"mt-2 text-sm text-gray-500 max-w-sm mx-auto",children:"Try adjusting your search query or filters to find companies."})]})]})}const ue=25;function Bs(){const t=vt(),[s,r]=h.useState(null),[i,l]=h.useState(""),[o,d]=h.useState({mode:"",origin:"",destination:"",date_start:null,date_end:null}),[S,m]=h.useState([]),[n,b]=h.useState(!1),[c,v]=h.useState(""),[f,F]=h.useState(null),[T,j]=h.useState(!1),[M,E]=h.useState(!1),[Q,$]=h.useState(""),[z,ie]=h.useState(1),[ne,k]=h.useState(0),[ee,w]=h.useState(new Set),[H,D]=h.useState(null),[V,Ee]=h.useState(null),[at,it]=h.useState("grid"),[ke,nt]=h.useState(!1);h.useEffect(()=>{const p=setTimeout(()=>v(i),300);return()=>clearTimeout(p)},[i]),h.useEffect(()=>{ke&&oe(1)},[c,o]);const Ie=h.useMemo(()=>Math.max(1,Math.ceil((ne||0)/ue)),[ne]),Me=h.useCallback(async()=>{try{const p=await jt.me();r(p)}catch(p){console.error("Error loading user:",p)}},[]);h.useEffect(()=>{Me()},[Me]);const oe=h.useCallback(async p=>{var W,le;const I=p||1;b(!0),Ee(null),ie(I),nt(!0);try{const U=(I-1)*ue,de={q:i||void 0,origin:o.origin?[o.origin]:void 0,dest:o.destination?[o.destination]:void 0,mode:o.mode||void 0,startDate:o.date_start||void 0,endDate:o.date_end||void 0,limit:ue,offset:U},_=await Jt(de),ht=Array.isArray(_==null?void 0:_.results)?_.results:((W=_==null?void 0:_.data)==null?void 0:W.items)||[],ut=typeof(_==null?void 0:_.total)=="number"?_.total:((le=_==null?void 0:_.data)==null?void 0:le.total)||0;m(ht),k(ut)}catch(U){console.error("Search error:",U),Ee("Search failed: "+((U==null?void 0:U.message)||"Unknown error")),m([]),k(0)}finally{b(!1)}},[i,o]),ot=h.useCallback(p=>{F(p),j(!0)},[]),Fe=async p=>{if(!s||H)return;const I=p.id;D(I);const W=new Set(ee),le=W.has(I),U=new Set(W);le||U.add(I),w(U);try{await Ct({name:p.name,website:p.website||void 0,external_ref:String(I)})}catch(de){console.error("Failed to save company:",de),w(W),alert("Failed to save company. Please try again.")}finally{D(null)}},lt=p=>{const I=p.id;I&&t(Pe("EmailCenter?company_id="+I))},ct=p=>{const I=p.id;I&&t(Pe("RFPStudio?company_id="+I))},dt=p=>{p>=1&&p<=Ie&&!n&&oe(p)};return e.jsx("div",{className:"p-4 md:p-6 lg:p-8 bg-gradient-to-br from-gray-50 to-blue-50/30 min-h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center mb-6 lg:mb-8 gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl lg:text-4xl font-bold text-gray-900",children:"Trade Intelligence Discovery"}),e.jsx("p",{className:"text-gray-600 mt-2 text-sm md:text-base",children:"Search companies by trade activity, routes, commodities, and shipping patterns"})]})}),e.jsx("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg p-4 md:p-6 mb-6 md:mb-8 border border-gray-200/60",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Nt,{value:i,onChange:p=>l(p.target.value),placeholder:"Search by company name or alias (e.g., UPS, Maersk)...",className:"pl-4 pr-12 py-3 text-base md:text-lg bg-gray-50 border-0 rounded-xl",onKeyDown:p=>{p.key==="Enter"&&oe(1)}}),e.jsx(Ae,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"})]}),e.jsx(A,{onClick:()=>oe(1),disabled:n,className:"px-6 md:px-8 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white font-semibold rounded-xl",children:n?"Searching...":"Search"})]})}),e.jsx(Xt,{onChange:d}),V&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 mb-6",children:e.jsxs("div",{className:"flex items-center gap-2 text-red-800",children:[e.jsx("span",{className:"font-semibold",children:"Search Error:"}),e.jsx("span",{children:V})]})}),ke?e.jsx(ts,{searchResults:S,totalResults:ne,isLoading:n,onCompanySelect:ot,onSave:Fe,onStartOutreach:lt,onDraftRFP:ct,user:s,newShipperEvents:[],savedCompanyIds:ee,savingCompanyId:H,viewMode:at,setViewMode:it,currentPage:z,totalPages:Ie,onPageChange:dt}):e.jsxs("div",{className:"text-center py-16 bg-white rounded-2xl border border-dashed border-gray-300",children:[e.jsx(Ae,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Ready to Search"}),e.jsx("p",{className:"text-sm text-gray-500 max-w-sm mx-auto",children:"Enter a company name or use the filters above to search for trade intelligence data."})]}),e.jsx(Et,{isOpen:M,onClose:()=>E(!1),feature:Q,currentPlan:s==null?void 0:s.plan}),e.jsx(wt,{company:f,isOpen:T,onClose:()=>j(!1),onSave:Fe,user:s})]})})}export{Bs as default};
