var Oe=t=>{throw TypeError(t)};var he=(t,s,r)=>s.has(t)||Oe("Cannot "+r);var a=(t,s,r)=>(he(t,s,"read from private field"),r?r.call(t):s.get(t)),w=(t,s,r)=>s.has(t)?Oe("Cannot add the same private member more than once"):s instanceof WeakSet?s.add(t):s.set(t,r),y=(t,s,r,n)=>(he(t,s,"write to private field"),n?n.call(t,r):s.set(t,r),r),v=(t,s,r)=>(he(t,s,"access private method"),r);import{S as ut,p as Te,e as O,s as ue,f as re,n as xe,i as fe,h as De,t as xt,k as de,l as ft,m as pt,o as Ue,q as $e,r as c,v as gt,w as bt,j as e,x as yt,B as Q,u as vt}from"./index-BAKPb1QP.js";import{User as jt}from"./entities-BF_CoRhL.js";import{I as Nt}from"./input-kNnbxgwk.js";import{c as Pe}from"./index-A7ElDbZk.js";import{g as St,s as wt}from"./api-BlpfWy-Q.js";import{C as Ve}from"./circle-alert-Bn4z-dCg.js";import{B as Ke,C as Ct,c as Rt}from"./CompanyDetailModal-BwnMdAsm.js";import{B as qe}from"./badge-BphqTXNQ.js";import{m as Ce}from"./proxy-CadtPmmU.js";import{B as pe}from"./building-2-BVbKPFX-.js";import{T as Ge}from"./trending-up-BHd3P9nq.js";import{C as We}from"./calendar-BWOB4nCQ.js";import{S as Je}from"./ship-D3vhigS_.js";import{L as Ze}from"./loader-circle-CtorJgkS.js";import{c as Re}from"./createLucideIcon-BDqU3BKp.js";import{f as Xe,M as Ye}from"./format-BguTH7K8.js";import{L as _t}from"./list-Lj1ZqIMm.js";import{C as Et}from"./dropdown-menu-B0Uq1z3g.js";import{A as kt}from"./index-B5N3X_jA.js";import{U as It}from"./UpgradePrompt-BNvTUeOK.js";import"./functions-DZ6U6PmF.js";import{S as Qe}from"./search-j_ivXtL6.js";import"./base44Client-C-YMJfZQ.js";import"./dialog-BavuU3xq.js";import"./index-DHyO2_ME.js";import"./Combination-rUOcQgBM.js";import"./index-BQqhOIv6.js";import"./tabs-Dt56en1C.js";import"./index-DVg2QvfI.js";import"./truck-DpcrLGmf.js";import"./select-DB9F_2eo.js";import"./label-D9Ltm05_.js";import"./plus-CE1C5Hg5.js";import"./textarea-CfBTYPRA.js";import"./users-BRdwJaYn.js";import"./message-square-DYpBUJuc.js";import"./trash-2-Cvu9Ejvo.js";import"./planLimits-C4PMM81i.js";import"./crown-Bezw402i.js";import"./zap-CVdHMNQv.js";import"./arrow-right-D-21iZb9.js";var _,h,ae,R,K,J,P,L,ie,Z,X,q,G,B,Y,u,se,ge,be,ye,ve,je,Ne,Se,et,He,Mt=(He=class extends ut{constructor(s,r){super();w(this,u);w(this,_);w(this,h);w(this,ae);w(this,R);w(this,K);w(this,J);w(this,P);w(this,L);w(this,ie);w(this,Z);w(this,X);w(this,q);w(this,G);w(this,B);w(this,Y,new Set);this.options=r,y(this,_,s),y(this,L,null),y(this,P,Te()),this.bindMethods(),this.setOptions(r)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(a(this,h).addObserver(this),Ae(a(this,h),this.options)?v(this,u,se).call(this):this.updateResult(),v(this,u,ve).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return we(a(this,h),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return we(a(this,h),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,v(this,u,je).call(this),v(this,u,Ne).call(this),a(this,h).removeObserver(this)}setOptions(s){const r=this.options,n=a(this,h);if(this.options=a(this,_).defaultQueryOptions(s),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof O(this.options.enabled,a(this,h))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");v(this,u,Se).call(this),a(this,h).setOptions(this.options),r._defaulted&&!ue(this.options,r)&&a(this,_).getQueryCache().notify({type:"observerOptionsUpdated",query:a(this,h),observer:this});const o=this.hasListeners();o&&Le(a(this,h),n,this.options,r)&&v(this,u,se).call(this),this.updateResult(),o&&(a(this,h)!==n||O(this.options.enabled,a(this,h))!==O(r.enabled,a(this,h))||re(this.options.staleTime,a(this,h))!==re(r.staleTime,a(this,h)))&&v(this,u,ge).call(this);const l=v(this,u,be).call(this);o&&(a(this,h)!==n||O(this.options.enabled,a(this,h))!==O(r.enabled,a(this,h))||l!==a(this,B))&&v(this,u,ye).call(this,l)}getOptimisticResult(s){const r=a(this,_).getQueryCache().build(a(this,_),s),n=this.createResult(r,s);return Ot(this,n)&&(y(this,R,n),y(this,J,this.options),y(this,K,a(this,h).state)),n}getCurrentResult(){return a(this,R)}trackResult(s,r){return new Proxy(s,{get:(n,o)=>(this.trackProp(o),r==null||r(o),o==="promise"&&!this.options.experimental_prefetchInRender&&a(this,P).status==="pending"&&a(this,P).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),Reflect.get(n,o))})}trackProp(s){a(this,Y).add(s)}getCurrentQuery(){return a(this,h)}refetch({...s}={}){return this.fetch({...s})}fetchOptimistic(s){const r=a(this,_).defaultQueryOptions(s),n=a(this,_).getQueryCache().build(a(this,_),r);return n.fetch().then(()=>this.createResult(n,r))}fetch(s){return v(this,u,se).call(this,{...s,cancelRefetch:s.cancelRefetch??!0}).then(()=>(this.updateResult(),a(this,R)))}createResult(s,r){var ee;const n=a(this,h),o=this.options,l=a(this,R),d=a(this,K),N=a(this,J),f=s!==n?s.state:a(this,ae),{state:g}=s;let i={...g},b=!1,x;if(r._optimisticResults){const C=this.hasListeners(),$=!C&&Ae(s,r),D=C&&Le(s,n,r,o);($||D)&&(i={...i,...pt(g.data,s.options)}),r._optimisticResults==="isRestoring"&&(i.fetchStatus="idle")}let{error:F,errorUpdatedAt:T,status:j}=i;x=i.data;let M=!1;if(r.placeholderData!==void 0&&x===void 0&&j==="pending"){let C;l!=null&&l.isPlaceholderData&&r.placeholderData===(N==null?void 0:N.placeholderData)?(C=l.data,M=!0):C=typeof r.placeholderData=="function"?r.placeholderData((ee=a(this,X))==null?void 0:ee.state.data,a(this,X)):r.placeholderData,C!==void 0&&(j="success",x=Ue(l==null?void 0:l.data,C,r),b=!0)}if(r.select&&x!==void 0&&!M)if(l&&x===(d==null?void 0:d.data)&&r.select===a(this,ie))x=a(this,Z);else try{y(this,ie,r.select),x=r.select(x),x=Ue(l==null?void 0:l.data,x,r),y(this,Z,x),y(this,L,null)}catch(C){y(this,L,C)}a(this,L)&&(F=a(this,L),x=a(this,Z),T=Date.now(),j="error");const E=i.fetchStatus==="fetching",A=j==="pending",z=j==="error",H=A&&E,ne=x!==void 0,k={status:j,fetchStatus:i.fetchStatus,isPending:A,isSuccess:j==="success",isError:z,isInitialLoading:H,isLoading:H,data:x,dataUpdatedAt:i.dataUpdatedAt,error:F,errorUpdatedAt:T,failureCount:i.fetchFailureCount,failureReason:i.fetchFailureReason,errorUpdateCount:i.errorUpdateCount,isFetched:i.dataUpdateCount>0||i.errorUpdateCount>0,isFetchedAfterMount:i.dataUpdateCount>f.dataUpdateCount||i.errorUpdateCount>f.errorUpdateCount,isFetching:E,isRefetching:E&&!A,isLoadingError:z&&!ne,isPaused:i.fetchStatus==="paused",isPlaceholderData:b,isRefetchError:z&&ne,isStale:_e(s,r),refetch:this.refetch,promise:a(this,P),isEnabled:O(r.enabled,s)!==!1};if(this.options.experimental_prefetchInRender){const C=V=>{k.status==="error"?V.reject(k.error):k.data!==void 0&&V.resolve(k.data)},$=()=>{const V=y(this,P,k.promise=Te());C(V)},D=a(this,P);switch(D.status){case"pending":s.queryHash===n.queryHash&&C(D);break;case"fulfilled":(k.status==="error"||k.data!==D.value)&&$();break;case"rejected":(k.status!=="error"||k.error!==D.reason)&&$();break}}return k}updateResult(){const s=a(this,R),r=this.createResult(a(this,h),this.options);if(y(this,K,a(this,h).state),y(this,J,this.options),a(this,K).data!==void 0&&y(this,X,a(this,h)),ue(r,s))return;y(this,R,r);const n=()=>{if(!s)return!0;const{notifyOnChangeProps:o}=this.options,l=typeof o=="function"?o():o;if(l==="all"||!l&&!a(this,Y).size)return!0;const d=new Set(l??a(this,Y));return this.options.throwOnError&&d.add("error"),Object.keys(a(this,R)).some(N=>{const m=N;return a(this,R)[m]!==s[m]&&d.has(m)})};v(this,u,et).call(this,{listeners:n()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&v(this,u,ve).call(this)}},_=new WeakMap,h=new WeakMap,ae=new WeakMap,R=new WeakMap,K=new WeakMap,J=new WeakMap,P=new WeakMap,L=new WeakMap,ie=new WeakMap,Z=new WeakMap,X=new WeakMap,q=new WeakMap,G=new WeakMap,B=new WeakMap,Y=new WeakMap,u=new WeakSet,se=function(s){v(this,u,Se).call(this);let r=a(this,h).fetch(this.options,s);return s!=null&&s.throwOnError||(r=r.catch(xe)),r},ge=function(){v(this,u,je).call(this);const s=re(this.options.staleTime,a(this,h));if(fe||a(this,R).isStale||!De(s))return;const n=xt(a(this,R).dataUpdatedAt,s)+1;y(this,q,de.setTimeout(()=>{a(this,R).isStale||this.updateResult()},n))},be=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(a(this,h)):this.options.refetchInterval)??!1},ye=function(s){v(this,u,Ne).call(this),y(this,B,s),!(fe||O(this.options.enabled,a(this,h))===!1||!De(a(this,B))||a(this,B)===0)&&y(this,G,de.setInterval(()=>{(this.options.refetchIntervalInBackground||ft.isFocused())&&v(this,u,se).call(this)},a(this,B)))},ve=function(){v(this,u,ge).call(this),v(this,u,ye).call(this,v(this,u,be).call(this))},je=function(){a(this,q)&&(de.clearTimeout(a(this,q)),y(this,q,void 0))},Ne=function(){a(this,G)&&(de.clearInterval(a(this,G)),y(this,G,void 0))},Se=function(){const s=a(this,_).getQueryCache().build(a(this,_),this.options);if(s===a(this,h))return;const r=a(this,h);y(this,h,s),y(this,ae,s.state),this.hasListeners()&&(r==null||r.removeObserver(this),s.addObserver(this))},et=function(s){$e.batch(()=>{s.listeners&&this.listeners.forEach(r=>{r(a(this,R))}),a(this,_).getQueryCache().notify({query:a(this,h),type:"observerResultsUpdated"})})},He);function Ft(t,s){return O(s.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&s.retryOnMount===!1)}function Ae(t,s){return Ft(t,s)||t.state.data!==void 0&&we(t,s,s.refetchOnMount)}function we(t,s,r){if(O(s.enabled,t)!==!1&&re(s.staleTime,t)!=="static"){const n=typeof r=="function"?r(t):r;return n==="always"||n!==!1&&_e(t,s)}return!1}function Le(t,s,r,n){return(t!==s||O(n.enabled,t)===!1)&&(!r.suspense||t.state.status!=="error")&&_e(t,r)}function _e(t,s){return O(s.enabled,t)!==!1&&t.isStaleByTime(re(s.staleTime,t))}function Ot(t,s){return!ue(t.getCurrentResult(),s)}var tt=c.createContext(!1),Tt=()=>c.useContext(tt);tt.Provider;function Dt(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var Ut=c.createContext(Dt()),Pt=()=>c.useContext(Ut),Qt=(t,s)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(s.isReset()||(t.retryOnMount=!1))},At=t=>{c.useEffect(()=>{t.clearReset()},[t])},Lt=({result:t,errorResetBoundary:s,throwOnError:r,query:n,suspense:o})=>t.isError&&!s.isReset()&&!t.isFetching&&n&&(o&&t.data===void 0||gt(r,[t.error,n])),Bt=t=>{if(t.suspense){const r=o=>o==="static"?o:Math.max(o??1e3,1e3),n=t.staleTime;t.staleTime=typeof n=="function"?(...o)=>r(n(...o)):r(n),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},zt=(t,s)=>t.isLoading&&t.isFetching&&!s,Ht=(t,s)=>(t==null?void 0:t.suspense)&&s.isPending,Be=(t,s,r)=>s.fetchOptimistic(t).catch(()=>{r.clearReset()});function $t(t,s,r){var i,b,x,F,T;const n=Tt(),o=Pt(),l=bt(),d=l.defaultQueryOptions(t);(b=(i=l.getDefaultOptions().queries)==null?void 0:i._experimental_beforeQuery)==null||b.call(i,d),d._optimisticResults=n?"isRestoring":"optimistic",Bt(d),Qt(d,o),At(o);const N=!l.getQueryCache().get(d.queryHash),[m]=c.useState(()=>new s(l,d)),f=m.getOptimisticResult(d),g=!n&&t.subscribed!==!1;if(c.useSyncExternalStore(c.useCallback(j=>{const M=g?m.subscribe($e.batchCalls(j)):xe;return m.updateResult(),M},[m,g]),()=>m.getCurrentResult(),()=>m.getCurrentResult()),c.useEffect(()=>{m.setOptions(d)},[d,m]),Ht(d,f))throw Be(d,m,o);if(Lt({result:f,errorResetBoundary:o,throwOnError:d.throwOnError,query:l.getQueryCache().get(d.queryHash),suspense:d.suspense}))throw f.error;if((F=(x=l.getDefaultOptions().queries)==null?void 0:x._experimental_afterQuery)==null||F.call(x,d,f),d.experimental_prefetchInRender&&!fe&&zt(f,n)){const j=N?Be(d,m,o):(T=l.getQueryCache().get(d.queryHash))==null?void 0:T.promise;j==null||j.catch(xe).finally(()=>{m.updateResult()})}return d.notifyOnChangeProps?f:m.trackResult(f)}function Vt(t,s){return $t(t,Mt)}/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kt=[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2Z",key:"169p4p"}],["path",{d:"m9 10 2 2 4-4",key:"1gnqz4"}]],st=Re("BookmarkCheck",Kt);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qt=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Gt=Re("ChevronLeft",qt);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wt=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],Jt=Re("LayoutGrid",Wt);function ze({className:t,...s}){return e.jsx("div",{className:yt("animate-pulse rounded-md bg-primary/10",t),...s})}function Zt(t){if(!t)return{};const s=t.data?t.data:t;return{origin_countries:Array.isArray(s.origin_countries)?s.origin_countries:[],destination_countries:Array.isArray(s.destination_countries)?s.destination_countries:[],modes:Array.isArray(s.modes)?s.modes:[]}}function Xt({onChange:t}){const[s,r]=c.useState({origins:[],destinations:[],modes:[]}),[n,o]=c.useState(!1),[l,d]=c.useState({origin:"",destination:"",mode:"",date_start:"",date_end:""}),{data:N,isLoading:m,error:f}=Vt({queryKey:["filter-options"],queryFn:()=>St({}),staleTime:1e3*60*10});c.useEffect(()=>{if(N){const i=Zt(N);r({origins:i.origin_countries.sort(),destinations:i.destination_countries.sort(),modes:i.modes.sort()})}},[N]),c.useEffect(()=>{const i=setTimeout(()=>{t==null||t(l)},300);return()=>clearTimeout(i)},[l,t]);const g=(i,b)=>{d(x=>({...x,[i]:b}))};return f?e.jsx("div",{className:"bg-red-50 border-l-4 border-red-400 p-4 rounded-md my-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Ve,{className:"h-5 w-5 text-red-400","aria-hidden":"true"})}),e.jsx("div",{className:"ml-3",children:e.jsxs("p",{className:"text-sm text-red-700",children:["Could not load search filters. Please try again later. (",f.message||String(f),")"]})})]})}):m?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6",children:Array.from({length:5}).map((i,b)=>e.jsxs("div",{className:"space-y-2",children:[e.jsx(ze,{className:"h-4 w-24"}),e.jsx(ze,{className:"h-10 w-full"})]},b))}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6",children:[e.jsxs("div",{className:"md:col-span-5 flex items-center justify-between",children:[e.jsx("div",{}),e.jsxs("button",{type:"button",className:"text-xs text-blue-600 underline",onClick:()=>o(i=>!i),children:[n?"Hide":"Load"," Filters JSON"]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"origin",className:"block text-sm font-medium text-gray-700 mb-1",children:"Origin Country"}),e.jsxs("select",{id:"origin",value:l.origin,onChange:i=>g("origin",i.target.value),disabled:m,className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",children:[e.jsx("option",{value:"",children:"Any Origin"}),s.origins.map(i=>e.jsx("option",{value:i,children:i},i))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"destination",className:"block text-sm font-medium text-gray-700 mb-1",children:"Destination Country"}),e.jsxs("select",{id:"destination",value:l.destination,onChange:i=>g("destination",i.target.value),disabled:m,className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",children:[e.jsx("option",{value:"",children:"Any Destination"}),s.destinations.map(i=>e.jsx("option",{value:i,children:i},i))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"mode",className:"block text-sm font-medium text-gray-700 mb-1",children:"Mode"}),e.jsxs("select",{id:"mode",value:l.mode,onChange:i=>g("mode",i.target.value),disabled:m,className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",children:[e.jsx("option",{value:"",children:"Any Mode"}),s.modes.map(i=>e.jsx("option",{value:i,children:i.charAt(0).toUpperCase()+i.slice(1)},i))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"date_start",className:"block text-sm font-medium text-gray-700 mb-1",children:"Date Start"}),e.jsx("input",{type:"date",id:"date_start",value:l.date_start,onChange:i=>g("date_start",i.target.value),className:"block w-full pl-3 pr-2 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"date_end",className:"block text-sm font-medium text-gray-700 mb-1",children:"Date End"}),e.jsx("input",{type:"date",id:"date_end",value:l.date_end,onChange:i=>g("date_end",i.target.value),className:"block w-full pl-3 pr-2 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md"})]}),n&&e.jsx("pre",{className:"md:col-span-5 mt-2 text-xs bg-gray-50 border rounded p-3 overflow-auto max-h-64",children:JSON.stringify(N,null,2)})]})}function Yt({company:t,onSelect:s,onSave:r,isSaving:n,isSaved:o,isNew:l,onStartOutreach:d,onDraftRFP:N,savingCompanyId:m}){const f=i=>i?i>=1e6?`${(i/1e6).toFixed(1)}M`:i>=1e3?`${(i/1e3).toFixed(0)}K`:i.toLocaleString():"0",g=m===t.id;return e.jsxs(Ce.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},whileHover:{y:-2},className:"bg-white/90 backdrop-blur-sm rounded-2xl p-5 shadow-lg border border-gray-200/60 hover:shadow-xl transition-all duration-300 cursor-pointer",onClick:()=>s(t),children:[l&&e.jsx("div",{className:"mb-3",children:e.jsx(qe,{className:"bg-gradient-to-r from-green-500 to-emerald-500 text-white",children:"New Shipper"})}),e.jsx("div",{className:"flex justify-between items-start mb-4",children:e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-bold text-gray-900 truncate text-lg mb-1",children:t.name}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(pe,{className:"w-3 h-3"}),e.jsxs("span",{children:["ID: ",t.id]})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-600 font-medium mb-1",children:[e.jsx(Ge,{className:"w-3 h-3"}),"Shipments (12M)"]}),e.jsx("div",{className:"text-lg font-bold text-blue-900",children:f(t.shipments_12m)})]}),e.jsxs("div",{className:"bg-purple-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-purple-600 font-medium mb-1",children:[e.jsx(We,{className:"w-3 h-3"}),"Last Activity"]}),e.jsx("div",{className:"text-sm font-bold text-purple-900",children:t.last_seen?Xe(new Date(t.last_seen),"MMM d"):"N/A"})]})]}),e.jsxs("div",{className:"space-y-2 mb-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Je,{className:"w-3 h-3 text-gray-500"}),e.jsx("span",{className:"text-gray-600",children:"Top Route:"}),e.jsx("span",{className:"font-medium text-gray-900 truncate flex-1",children:t.top_route||"Various routes"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"w-3 h-3 text-gray-500"}),e.jsx("span",{className:"text-gray-600",children:"Top Carrier:"}),e.jsx("span",{className:"font-medium text-gray-900 truncate flex-1",children:t.top_carrier||"Multiple carriers"})]})]}),e.jsxs("div",{className:"flex gap-2",onClick:i=>i.stopPropagation(),children:[e.jsxs(Q,{size:"sm",variant:"outline",onClick:()=>r(t),disabled:g||o,className:"flex-1",children:[g&&e.jsx(Ze,{className:"mr-2 h-3 w-3 animate-spin"}),o?e.jsx(st,{className:"w-3 h-3 mr-1 text-blue-600"}):e.jsx(Ke,{className:"w-3 h-3 mr-1"}),o?"Saved":"Save"]}),e.jsxs(Q,{size:"sm",onClick:()=>d(t),className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white",children:[e.jsx(Ye,{className:"w-3 h-3 mr-1"}),"Contact"]})]})]})}function es({company:t,onSelect:s,onSave:r,isSaving:n,isSaved:o,isNew:l,onStartOutreach:d,onDraftRFP:N,savingCompanyId:m,index:f=0}){const g=b=>b?b>=1e6?`${(b/1e6).toFixed(1)}M`:b>=1e3?`${(b/1e3).toFixed(0)}K`:b.toLocaleString():"0",i=m===t.id;return e.jsx(Ce.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:f*.05},className:"p-4 hover:bg-gray-50/80 transition-all duration-200 cursor-pointer border-b border-gray-100 last:border-b-0",onClick:()=>s(t),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0 pr-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900 truncate",children:t.name}),l&&e.jsx(qe,{className:"bg-gradient-to-r from-green-500 to-emerald-500 text-white text-xs",children:"New"})]}),e.jsx("div",{className:"flex items-center gap-4 text-sm text-gray-600 mb-2",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(pe,{className:"w-3 h-3"}),e.jsxs("span",{children:["ID: ",t.id]})]})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-1 text-blue-600 font-medium",children:[e.jsx(Ge,{className:"w-3 h-3"}),e.jsx("span",{children:"Shipments (12M):"})]}),e.jsx("span",{className:"font-bold text-blue-900",children:g(t.shipments_12m)})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-1 text-purple-600 font-medium",children:[e.jsx(We,{className:"w-3 h-3"}),e.jsx("span",{children:"Last Activity:"})]}),e.jsx("span",{className:"font-bold text-purple-900",children:t.last_seen?Xe(new Date(t.last_seen),"MMM d"):"N/A"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("div",{className:"flex items-center gap-1 text-gray-500 font-medium",children:[e.jsx(Je,{className:"w-3 h-3"}),e.jsx("span",{children:"Top Route:"})]}),e.jsx("span",{className:"font-medium text-gray-900 truncate",children:t.top_route||"Various routes"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm mt-2",children:e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Top Carrier:"}),e.jsx("span",{className:"ml-1 font-medium text-gray-900 truncate",children:t.top_carrier||"Multiple carriers"})]})})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",onClick:b=>b.stopPropagation(),children:[e.jsxs(Q,{size:"sm",variant:"outline",onClick:()=>r(t),disabled:i||o,className:"hidden sm:inline-flex",children:[i&&e.jsx(Ze,{className:"mr-2 h-3 w-3 animate-spin"}),o?e.jsx(st,{className:"w-3 h-3 mr-1 text-blue-600"}):e.jsx(Ke,{className:"w-3 h-3 mr-1"}),o?"Saved":"Save"]}),e.jsxs(Q,{size:"sm",onClick:()=>d(t),className:"bg-blue-600 hover:bg-blue-700 text-white hidden sm:inline-flex",children:[e.jsx(Ye,{className:"w-3 h-3 mr-1"}),"Contact"]})]})]})})}function ts({searchResults:t,totalResults:s,isLoading:r,onCompanySelect:n,onSave:o,onStartOutreach:l,onDraftRFP:d,user:N,newShipperEvents:m,savedCompanyIds:f,savingCompanyId:g,viewMode:i,setViewMode:b,currentPage:x,totalPages:F,onPageChange:T}){const j=t&&t.length>0;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Search Results"}),!r&&e.jsxs("p",{className:"text-gray-500 text-sm mt-1",children:["Found ",Number(s||0).toLocaleString()," companies • Showing ",(t==null?void 0:t.length)||0," on this page"]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-1 bg-gray-100 p-1 rounded-lg",children:[e.jsxs(Q,{size:"sm",variant:i==="grid"?"secondary":"ghost",onClick:()=>b("grid"),className:"h-8 px-3",children:[e.jsx(Jt,{className:"w-4 h-4 mr-1"}),"Cards"]}),e.jsxs(Q,{size:"sm",variant:i==="list"?"secondary":"ghost",onClick:()=>b("list"),className:"h-8 px-3",children:[e.jsx(_t,{className:"w-4 h-4 mr-1"}),"List"]})]}),F>1&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Q,{variant:"outline",size:"sm",onClick:()=>T(x-1),disabled:x===1||r,className:"h-8",children:e.jsx(Gt,{className:"h-4 w-4"})}),e.jsxs("span",{className:"text-sm text-gray-600 px-2",children:["Page ",x," of ",F]}),e.jsx(Q,{variant:"outline",size:"sm",onClick:()=>T(x+1),disabled:x>=F||r,className:"h-8",children:e.jsx(Et,{className:"h-4 w-4"})})]})]})]}),r?e.jsx("div",{className:`grid gap-4 md:gap-6 ${i==="grid"?"grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4":"grid-cols-1"}`,children:Array.from({length:12}).map((M,E)=>e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-4"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2 mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/3 mb-4"}),e.jsx("div",{className:"h-16 bg-gray-200 rounded mb-4"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded flex-1"}),e.jsx("div",{className:"h-8 bg-gray-200 rounded flex-1"})]})]},E))}):j?e.jsx("div",{className:`grid gap-4 md:gap-6 ${i==="grid"?"grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4":"grid-cols-1"}`,children:e.jsx(kt,{children:t.map(M=>{const E=M.company_id||M.id,A=g===E,z=f.has(E),H=m.includes(E);return i==="grid"?e.jsx(Yt,{company:M,onSelect:n,onSave:o,isSaving:A,isSaved:z,isNew:H,onStartOutreach:l,onDraftRFP:d,savingCompanyId:g},E):e.jsx(es,{company:M,onSelect:n,onSave:o,isSaving:A,isSaved:z,isNew:H,onStartOutreach:l,onDraftRFP:d,savingCompanyId:g},E)})})}):e.jsxs(Ce.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center py-16 bg-white rounded-2xl border border-dashed border-gray-300",children:[e.jsx(Ve,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-4 text-lg font-medium text-gray-900",children:"No results found"}),e.jsx("p",{className:"mt-2 text-sm text-gray-500 max-w-sm mx-auto",children:"Try adjusting your search query or filters to find companies."})]})]})}const me=25;function $s(){const t=vt(),[s,r]=c.useState(null),[n,o]=c.useState(""),[l,d]=c.useState({mode:"",origin:"",destination:"",date_start:null,date_end:null}),[N,m]=c.useState([]),[f,g]=c.useState(!1),[i,b]=c.useState(""),[x,F]=c.useState(null),[T,j]=c.useState(!1),[M,E]=c.useState(!1),[A,z]=c.useState(""),[H,ne]=c.useState(1),[le,k]=c.useState(0),[ee,C]=c.useState(new Set),[$,D]=c.useState(null),[V,Ee]=c.useState(null),[rt,at]=c.useState("grid"),[ke,it]=c.useState(!1);c.useEffect(()=>{const p=setTimeout(()=>b(n),300);return()=>clearTimeout(p)},[n]),c.useEffect(()=>{ke&&oe(1)},[i,l]);const Ie=c.useMemo(()=>Math.max(1,Math.ceil((le||0)/me)),[le]),Me=c.useCallback(async()=>{try{const p=await jt.me();r(p)}catch(p){console.error("Error loading user:",p)}},[]);c.useEffect(()=>{Me()},[Me]);const oe=c.useCallback(async p=>{var W,ce,te;const I=p||1;g(!0),Ee(null),ne(I),it(!0);try{const U=(I-1)*me,dt={q:n||void 0,mode:l.mode||"all",filters:{origin:l.origin?[l.origin]:void 0,destination:l.destination?[l.destination]:void 0},dateRange:{from:l.date_start||void 0,to:l.date_end||void 0},pagination:{limit:me,offset:U}},S=await wt(dt),ht=Array.isArray(S==null?void 0:S.results)?S.results:((W=S==null?void 0:S.data)==null?void 0:W.items)||((ce=S==null?void 0:S.data)==null?void 0:ce.results)||[],mt=typeof(S==null?void 0:S.total)=="number"?S.total:((te=S==null?void 0:S.data)==null?void 0:te.total)||0;m(ht),k(mt)}catch(U){console.error("Search error:",U),Ee((U==null?void 0:U.message)&&String(U.message)||"Search failed. Please try again."),m([]),k(0)}finally{g(!1)}},[n,l]),nt=c.useCallback(p=>{F(p),j(!0)},[]),Fe=async p=>{if(!s||$)return;const I=p.id;D(I);const W=new Set(ee),ce=W.has(I),te=new Set(W);ce||te.add(I),C(te);try{await Rt({name:p.name,website:p.website||void 0,external_ref:String(I)})}catch(U){console.error("Failed to save company:",U),C(W),alert("Failed to save company. Please try again.")}finally{D(null)}},lt=p=>{const I=p.id;I&&t(Pe("EmailCenter?company_id="+I))},ot=p=>{const I=p.id;I&&t(Pe("RFPStudio?company_id="+I))},ct=p=>{p>=1&&p<=Ie&&!f&&oe(p)};return e.jsx("div",{className:"p-4 md:p-6 lg:p-8 bg-gradient-to-br from-gray-50 to-blue-50/30 min-h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center mb-6 lg:mb-8 gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl lg:text-4xl font-bold text-gray-900",children:"Trade Intelligence Discovery"}),e.jsx("p",{className:"text-gray-600 mt-2 text-sm md:text-base",children:"Search companies by trade activity, routes, commodities, and shipping patterns"})]})}),e.jsx("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg p-4 md:p-6 mb-6 md:mb-8 border border-gray-200/60",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Nt,{value:n,onChange:p=>o(p.target.value),placeholder:"Search by company name or alias (e.g., UPS, Maersk)...",className:"pl-4 pr-12 py-3 text-base md:text-lg bg-gray-50 border-0 rounded-xl",onKeyDown:p=>{p.key==="Enter"&&oe(1)}}),e.jsx(Qe,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"})]}),e.jsx(Q,{onClick:()=>oe(1),disabled:f,className:"px-6 md:px-8 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white font-semibold rounded-xl",children:f?"Searching...":"Search"})]})}),e.jsx(Xt,{onChange:d}),V&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 mb-6",children:e.jsxs("div",{className:"flex items-center gap-2 text-red-800",children:[e.jsx("span",{className:"font-semibold",children:"Search Error:"}),e.jsx("span",{children:V})]})}),ke?e.jsx(ts,{searchResults:N,totalResults:le,isLoading:f,onCompanySelect:nt,onSave:Fe,onStartOutreach:lt,onDraftRFP:ot,user:s,newShipperEvents:[],savedCompanyIds:ee,savingCompanyId:$,viewMode:rt,setViewMode:at,currentPage:H,totalPages:Ie,onPageChange:ct}):e.jsxs("div",{className:"text-center py-16 bg-white rounded-2xl border border-dashed border-gray-300",children:[e.jsx(Qe,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Ready to Search"}),e.jsx("p",{className:"text-sm text-gray-500 max-w-sm mx-auto",children:"Enter a company name or use the filters above to search for trade intelligence data."})]}),e.jsx(It,{isOpen:M,onClose:()=>E(!1),feature:A,currentPlan:s==null?void 0:s.plan}),e.jsx(Ct,{company:x,isOpen:T,onClose:()=>j(!1),onSave:Fe,user:s})]})})}export{$s as default};
