import{r as c,j as e,C as S,a as T,b as D,c as E,B as v}from"./index-CJ0A1Eq-.js";import{M as _e,i as Se,u as ge,P as Me,a as Ae,b as Ie,L as Ee}from"./proxy-DvflroGm.js";import{D as Le,a as $e,b as Te,c as De,X as Pe}from"./dialog-CrfjnCRg.js";import{B as L}from"./badge-YfhJuZ1t.js";import{T as ze,a as Fe,b as B,c as H}from"./tabs-De25X-I2.js";import{Contact as Y,Note as me}from"./entities-BF_CoRhL.js";import{c as Re}from"./index-A7ElDbZk.js";import{t as xe,p as Ue,e as fe,b as Ve,c as qe}from"./functions-Do0OGpwV.js";import{B as re}from"./building-2-B_7Dphg2.js";import{c as M}from"./createLucideIcon-CIkJFOj8.js";import{T as Q,P as ne}from"./truck-C0U-bRcK.js";import{S as P}from"./ship-DXxrcy2n.js";import{f as K,M as je}from"./format-DOKKjNmF.js";import{S as ee,a as se,b as te,c as ae,d as I}from"./select-CuYA18NV.js";import{I as O}from"./input-f_sthfNV.js";import{L as R}from"./label-CF5EWYG6.js";import{D as Be,a as He,b as Oe,c as he}from"./dropdown-menu-CTannhUZ.js";import{L as Z}from"./loader-circle-CeuHJ5kT.js";import{S as We}from"./search-BHFJtF4A.js";import{P as Ne}from"./plus-Dy46BZc2.js";import{L as ye,T as Ge}from"./textarea-CgpfxEw1.js";import{U as ve}from"./users-XCs20ZRm.js";import{M as Xe}from"./message-square-FgTODblA.js";import{T as Je}from"./trash-2-DZiELyKw.js";import{T as Ye}from"./trending-up-Badqa_o0.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]],be=M("Bookmark",Qe);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],Ke=M("ChartColumn",Ze);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const es=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],ss=M("EllipsisVertical",es);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ts=[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]],as=M("Filter",ts);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rs=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],ns=M("Globe",rs);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ls=[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]],pe=M("Linkedin",ls);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const is=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],cs=M("Package",is);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ds=[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]],os=M("Phone",ds);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ms=[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]],J=M("Sparkles",ms);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],hs=M("SquarePen",xs);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ps=[["rect",{width:"16",height:"16",x:"4",y:"3",rx:"2",key:"1wxw4b"}],["path",{d:"M4 11h16",key:"mpoxn0"}],["path",{d:"M12 3v8",key:"1h2ygw"}],["path",{d:"m8 19-2 3",key:"13i0xs"}],["path",{d:"m18 22-2-3",key:"1p0ohu"}],["path",{d:"M8 15h.01",key:"a7atzg"}],["path",{d:"M16 15h.01",key:"rnfrdf"}]],le=M("TramFront",ps);class us extends c.Component{getSnapshotBeforeUpdate(m){const t=this.props.childRef.current;if(t&&m.isPresent&&!this.props.isPresent){const i=t.offsetParent,d=Se(i)&&i.offsetWidth||0,l=this.props.sizeRef.current;l.height=t.offsetHeight||0,l.width=t.offsetWidth||0,l.top=t.offsetTop,l.left=t.offsetLeft,l.right=d-l.width-l.left}return null}componentDidUpdate(){}render(){return this.props.children}}function gs({children:s,isPresent:m,anchorX:t,root:i}){const d=c.useId(),l=c.useRef(null),n=c.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:p}=c.useContext(_e);return c.useInsertionEffect(()=>{const{width:u,height:x,top:f,left:g,right:a}=n.current;if(m||!l.current||!u||!x)return;const o=t==="left"?`left: ${g}`:`right: ${a}`;l.current.dataset.motionPopId=d;const h=document.createElement("style");p&&(h.nonce=p);const r=i??document.head;return r.appendChild(h),h.sheet&&h.sheet.insertRule(`
          [data-motion-pop-id="${d}"] {
            position: absolute !important;
            width: ${u}px !important;
            height: ${x}px !important;
            ${o}px !important;
            top: ${f}px !important;
          }
        `),()=>{r.contains(h)&&r.removeChild(h)}},[m]),e.jsx(us,{isPresent:m,childRef:l,sizeRef:n,children:c.cloneElement(s,{ref:l})})}const fs=({children:s,initial:m,isPresent:t,onExitComplete:i,custom:d,presenceAffectsLayout:l,mode:n,anchorX:p,root:u})=>{const x=ge(js),f=c.useId();let g=!0,a=c.useMemo(()=>(g=!1,{id:f,initial:m,isPresent:t,custom:d,onExitComplete:o=>{x.set(o,!0);for(const h of x.values())if(!h)return;i&&i()},register:o=>(x.set(o,!1),()=>x.delete(o))}),[t,x,i]);return l&&g&&(a={...a}),c.useMemo(()=>{x.forEach((o,h)=>x.set(h,!1))},[t]),c.useEffect(()=>{!t&&!x.size&&i&&i()},[t]),n==="popLayout"&&(s=e.jsx(gs,{isPresent:t,anchorX:p,root:u,children:s})),e.jsx(Me.Provider,{value:a,children:s})};function js(){return new Map}const X=s=>s.key||"";function ue(s){const m=[];return c.Children.forEach(s,t=>{c.isValidElement(t)&&m.push(t)}),m}const Ks=({children:s,custom:m,initial:t=!0,onExitComplete:i,presenceAffectsLayout:d=!0,mode:l="sync",propagate:n=!1,anchorX:p="left",root:u})=>{const[x,f]=Ae(n),g=c.useMemo(()=>ue(s),[s]),a=n&&!x?[]:g.map(X),o=c.useRef(!0),h=c.useRef(g),r=ge(()=>new Map),[j,U]=c.useState(g),[k,b]=c.useState(g);Ie(()=>{o.current=!1,h.current=g;for(let C=0;C<k.length;C++){const y=X(k[C]);a.includes(y)?r.delete(y):r.get(y)!==!0&&r.set(y,!1)}},[k,a.length,a.join("-")]);const $=[];if(g!==j){let C=[...g];for(let y=0;y<k.length;y++){const z=k[y],q=X(z);a.includes(q)||(C.splice(y,0,z),$.push(z))}return l==="wait"&&$.length&&(C=$),b(ue(C)),U(g),null}const{forceRender:V}=c.useContext(Ee);return e.jsx(e.Fragment,{children:k.map(C=>{const y=X(C),z=n&&!x?!1:g===k||a.includes(y),q=()=>{if(r.has(y))r.set(y,!0);else return;let W=!0;r.forEach(G=>{G||(W=!1)}),W&&(V==null||V(),b(h.current),n&&(f==null||f()),i&&i())};return e.jsx(fs,{isPresent:z,initial:!o.current||t?void 0:!1,custom:m,presenceAffectsLayout:d,mode:l,root:u,onExitComplete:z?void 0:q,anchorX:p,children:C},y)})})};function Ns({company:s,isLoading:m}){const t=c.useMemo(()=>s?{totalShipments:s.shipments_12m||0,topRoute:s.top_route||"N/A",topCarriers:s.top_carriers||[],modeBreakdown:s.mode_breakdown||[]}:null,[s]),i=d=>({ocean:P,air:ne,truck:Q,rail:le,unknown:P})[d]||P;return m?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs(S,{children:[e.jsx(T,{children:e.jsxs(D,{className:"text-lg flex items-center gap-2",children:[e.jsx(re,{className:"w-5 h-5"}),"Company Details"]})}),e.jsxs(E,{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Industry:"}),e.jsx("p",{className:"font-medium",children:s.industry||"Not specified"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Headquarters:"}),e.jsx("p",{className:"font-medium",children:[s.hq_city,s.hq_country].filter(Boolean).join(", ")||"Not specified"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Domain:"}),e.jsx("p",{className:"font-medium",children:s.domain?e.jsx("a",{href:`http://${s.domain}`,target:"_blank",rel:"noopener noreferrer",className:"ml-1 text-blue-600 hover:underline",children:s.domain}):"Not specified"})]}),s.employee_count&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Employees:"}),e.jsx("p",{className:"font-medium",children:s.employee_count.toLocaleString()})]})]})]}),e.jsxs(S,{children:[e.jsx(T,{children:e.jsxs(D,{className:"text-lg flex items-center gap-2",children:[e.jsx(Ke,{className:"w-5 h-5"}),"Trade Activity Overview"]})}),e.jsxs(E,{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Total Shipments (12m):"}),e.jsx("p",{className:"font-bold text-purple-700 text-lg",children:((t==null?void 0:t.totalShipments)||0).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Top Route:"}),e.jsx("p",{className:"font-medium",children:t==null?void 0:t.topRoute})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Last Seen:"}),e.jsx("p",{className:"font-medium",children:s.last_seen?K(new Date(s.last_seen),"MMM d, yyyy"):"No recent activity"})]})]})]})]}),t&&e.jsx("div",{className:"grid md:grid-cols-1 gap-6",children:e.jsxs(S,{children:[e.jsx(T,{children:e.jsxs(D,{className:"text-lg flex items-center gap-2",children:[e.jsx(Q,{className:"w-5 h-5"}),"Primary Carriers"]})}),e.jsx(E,{children:e.jsx("div",{className:"space-y-3",children:t.topCarriers.length>0?t.topCarriers.map((d,l)=>e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("span",{className:"text-sm font-medium text-gray-900",children:d})},l)):e.jsx("p",{className:"text-gray-500 text-sm",children:"No carrier data available"})})})]})}),t&&t.modeBreakdown.length>0&&e.jsxs(S,{children:[e.jsx(T,{children:e.jsx(D,{className:"text-lg",children:"Transportation Modes"})}),e.jsx(E,{children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:t.modeBreakdown.map(d=>{const l=i(d.mode),n=t.totalShipments,p=n>0?(d.cnt/n*100).toFixed(1):0;return e.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[e.jsx(l,{className:"w-8 h-8 mx-auto mb-2 text-blue-600"}),e.jsx("h4",{className:"font-semibold capitalize text-gray-900",children:d.mode}),e.jsxs("p",{className:"text-sm text-gray-600",children:[d.cnt," shipments (",p,"%)"]})]},d.mode)})})})]}),s.top_hs&&s.top_hs.length>0&&e.jsxs(S,{children:[e.jsx(T,{children:e.jsxs(D,{className:"text-lg flex items-center gap-2",children:[e.jsx(cs,{className:"w-5 h-5"}),"Top Commodities (HS Codes)"]})}),e.jsx(E,{children:e.jsx("div",{className:"flex flex-wrap gap-2",children:s.top_hs.slice(0,10).map((d,l)=>e.jsx(L,{variant:"outline",className:"text-xs",children:d},l))})})]})]})}function ys({shipments:s,isLoading:m}){const[t,i]=c.useState("date"),[d,l]=c.useState("desc"),[n,p]=c.useState("all"),u=a=>a==null?"N/A":a>=1e6?`${(a/1e6).toFixed(1)}M kg`:a>=1e3?`${(a/1e3).toFixed(0)}K kg`:`${a.toFixed(0)} kg`,x=c.useMemo(()=>{let a=s;return n!=="all"&&(a=s.filter(o=>{var h;return((h=o.mode)==null?void 0:h.toLowerCase())===n})),Array.isArray(a)||(a=[]),[...a].sort((o,h)=>{let r=o[t],j=h[t];return r==null&&(r=""),j==null&&(j=""),t==="date"?(r=r?new Date(r):new Date(0),j=j?new Date(j):new Date(0)):t==="gross_weight_kg"&&(r=r||0,j=j||0),d==="asc"?typeof r=="string"&&typeof j=="string"?r.localeCompare(j):r>j?1:-1:typeof r=="string"&&typeof j=="string"?j.localeCompare(r):r<j?1:-1})},[s,t,d,n]),f=a=>{const h={ocean:P,air:ne,truck:Q,rail:le}[a==null?void 0:a.toLowerCase()]||P;return e.jsx(h,{className:"w-4 h-4"})},g=a=>({ocean:"bg-blue-100 text-blue-800",air:"bg-purple-100 text-purple-800",truck:"bg-green-100 text-green-800",rail:"bg-orange-100 text-orange-800"})[a==null?void 0:a.toLowerCase()]||"bg-gray-100 text-gray-800";return m?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"})}):!s||s.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(P,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-600 mb-2",children:"No shipment data"}),e.jsx("p",{className:"text-gray-500",children:"No shipment records found for this company"})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between items-start sm:items-center",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(as,{className:"w-4 h-4 text-gray-500"}),e.jsxs(ee,{value:n,onValueChange:p,children:[e.jsx(se,{className:"w-32",children:e.jsx(te,{placeholder:"All Modes"})}),e.jsxs(ae,{children:[e.jsx(I,{value:"all",children:"All Modes"}),e.jsx(I,{value:"ocean",children:"Ocean"}),e.jsx(I,{value:"air",children:"Air"}),e.jsx(I,{value:"truck",children:"Truck"}),e.jsx(I,{value:"rail",children:"Rail"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Sort by:"}),e.jsxs(ee,{value:t,onValueChange:i,children:[e.jsx(se,{className:"w-32",children:e.jsx(te,{placeholder:"Date"})}),e.jsxs(ae,{children:[e.jsx(I,{value:"date",children:"Date"}),e.jsx(I,{value:"gross_weight_kg",children:"Weight"}),e.jsx(I,{value:"carrier_name",children:"Carrier"}),e.jsx(I,{value:"origin_country",children:"Origin"})]})]}),e.jsx(v,{variant:"outline",size:"sm",onClick:()=>l(d==="asc"?"desc":"asc"),children:d==="asc"?"↑":"↓"})]})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[x.length," of ",s.length," shipments"]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden shadow-sm",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Mode"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Route"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Weight"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Carrier"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Commodity"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:x.slice(0,50).map((a,o)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 whitespace-nowrap",children:a.date?K(new Date(a.date),"MMM d, yyyy"):"N/A"}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2 whitespace-nowrap",children:[f(a.mode),e.jsx(L,{className:`text-xs ${g(a.mode)}`,children:a.mode||"Unknown"})]})}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:e.jsxs("div",{className:"max-w-xs overflow-hidden",children:[e.jsx("div",{className:"font-medium truncate",children:a.origin_country||a.origin_port||"Unknown"}),e.jsxs("div",{className:"text-gray-500 text-xs truncate",children:["→ ",a.dest_country||a.dest_port||"Unknown"]})]})}),e.jsx("td",{className:"px-4 py-3 text-sm font-medium text-blue-700 whitespace-nowrap",children:u(a.gross_weight_kg)}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:e.jsx("div",{className:"max-w-xs truncate",children:a.carrier_name||a.carrier||"Unknown"})}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:e.jsx("div",{className:"max-w-xs truncate",children:a.commodity_description||a.hs_code||"N/A"})})]},a.id||o))})]})}),x.length>50&&e.jsx("div",{className:"bg-gray-50 px-4 py-3 text-center border-t border-gray-200",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Showing first 50 shipments. ",x.length-50," more available."]})})]})]})}function vs({onSubmit:s,onCancel:m}){const[t,i]=c.useState({full_name:"",title:"",dept:"",email:"",phone:"",linkedin:""}),d=n=>{if(n.preventDefault(),!t.full_name.trim()){alert("Full name is required");return}s(t),i({full_name:"",title:"",dept:"",email:"",phone:"",linkedin:""})},l=["Logistics","Supply Chain","Procurement","Operations","Sales","Marketing","Finance","Executive","Other"];return e.jsxs("form",{onSubmit:d,className:"space-y-4",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(R,{children:"Full Name (Required)"}),e.jsx(O,{value:t.full_name,onChange:n=>i(p=>({...p,full_name:n.target.value})),placeholder:"Enter full name",required:!0})]}),e.jsxs("div",{children:[e.jsx(R,{children:"Job Title"}),e.jsx(O,{value:t.title,onChange:n=>i(p=>({...p,title:n.target.value})),placeholder:"e.g., Logistics Manager"})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(R,{children:"Department"}),e.jsxs(ee,{value:t.dept,onValueChange:n=>i(p=>({...p,dept:n})),children:[e.jsx(se,{children:e.jsx(te,{placeholder:"Select department"})}),e.jsx(ae,{children:l.map(n=>e.jsx(I,{value:n,children:n},n))})]})]}),e.jsxs("div",{children:[e.jsx(R,{children:"Email Address"}),e.jsx(O,{type:"email",value:t.email,onChange:n=>i(p=>({...p,email:n.target.value})),placeholder:"contact@company.com"})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(R,{children:"Phone Number"}),e.jsx(O,{value:t.phone,onChange:n=>i(p=>({...p,phone:n.target.value})),placeholder:"+1 (555) 123-4567"})]}),e.jsxs("div",{children:[e.jsx(R,{children:"LinkedIn Profile URL"}),e.jsx(O,{value:t.linkedin,onChange:n=>i(p=>({...p,linkedin:n.target.value})),placeholder:"https://linkedin.com/in/profile"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(v,{type:"button",variant:"outline",onClick:m,children:"Cancel"}),e.jsx(v,{type:"submit",className:"bg-blue-600 hover:bg-blue-700",children:"Save Contact"})]})]})}const bs=s=>{switch(s==null?void 0:s.toLowerCase()){case"linkedin":return"bg-blue-100 text-blue-800";case"email":return"bg-yellow-100 text-yellow-800";case"referral":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},ws=s=>{switch(s==null?void 0:s.toLowerCase()){case"responded":return"bg-green-100 text-green-800";case"pending":return"bg-yellow-100 text-yellow-800";case"not_contacted":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},ks=({contact:s,onRefresh:m,onEdit:t})=>{var p,u;const[i,d]=c.useState({}),l=async x=>{confirm("Are you sure you want to delete this contact?")&&(await Y.delete(x),m())},n=async(x,f)=>{var a,o,h;if(!x.linkedin){alert("No LinkedIn profile available for this contact.");return}const g=`${x.id}_${f}`;d({...i,[g]:!0});try{const r=f==="connect"?`Hi ${((a=x.full_name)==null?void 0:a.split(" ")[0])||""}, I'd like to connect and share some insights about your industry.`:`Hi ${((o=x.full_name)==null?void 0:o.split(" ")[0])||""}, I have some valuable market intelligence that might interest your team. Would you be open to a quick conversation?`,j=await Ue({action:f,profile_url:x.linkedin,message:r,contactId:x.id});if(j.status===200)alert(`LinkedIn ${f} initiated for ${x.full_name}.`),await Y.update(x.id,{last_contacted:new Date().toISOString()}),m();else throw new Error(((h=j.data)==null?void 0:h.error)||`LinkedIn ${f} failed`)}catch(r){console.error(`LinkedIn ${f} error:`,r),alert(`Failed to ${f} ${x.full_name}. ${r.message}`)}finally{d({...i,[g]:!1})}};return e.jsxs(S,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-blue-600 font-semibold text-lg",children:((p=s.full_name)==null?void 0:p.charAt(0))||"?"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-gray-900",children:s.full_name}),e.jsx("p",{className:"text-sm text-gray-600",children:s.title}),s.dept&&e.jsx("p",{className:"text-sm text-gray-500",children:s.dept}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm",children:[s.email&&e.jsxs("a",{href:`mailto:${s.email}`,className:"text-blue-600 hover:underline flex items-center gap-1",children:[e.jsx(je,{className:"w-4 h-4"}),s.email]}),s.phone&&e.jsxs("span",{className:"text-gray-600 flex items-center gap-1",children:[e.jsx(os,{className:"w-4 h-4"}),s.phone]}),s.linkedin&&e.jsxs("a",{href:s.linkedin,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline flex items-center gap-1",children:[e.jsx(pe,{className:"w-4 h-4"}),"LinkedIn"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[s.linkedin&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(v,{size:"sm",variant:"outline",onClick:()=>n(s,"connect"),disabled:i[`${s.id}_connect`],className:"text-blue-600 border-blue-200 hover:bg-blue-50",children:i[`${s.id}_connect`]?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}):e.jsxs(e.Fragment,{children:[e.jsx(pe,{className:"w-4 h-4 mr-1"}),"Connect"]})}),e.jsx(v,{size:"sm",variant:"outline",onClick:()=>n(s,"message"),disabled:i[`${s.id}_message`],className:"text-green-600 border-green-200 hover:bg-green-50",children:i[`${s.id}_message`]?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-green-600"}):e.jsxs(e.Fragment,{children:[e.jsx(Xe,{className:"w-4 h-4 mr-1"}),"Message"]})})]}),e.jsxs(Be,{children:[e.jsx(He,{asChild:!0,children:e.jsx(v,{variant:"ghost",size:"icon",children:e.jsx(ss,{className:"w-4 h-4"})})}),e.jsxs(Oe,{children:[e.jsxs(he,{onClick:t,children:[" ",e.jsx(hs,{className:"w-4 h-4 mr-2"}),"Edit Contact"]}),e.jsxs(he,{onClick:()=>l(s.id),className:"text-red-600",children:[e.jsx(Je,{className:"w-4 h-4 mr-2"}),"Delete Contact"]})]})]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-3",children:[s.verified&&e.jsx(L,{className:"bg-green-100 text-green-800",children:"Verified"}),s.source&&e.jsx(L,{className:`${bs(s.source)}`,children:s.source}),s.response_status&&e.jsx(L,{className:`${ws(s.response_status)}`,children:(u=s.response_status)==null?void 0:u.replace("_"," ")}),s.last_contacted&&e.jsxs(L,{variant:"outline",children:["Contacted ",K(new Date(s.last_contacted),"MMM dd")]})]})]})};function Cs({company:s,contacts:m,onAddContact:t,onFindContacts:i,isLoadingContacts:d,onRefresh:l,user:n}){const[p,u]=c.useState(!1),[x,f]=c.useState(null),[g,a]=c.useState(!1);c.useEffect(()=>{s&&n?(async()=>{try{const{data:j}=await xe({list:!0}),U=new Set(j.map(k=>k.company_id));a(U.has(s.company_id||s.id))}catch(j){console.error("Error checking save status:",j),a(!1)}})():a(!1)},[s,n]);const o=async()=>{try{await xe({companyId:s.company_id||s.id}),a(!0),f(null),u(!0)}catch(r){console.error("Error saving company:",r),alert("Failed to save company.")}},h=r=>{f(r),u(!0)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Contacts (",(m==null?void 0:m.length)||0,")"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(v,{variant:"outline",onClick:i,disabled:d||!g,className:"flex items-center gap-2",children:[d?e.jsx(Z,{className:"w-4 h-4 animate-spin"}):e.jsx(We,{className:"w-4 h-4"}),"Find Contacts"]}),g?e.jsxs(v,{onClick:()=>{f(null),u(!0)},className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700",children:[e.jsx(Ne,{className:"w-4 h-4"}),"Add Contact"]}):e.jsxs(v,{onClick:o,variant:"outline",className:"flex items-center gap-2",children:[e.jsx(be,{className:"w-4 h-4"}),"Save Company to Add Contacts"]})]})]}),!g&&e.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ye,{className:"w-5 h-5 text-amber-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-amber-800",children:"Save Company Required"}),e.jsx("p",{className:"text-sm text-amber-700 mt-1",children:"You need to save this company to your CRM before adding or managing contacts. This helps organize your prospects and enables campaign features."})]})]}),e.jsx(v,{onClick:o,className:"mt-3 bg-amber-600 hover:bg-amber-700 text-white",children:"Save Company & Add Contacts"})]}),p&&e.jsx(vs,{company:s,contact:x,onSave:r=>{t(r),u(!1),f(null)},onCancel:()=>{u(!1),f(null)}}),m&&m.length>0?e.jsx("div",{className:"grid gap-4",children:m.map(r=>e.jsx(ks,{contact:r,onRefresh:l,onEdit:()=>h(r)},r.id))}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(ve,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:"No contacts found"}),e.jsx("p",{className:"text-sm mb-4",children:"Start building your prospect database by finding or adding contacts"}),g&&e.jsxs("div",{className:"flex justify-center gap-2",children:[e.jsx(v,{variant:"outline",onClick:i,disabled:d,children:"Find Contacts"}),e.jsx(v,{onClick:()=>{f(null),u(!0)},children:"Add Contact Manually"})]})]})]})}function _s({company:s,onCompanyUpdate:m,user:t,isGated:i,onUnlock:d,isLoading:l,onEnrich:n,isEnriching:p}){const[u,x]=c.useState(null),[f,g]=c.useState(null),a=async()=>{var o,h;if(s!=null&&s.id){g(null);try{const r=await fe({company_id:s.id});(o=r.data)!=null&&o.ok?(x({profile:r.data.profile,score:r.data.score}),m&&m({...s,enrichment_status:"enriched",enrichment_data:r.data})):g(((h=r.data)==null?void 0:h.error)||"Enrichment failed")}catch(r){console.error("Enrichment error:",r),g("Enrichment failed: "+r.message)}}};return i?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"mb-4",children:e.jsx(J,{className:"mx-auto h-12 w-12 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"AI Insights Available"}),e.jsx("p",{className:"text-sm text-gray-500 mb-6 max-w-sm mx-auto",children:"Save this company to unlock AI-powered insights including trade patterns, commodities analysis, and business intelligence."}),e.jsxs(v,{onClick:d,disabled:l,className:"bg-blue-600 hover:bg-blue-700",children:[l&&e.jsx(Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Save Company to Unlock"]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"AI-Powered Business Intelligence"}),e.jsxs(v,{onClick:a,disabled:p,className:"bg-gradient-to-r from-purple-600 to-purple-700 hover:from-purple-700 hover:to-purple-800",children:[p&&e.jsx(Z,{className:"mr-2 h-4 w-4 animate-spin"}),e.jsx(J,{className:"w-4 h-4 mr-2"}),p?"Enriching...":"Enrich Now"]})]}),f&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsx("p",{className:"text-red-800 text-sm",children:f})}),u?e.jsxs("div",{className:"space-y-6",children:[u.score&&e.jsxs(S,{children:[e.jsx(T,{children:e.jsxs(D,{className:"flex items-center gap-2",children:[e.jsx(Ye,{className:"w-5 h-5 text-green-600"}),"Business Score"]})}),e.jsx(E,{children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"text-3xl font-bold text-green-600",children:u.score.overall||"N/A"}),e.jsx("div",{className:"flex-1",children:e.jsx("p",{className:"text-sm text-gray-600",children:"Overall business activity score based on trade patterns and volume"})})]})})]}),u.profile&&e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[u.profile.top_lanes&&e.jsxs(S,{children:[e.jsx(T,{children:e.jsxs(D,{className:"flex items-center gap-2",children:[e.jsx(P,{className:"w-5 h-5 text-blue-600"}),"Top Trade Lanes"]})}),e.jsx(E,{className:"space-y-2",children:u.profile.top_lanes.map((o,h)=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:o.route}),e.jsxs(L,{variant:"outline",children:[o.volume," shipments"]})]},h))})]}),u.profile.top_commodities&&e.jsxs(S,{children:[e.jsx(T,{children:e.jsxs(D,{className:"flex items-center gap-2",children:[e.jsx(re,{className:"w-5 h-5 text-purple-600"}),"Top Commodities"]})}),e.jsx(E,{className:"space-y-2",children:u.profile.top_commodities.map((o,h)=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:o.name}),e.jsxs(L,{variant:"outline",children:[o.percentage,"%"]})]},h))})]}),u.profile.top_carriers&&e.jsxs(S,{children:[e.jsx(T,{children:e.jsxs(D,{className:"flex items-center gap-2",children:[e.jsx(ve,{className:"w-5 h-5 text-orange-600"}),"Preferred Carriers"]})}),e.jsx(E,{className:"space-y-2",children:u.profile.top_carriers.map((o,h)=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:o.name}),e.jsxs(L,{variant:"outline",children:[o.share,"%"]})]},h))})]})]})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(J,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Generate AI Insights"}),e.jsx("p",{className:"text-sm text-gray-500 mb-6 max-w-sm mx-auto",children:'Click "Enrich Now" to generate comprehensive business intelligence using AI analysis of trade patterns.'})]})]})}function Ss({notes:s,onAddNote:m,isLoading:t}){const[i,d]=c.useState(""),l=()=>{i.trim()&&(m(i),d(""))};return t?e.jsx("div",{className:"text-center",children:"Loading notes..."}):e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Notes & Activity Log"}),e.jsxs("div",{className:"mb-4",children:[e.jsx(Ge,{placeholder:"Add a note about this company...",value:i,onChange:n=>d(n.target.value),className:"mb-2"}),e.jsxs(v,{onClick:l,size:"sm",children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),"Add Note"]})]}),e.jsx("div",{className:"space-y-4",children:s.length>0?s.map(n=>e.jsx(S,{className:"bg-gray-50",children:e.jsxs(E,{className:"p-4",children:[e.jsx("p",{className:"text-sm",children:n.content}),e.jsxs("div",{className:"text-xs text-gray-500 mt-2 flex justify-between",children:[e.jsxs("span",{children:["by ",n.created_by.split("@")[0]]}),e.jsx("span",{children:K(new Date(n.created_date),"MMM dd, yyyy HH:mm")})]})]})},n.id)):e.jsxs("div",{className:"text-center py-12 border-2 border-dashed rounded-lg",children:[e.jsx("p",{className:"text-gray-500",children:"No notes yet."}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Add a note to keep track of your interactions."})]})})]})}function et({company:s,isOpen:m,onClose:t,onSave:i,user:d}){const[l,n]=c.useState(null),[p,u]=c.useState([]),[x,f]=c.useState([]),[g,a]=c.useState([]),[o,h]=c.useState(!0),[r,j]=c.useState(!1),[U,k]=c.useState(!1),b=s==null?void 0:s.id,$=c.useCallback(async()=>{var N,A;if(b){h(!0);try{const w=Ve({company_id:b}),_=qe({company_id:b,limit:50}),F=Y.filter({company_id:b},"-created_date",50),we=me.filter({company_id:b},"-created_date",50),[de,oe,ke,Ce]=await Promise.all([w,_,F,we]);(N=de.data)!=null&&N.ok&&n(de.data.result),(A=oe.data)!=null&&A.ok&&u(oe.data.results),f(ke),a(Ce)}catch(w){console.error("Error loading related company data:",w)}finally{h(!1)}}},[b]);c.useEffect(()=>{m&&b?$():(n(null),u([]),a([]),f([]))},[m,b,$]);const V=async N=>{await Y.create({...N,company_id:b}),$()},C=async N=>{await me.create({content:N,company_id:b}),$()},y=async()=>{j(!0);try{await i(s)}catch(N){console.error("Error saving company:",N)}finally{j(!1)}},z=async()=>{var N,A;k(!0);try{const w=await fe({company_id:b});(N=w.data)!=null&&N.ok?$():alert("Enrichment failed: "+(((A=w.data)==null?void 0:A.error)||"Unknown error"))}catch(w){console.error("Error enriching company:",w),alert("Enrichment failed: "+w.message)}finally{k(!1)}},q=()=>{const N=Re("EmailCenter")+`?company_id=${b}`;window.location.href=N,t()},W=N=>{if(!N||N.length===0)return[];const A=N.reduce((w,_)=>w+_.cnt,0);return N.map(w=>{let _,F;switch(w.mode.toLowerCase()){case"ocean":_=P,F="text-blue-500";break;case"air":_=ne,F="text-purple-500";break;case"truck":_=Q,F="text-green-500";break;case"rail":_=le,F="text-purple-600";break;default:_=P,F="text-gray-500"}return{type:w.mode,percentage:A>0?Math.round(w.cnt/A*100):0,icon:_,color:F}}).sort((w,_)=>_.percentage-w.percentage)};if(!m||!s)return null;const G=!1,ie=W(l==null?void 0:l.mode_breakdown),ce=l||s;return e.jsx(e.Fragment,{children:e.jsx(Le,{open:m,onOpenChange:t,children:e.jsxs($e,{className:"max-w-4xl h-[90vh] flex flex-col p-0",children:[e.jsx(Te,{className:"p-6 border-b",children:e.jsxs("div",{className:"flex justify-between items-start gap-4",children:[e.jsxs("div",{children:[e.jsx(De,{className:"text-2xl font-bold text-gray-900",children:ce.name}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(re,{className:"w-4 h-4"}),e.jsxs("span",{children:["ID: ",b]})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(ns,{className:"w-4 h-4"}),e.jsx("span",{children:"Trade Data Available"})]})]}),ie.length>0&&e.jsx("div",{className:"flex items-center gap-2 mt-3",children:ie.map(N=>{const A=N.icon;return e.jsxs(L,{variant:"outline",className:"flex items-center gap-1.5 pl-2 pr-2.5 py-1",children:[e.jsx(A,{className:`w-4 h-4 ${N.color}`}),e.jsx("span",{className:"font-medium text-gray-700",children:N.type.charAt(0).toUpperCase()+N.type.slice(1)}),e.jsxs("span",{className:"text-gray-500",children:[N.percentage,"%"]})]},N.type)})})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsxs(v,{size:"sm",onClick:y,variant:"outline",className:"flex items-center gap-2",disabled:r||G,children:[r&&e.jsx(Z,{className:"mr-2 h-4 w-4 animate-spin"}),e.jsx(be,{className:"w-4 h-4"}),"Save"]}),e.jsxs(v,{size:"sm",className:"bg-blue-600 hover:bg-blue-700",onClick:q,children:[e.jsx(je,{className:"w-4 h-4 mr-2"}),"Start Outreach"]})]})]})}),e.jsx("div",{className:"flex-grow overflow-hidden",children:e.jsxs(ze,{defaultValue:"overview",className:"h-full flex flex-col",children:[e.jsx("div",{className:"px-6 border-b",children:e.jsxs(Fe,{children:[e.jsx(B,{value:"overview",children:"Overview"}),e.jsxs(B,{value:"shipments",children:["Shipments (",p.length,")"]}),e.jsxs(B,{value:"contacts",children:[e.jsx(ye,{className:"w-3 h-3 mr-1.5"}),"Contacts"]}),e.jsxs(B,{value:"ai_insights",children:[e.jsx(J,{className:"w-3 h-3 mr-1.5"}),"AI Insights"]}),e.jsxs(B,{value:"notes",children:["Notes (",g.length,")"]})]})}),e.jsxs("div",{className:"flex-grow overflow-auto",children:[e.jsx(H,{value:"overview",className:"p-6",children:e.jsx(Ns,{company:l,shipments:p,isLoading:o})}),e.jsx(H,{value:"shipments",className:"p-6",children:e.jsx(ys,{shipments:p,isLoading:o})}),e.jsx(H,{value:"contacts",className:"p-6",children:e.jsx(Cs,{contacts:x,companyId:b,company:ce,onAddContact:V,isGated:!G,onUnlock:y,isLoading:r})}),e.jsx(H,{value:"ai_insights",className:"p-6",children:e.jsx(_s,{company:l||s,onCompanyUpdate:n,user:d,isGated:!1,onUnlock:y,isLoading:r,onEnrich:z,isEnriching:U})}),e.jsx(H,{value:"notes",className:"p-6",children:e.jsx(Ss,{notes:g,onAddNote:C,isLoading:o})})]})]})}),e.jsx(v,{variant:"ghost",size:"icon",onClick:t,className:"absolute top-4 right-4 rounded-full",children:e.jsx(Pe,{className:"w-5 h-5"})})]})})})}export{Ks as A,be as B,et as C,ss as E,le as T};
