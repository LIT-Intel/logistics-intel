import{R as h,j as e,C as N,a as S,b as F,c as _,B as y,r as C}from"./index-CJ0A1Eq-.js";import{User as ae,RFPQuote as J}from"./entities-BF_CoRhL.js";import{T as te,a as re,b as V,c as Q}from"./tabs-De25X-I2.js";import{L as le}from"./LockedFeature-DPaMYEeR.js";import{c as X}from"./planLimits-C4PMM81i.js";import{I as f}from"./input-f_sthfNV.js";import{L as d}from"./label-CF5EWYG6.js";import{S as P,a as D,b as E,c as T,d as i}from"./select-CuYA18NV.js";import{T as ne}from"./textarea-CgpfxEw1.js";import{B as ie}from"./badge-YfhJuZ1t.js";import{T as z,P as ce}from"./truck-C0U-bRcK.js";import{S as Y}from"./ship-DXxrcy2n.js";import{B as oe}from"./building-2-B_7Dphg2.js";import{F as O}from"./file-text-CXweKAS_.js";import{S as de}from"./save-B4Am3CvM.js";import{D as ee}from"./download-Db29hUMV.js";import{S as me}from"./send-DtUGwlOw.js";import{M as K,f as he}from"./format-DOKKjNmF.js";import{d as xe,f as pe}from"./functions-Do0OGpwV.js";import{P as Z}from"./plus-Dy46BZc2.js";import{E as q}from"./eye-B6ag6yXX.js";import{c as ge}from"./createLucideIcon-CIkJFOj8.js";import"./base44Client-C-YMJfZQ.js";import"./index-BH5HQuNu.js";import"./index-CDq-ucEI.js";import"./index-C5R1OJl5.js";import"./proxy-DvflroGm.js";import"./Combination-DeBdDg8E.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],fe=ge("Settings",je),ue=[{id:"comp1",name:"ABC Logistics Inc.",email_domain:"abclogistics.com"},{id:"comp2",name:"Global Freight Solutions",email_domain:"globalfreight.com"},{id:"comp3",name:"Oceanic Transport Co.",email_domain:"oceanic.com"},{id:"comp4",name:"Rapid Cargo Solutions",email_domain:"rapidcargo.com"}],ye=[{id:"con1",company_id:"comp1",full_name:"John Smith",title:"Logistics Manager",email:"john.smith@abclogistics.com"},{id:"con2",company_id:"comp1",full_name:"Jane Doe",title:"Procurement Officer",email:"jane.doe@abclogistics.com"},{id:"con3",company_id:"comp2",full_name:"Peter Jones",title:"Shipping Coordinator",email:"peter.jones@globalfreight.com"},{id:"con4",company_id:"comp3",full_name:"Alice Brown",title:"Import Specialist",email:"alice.brown@oceanic.com"},{id:"con5",company_id:"comp4",full_name:"Bob Johnson",title:"Supply Chain Director",email:"bob.johnson@rapidcargo.com"}];function ve({quote:s,onQuoteChange:n,onSave:m,onGeneratePDF:v,onSendEmail:w,isGeneratingPDF:k,preSelectedCompany:u}){var W;const[c,p]=h.useState([]),[b,I]=h.useState([]),[L,U]=h.useState([]),[M,B]=h.useState(!0),[R,$]=h.useState(null);h.useEffect(()=>{(async()=>{B(!0),$(null);try{await new Promise(r=>setTimeout(r,300)),p(ue),I(ye)}catch(r){$("Failed to load company and contact data."),console.error("Error fetching company/contact data:",r)}finally{B(!1)}})()},[]);const A=h.useCallback(a=>{const r=c.find(j=>j.id===a),x=b.filter(j=>j.company_id===a);let l={...s,company_id:a,company_name:r?r.name:"",contact_id:"",contact_name:"",contact_email:""};if(x.length===1){const j=x[0];l.contact_id=j.id,l.contact_name=j.full_name,l.contact_email=j.email}U(x),n(l)},[c,b,s,n]);h.useEffect(()=>{if(u&&c.length>0){const a=c.find(r=>r.name===u);a&&a.id!==s.company_id&&A(a.id)}},[u,c,s.company_id,A]);const t=h.useCallback((a,r,x)=>{const l=`${a}_json`;n({...s,[l]:{...s[l],[r]:x}})},[s,n]),g=h.useCallback(()=>{var r,x,l,j;let a=0;(r=s.ocean_json)!=null&&r.rate&&(a+=parseFloat(s.ocean_json.rate)||0),(x=s.air_json)!=null&&x.rate&&(a+=parseFloat(s.air_json.rate)||0),(l=s.dray_json)!=null&&l.rate&&(a+=parseFloat(s.dray_json.rate)||0),(j=s.ftl_json)!=null&&j.rate&&(a+=parseFloat(s.ftl_json.rate)||0),s.total_cost!==a&&n({...s,total_cost:a})},[s,n]);h.useEffect(()=>{g()},[g]);const o=h.useMemo(()=>{var a;return((a=s.mode_combo)==null?void 0:a.split("_"))||["ocean"]},[s.mode_combo]),H=h.useCallback(a=>({ocean:Y,air:ce,truck:z,dray:z,ftl:z})[a]||Y,[]);h.useEffect(()=>{s.company_id&&b.length>0?U(b.filter(a=>a.company_id===s.company_id)):U([])},[s.company_id,b]);const G=h.useMemo(()=>{const a=!!s.contact_name&&!!s.contact_email&&!!s.company_name,r=!!s.origin&&!!s.destination&&!!s.commodity&&!!s.incoterm&&!!s.valid_until,x=o.every(l=>{const j=s[`${l}_json`];return j&&parseFloat(j.rate)>0});return a&&r&&x},[s,o]),se=h.useMemo(()=>G&&s.total_cost>0&&s.contact_email&&s.contact_email.includes("@"),[G,s.total_cost,s.contact_email]);return M?e.jsx("div",{className:"text-center py-8 text-gray-600",children:"Loading company and contact data..."}):R?e.jsx("div",{className:"text-center py-8 text-red-500",children:R}):e.jsxs("div",{className:"space-y-8",children:[e.jsxs(N,{className:"bg-white/80 backdrop-blur-sm shadow-lg border border-gray-200/60",children:[e.jsx(S,{children:e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(oe,{className:"w-5 h-5"}),"Contact & Delivery Information"]})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"company",children:"Company *"}),e.jsxs(P,{value:s.company_id||"",onValueChange:A,children:[e.jsx(D,{children:e.jsx(E,{placeholder:"Select company..."})}),e.jsx(T,{children:c.map(a=>e.jsx(i,{value:a.id,children:a.name},a.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"contact",children:"Contact Person"}),e.jsxs(P,{value:s.contact_id||"",onValueChange:a=>{const r=L.find(x=>x.id===a);n({...s,contact_id:a,contact_name:r?r.full_name:"",contact_email:r?r.email:""})},disabled:L.length===0,children:[e.jsx(D,{children:e.jsx(E,{placeholder:"Select contact..."})}),e.jsx(T,{children:L.map(a=>e.jsxs(i,{value:a.id,children:[a.full_name," - ",a.title]},a.id))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"contact_name",children:"Contact Name *"}),e.jsx(f,{id:"contact_name",value:s.contact_name||"",onChange:a=>n({...s,contact_name:a.target.value}),placeholder:"Enter contact name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"contact_email",children:"Contact Email *"}),e.jsx(f,{id:"contact_email",type:"email",value:s.contact_email||"",onChange:a=>n({...s,contact_email:a.target.value}),placeholder:"Enter email address"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"company_name",children:"Company Name *"}),e.jsx(f,{id:"company_name",value:s.company_name||"",onChange:a=>n({...s,company_name:a.target.value}),placeholder:"Enter company name"})]})]})]}),e.jsxs(N,{className:"bg-white/80 backdrop-blur-sm shadow-lg border border-gray-200/60",children:[e.jsx(S,{children:e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(O,{className:"w-5 h-5"}),e.jsx("span",{children:"Quote Details"})]})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"origin",children:"Origin"}),e.jsx(f,{id:"origin",value:s.origin||"",onChange:a=>n({...s,origin:a.target.value}),placeholder:"Shanghai, China"})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"destination",children:"Destination"}),e.jsx(f,{id:"destination",value:s.destination||"",onChange:a=>n({...s,destination:a.target.value}),placeholder:"Long Beach, USA"})]})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"commodity",children:"Commodity"}),e.jsx(f,{id:"commodity",value:s.commodity||"",onChange:a=>n({...s,commodity:a.target.value}),placeholder:"General Goods"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"incoterm",children:"Incoterm"}),e.jsxs(P,{value:s.incoterm||"",onValueChange:a=>n({...s,incoterm:a}),children:[e.jsx(D,{children:e.jsx(E,{placeholder:"Select Incoterm"})}),e.jsxs(T,{children:[e.jsx(i,{value:"EXW",children:"EXW - Ex Works"}),e.jsx(i,{value:"FOB",children:"FOB - Free on Board"}),e.jsx(i,{value:"CIF",children:"CIF - Cost, Insurance & Freight"}),e.jsx(i,{value:"DDP",children:"DDP - Delivered Duty Paid"}),e.jsx(i,{value:"DDU",children:"DDU - Delivered Duty Unpaid"})]})]})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"valid_until",children:"Valid Until"}),e.jsx(f,{id:"valid_until",type:"date",value:s.valid_until||"",onChange:a=>n({...s,valid_until:a.target.value})})]})]})]})]}),e.jsxs(N,{className:"bg-white/80 backdrop-blur-sm shadow-lg border border-gray-200/60",children:[e.jsx(S,{children:e.jsx(F,{children:"Transportation Modes"})}),e.jsxs(_,{children:[e.jsxs(P,{value:s.mode_combo||"ocean",onValueChange:a=>n({...s,mode_combo:a}),children:[e.jsx(D,{children:e.jsx(E,{placeholder:"Select mode combination"})}),e.jsxs(T,{children:[e.jsx(i,{value:"ocean",children:"Ocean Only"}),e.jsx(i,{value:"air",children:"Air Only"}),e.jsx(i,{value:"ocean_dray",children:"Ocean + Drayage"}),e.jsx(i,{value:"air_dray",children:"Air + Drayage"}),e.jsx(i,{value:"ocean_air",children:"Ocean + Air (Multimodal)"}),e.jsx(i,{value:"ocean_air_dray",children:"Ocean + Air + Drayage"}),e.jsx(i,{value:"ftl",children:"FTL Only"})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-4",children:o.map(a=>{const r=H(a);return e.jsxs(ie,{variant:"secondary",className:"flex items-center gap-1",children:[e.jsx(r,{className:"w-3 h-3"}),a.charAt(0).toUpperCase()+a.slice(1).replace(/_/g," ")]},a)})})]})]}),o.map(a=>{const r=s[`${a}_json`]||{},x=H(a);return e.jsxs(N,{className:"bg-white/80 backdrop-blur-sm shadow-lg border border-gray-200/60",children:[e.jsx(S,{children:e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(x,{className:"w-5 h-5"}),a.charAt(0).toUpperCase()+a.slice(1).replace(/_/g," ")," Freight"]})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:`${a}_rate`,children:"Rate"}),e.jsx(f,{id:`${a}_rate`,type:"number",value:r.rate||"",onChange:l=>t(a,"rate",l.target.value),placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:`${a}_currency`,children:"Currency"}),e.jsxs(P,{value:r.currency||"USD",onValueChange:l=>t(a,"currency",l),children:[e.jsx(D,{children:e.jsx(E,{placeholder:"USD"})}),e.jsxs(T,{children:[e.jsx(i,{value:"USD",children:"USD"}),e.jsx(i,{value:"EUR",children:"EUR"}),e.jsx(i,{value:"CNY",children:"CNY"}),e.jsx(i,{value:"GBP",children:"GBP"})]})]})]})]}),a==="ocean"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"ocean_transit_time",children:"Transit Time (days)"}),e.jsx(f,{id:"ocean_transit_time",type:"number",value:r.transit_time||"",onChange:l=>t("ocean","transit_time",l.target.value),placeholder:"25"})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"ocean_container_type",children:"Container Type"}),e.jsxs(P,{value:r.container_type||"20GP",onValueChange:l=>t("ocean","container_type",l),children:[e.jsx(D,{children:e.jsx(E,{placeholder:"20GP"})}),e.jsxs(T,{children:[e.jsx(i,{value:"20GP",children:"20' GP"}),e.jsx(i,{value:"40GP",children:"40' GP"}),e.jsx(i,{value:"40HQ",children:"40' HQ"}),e.jsx(i,{value:"45HQ",children:"45' HQ"})]})]})]})]}),a==="air"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"air_weight",children:"Weight (kg)"}),e.jsx(f,{id:"air_weight",type:"number",value:r.weight||"",onChange:l=>t("air","weight",l.target.value),placeholder:"1000"})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"air_dimensions",children:"Dimensions (L×W×H cm)"}),e.jsx(f,{id:"air_dimensions",value:r.dimensions||"",onChange:l=>t("air","dimensions",l.target.value),placeholder:"100×80×120"})]})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:`${a}_notes`,children:"Additional Notes"}),e.jsx(ne,{id:`${a}_notes`,value:r.notes||"",onChange:l=>t(a,"notes",l.target.value),placeholder:"Special handling, delivery requirements, etc.",rows:2})]})]})]},a)}),e.jsx(N,{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200",children:e.jsx(_,{className:"pt-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-lg font-semibold text-gray-700",children:"Total Quote Amount:"}),e.jsxs("span",{className:"text-2xl font-bold text-blue-600",children:["$",((W=s.total_cost)==null?void 0:W.toLocaleString())||"0"]})]})})}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between gap-4 pt-6",children:[e.jsxs(y,{onClick:m,variant:"outline",className:"flex items-center gap-2",children:[e.jsx(de,{className:"w-4 h-4"}),"Save Draft"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(y,{onClick:v,variant:"outline",disabled:k||!G,className:"flex items-center gap-2",children:k?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ee,{className:"w-4 h-4"}),"Generate PDF"]})}),e.jsxs(y,{onClick:()=>w(s),disabled:!se,className:"bg-blue-600 hover:bg-blue-700 text-white flex items-center gap-2",children:[e.jsx(me,{className:"w-4 h-4"}),"Send Email"]})]})]})]})}function be({quoteData:s,onSendEmail:n,onDownloadPDF:m}){var u;const v=c=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(c||0),w=c=>({ocean:"🚢",air:"✈️",truck:"🚚",ftl:"🚛"})[c]||"🚢",k=((u=s.mode_combo)==null?void 0:u.split("_"))||["ocean"];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between items-start sm:items-center bg-white/80 backdrop-blur-sm rounded-xl p-4 shadow-lg border border-gray-200/60",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:s.quote_name}),e.jsxs("p",{className:"text-gray-600",children:[s.origin," → ",s.destination]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(y,{onClick:n,disabled:!s.contact_email,className:"bg-blue-600 hover:bg-blue-700 text-white flex items-center gap-2",children:[e.jsx(K,{className:"w-4 h-4"}),"Send via Email"]}),e.jsxs(y,{onClick:m,variant:"outline",className:"flex items-center gap-2",children:[e.jsx(ee,{className:"w-4 h-4"}),"Download PDF"]})]})]}),s.contact_email&&e.jsxs(N,{className:"bg-white/80 backdrop-blur-sm shadow-lg border border-gray-200/60",children:[e.jsx(S,{children:e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(K,{className:"w-5 h-5"}),"Quote Recipient"]})}),e.jsx(_,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Email"}),e.jsx("p",{className:"text-gray-900",children:s.contact_email})]}),s.contact_name&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Contact Name"}),e.jsx("p",{className:"text-gray-900",children:s.contact_name})]}),s.company_name&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Company"}),e.jsx("p",{className:"text-gray-900",children:s.company_name})]})]})})]}),e.jsxs(N,{className:"bg-white/80 backdrop-blur-sm shadow-lg border border-gray-200/60",children:[e.jsx(S,{children:e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(O,{className:"w-5 h-5"}),"Quote Preview"]})}),e.jsx(_,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Shipment Details"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Origin:"}),e.jsx("span",{className:"font-medium",children:s.origin})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Destination:"}),e.jsx("span",{className:"font-medium",children:s.destination})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Commodity:"}),e.jsx("span",{className:"font-medium",children:s.commodity})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Incoterm:"}),e.jsx("span",{className:"font-medium",children:s.incoterm})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Quote Information"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Valid Until:"}),e.jsx("span",{className:"font-medium",children:s.valid_until?he(new Date(s.valid_until),"MMM dd, yyyy"):"Not specified"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Total Cost:"}),e.jsx("span",{className:"font-bold text-lg text-blue-600",children:v(s.total_cost)})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Service Breakdown"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:k.map(c=>{const p=s[`${c}_json`];return!p||!p.rate?null:e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-lg",children:w(c)}),e.jsxs("h5",{className:"font-medium capitalize",children:[c," Freight"]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Rate:"}),e.jsx("span",{className:"font-medium",children:v(p.rate)})]}),p.transit_time&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Transit:"}),e.jsx("span",{className:"text-sm",children:p.transit_time})]}),p.notes&&e.jsx("div",{className:"mt-2",children:e.jsx("p",{className:"text-xs text-gray-500",children:p.notes})})]})]},c)})})]}),s.notes&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Additional Notes"}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsx("p",{className:"text-gray-700",children:s.notes})})]})]})})]})]})}function Ye(){const[s,n]=C.useState("create"),[m,v]=C.useState({quote_name:"",mode_combo:"ocean",origin:"",destination:"",commodity:"",contact_email:"",contact_name:"",company_name:"",incoterm:"FOB",valid_until:"",total_cost:0,ocean_json:{rate:"",transit_time:"",notes:""},air_json:{rate:"",transit_time:"",notes:""},dray_json:{rate:"",transit_time:"",notes:""},ftl_json:{rate:"",transit_time:"",notes:""},notes:""}),[w,k]=C.useState([]),[u,c]=C.useState(!0),[p,b]=C.useState(!1),[I,L]=C.useState(null),U=I?X(I,"rfp_generation"):!1;C.useEffect(()=>{(async()=>{try{const g=await ae.me();L(g),X(g,"rfp_generation")&&M()}catch(g){console.error("Error loading user:",g)}c(!1)})()},[]);const M=async()=>{try{const t=await J.list("-updated_date");k(t)}catch(t){console.error("Error loading quotes:",t)}},B=async()=>{if(!m.quote_name||!m.origin||!m.destination){alert("Please fill in the required fields (Quote Name, Origin, Destination)");return}b(!0);try{await J.create(m),alert("Quote saved successfully!"),M(),n("preview")}catch(t){console.error("Error saving quote:",t),alert("Failed to save quote. Please try again.")}b(!1)},R=async()=>{if(!m.contact_email){alert("Please specify a contact email to send the quote");return}c(!0);try{const t=`${m.quote_name} - Freight Quote`,g=A(m),o=await xe({to:m.contact_email,subject:t,body_html:g,from_name:void 0});if(o.data.success)alert("Quote sent successfully via email!");else throw new Error(o.data.error||"Failed to send email")}catch(t){console.error("Error sending email:",t),alert("Failed to send email. Please check the console for details.")}c(!1)},$=async()=>{c(!0);try{const t=await pe({quoteData:m,user:I}),g=new Blob([t.data],{type:"application/pdf"}),o=document.createElement("a");o.href=window.URL.createObjectURL(g),o.download=`${m.quote_name||"Quote"}.pdf`,document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(o.href)}catch(t){console.error("Error generating PDF:",t),alert("Failed to generate PDF. Please try again or contact support.")}c(!1)},A=t=>{const g=o=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(o||0);return`
      <html>
        <body style="font-family: Arial, sans-serif; line-height: 1.6; color: #333;">
          <div style="max-width: 600px; margin: 0 auto; padding: 20px;">
            <h2 style="color: #1e40af; border-bottom: 2px solid #1e40af; padding-bottom: 10px;">
              ${t.quote_name}
            </h2>
            
            <p>Dear ${t.contact_name||"Valued Customer"},</p>
            
            <p>Thank you for your inquiry. Please find our freight quote details below:</p>
            
            <div style="background: #f8fafc; padding: 20px; border-radius: 8px; margin: 20px 0;">
              <h3 style="margin-top: 0; color: #1e40af;">Shipment Details</h3>
              <table style="width: 100%; border-collapse: collapse;">
                <tr>
                  <td style="padding: 8px 0; border-bottom: 1px solid #e2e8f0;"><strong>Origin:</strong></td>
                  <td style="padding: 8px 0; border-bottom: 1px solid #e2e8f0;">${t.origin}</td>
                </tr>
                <tr>
                  <td style="padding: 8px 0; border-bottom: 1px solid #e2e8f0;"><strong>Destination:</strong></td>
                  <td style="padding: 8px 0; border-bottom: 1px solid #e2e8f0;">${t.destination}</td>
                </tr>
                <tr>
                  <td style="padding: 8px 0; border-bottom: 1px solid #e2e8f0;"><strong>Commodity:</strong></td>
                  <td style="padding: 8px 0; border-bottom: 1px solid #e2e8f0;">${t.commodity}</td>
                </tr>
                <tr>
                  <td style="padding: 8px 0; border-bottom: 1px solid #e2e8f0;"><strong>Incoterm:</strong></td>
                  <td style="padding: 8px 0; border-bottom: 1px solid #e2e8f0;">${t.incoterm}</td>
                </tr>
                <tr>
                  <td style="padding: 8px 0;"><strong>Total Cost:</strong></td>
                  <td style="padding: 8px 0; font-size: 18px; font-weight: bold; color: #1e40af;">${g(t.total_cost)}</td>
                </tr>
              </table>
            </div>
            
            ${t.notes?`
            <div style="background: #fef3c7; padding: 15px; border-radius: 8px; margin: 20px 0;">
              <h4 style="margin-top: 0; color: #92400e;">Additional Notes:</h4>
              <p style="margin-bottom: 0;">${t.notes}</p>
            </div>
            `:""}
            
            <p>This quote is valid until ${t.valid_until?new Date(t.valid_until).toLocaleDateString():"further notice"}.</p>
            
            <p>If you have any questions or would like to proceed with this shipment, please don't hesitate to contact us.</p>
            
            <p>Best regards,<br>
            The LIT Team</p>
            
            <hr style="border: none; border-top: 1px solid #e2e8f0; margin: 30px 0;">
            <p style="font-size: 12px; color: #6b7280;">
              This quote was generated using Logistic Intel. 
              <a href="https://logisticintel.com" style="color: #1e40af;">Learn more</a>
            </p>
          </div>
        </body>
      </html>
    `};return u?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):U?e.jsx("div",{className:"p-4 md:p-6 lg:p-8 bg-gradient-to-br from-gray-50 to-blue-50/30 min-h-screen",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center mb-6 lg:mb-8 gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl lg:text-4xl font-bold text-gray-900",children:"RFP Studio"}),e.jsx("p",{className:"text-gray-600 mt-2 text-sm md:text-base",children:"Create professional freight quotes and proposals"})]}),e.jsx("div",{className:"flex gap-2",children:s==="create"&&e.jsx(y,{onClick:B,disabled:p,className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white",children:p?"Saving...":"Save Quote"})})]}),e.jsxs(te,{value:s,onValueChange:n,className:"w-full",children:[e.jsxs(re,{className:"grid w-full grid-cols-3 bg-white/80 backdrop-blur-sm shadow-lg border border-gray-200/60",children:[e.jsxs(V,{value:"create",className:"flex items-center gap-2",children:[e.jsx(Z,{className:"w-4 h-4"}),"Create"]}),e.jsxs(V,{value:"preview",className:"flex items-center gap-2",children:[e.jsx(q,{className:"w-4 h-4"}),"Preview"]}),e.jsxs(V,{value:"saved",className:"flex items-center gap-2",children:[e.jsx(O,{className:"w-4 h-4"}),"Saved (",w.length,")"]})]}),e.jsx(Q,{value:"create",className:"space-y-6 mt-6",children:e.jsx(ve,{quote:m,onQuoteChange:v,onSave:B,onGeneratePDF:$,onSendEmail:R,isGeneratingPDF:u})}),e.jsx(Q,{value:"preview",className:"space-y-6 mt-6",children:e.jsx(be,{quoteData:m,onSendEmail:R,onDownloadPDF:$})}),e.jsx(Q,{value:"saved",className:"space-y-6 mt-6",children:w.length===0?e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"inline-block p-6 bg-white/80 rounded-full shadow-lg mb-6",children:e.jsx(O,{className:"w-16 h-16 text-blue-500"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"No Saved Quotes"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Create your first quote to get started with professional proposals."}),e.jsxs(y,{onClick:()=>n("create"),className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white",children:[e.jsx(Z,{className:"w-4 h-4 mr-2"}),"Create Quote"]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:w.map(t=>e.jsxs(N,{className:"bg-white/80 backdrop-blur-sm shadow-lg border border-gray-200/60 hover:shadow-xl transition-shadow",children:[e.jsx(S,{children:e.jsx(F,{className:"text-lg font-semibold truncate",children:t.quote_name})}),e.jsxs(_,{children:[e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Route:"})," ",t.origin," → ",t.destination]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Total:"})," ",new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t.total_cost||0)]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Status:"})," ",t.status||"Draft"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(y,{size:"sm",variant:"outline",onClick:()=>{v(t),n("preview")},className:"flex-1",children:[e.jsx(q,{className:"w-3 h-3 mr-1"}),"View"]}),e.jsxs(y,{size:"sm",variant:"outline",onClick:()=>{v(t),n("create")},className:"flex-1",children:[e.jsx(fe,{className:"w-3 h-3 mr-1"}),"Edit"]})]})]})]},t.id))})})]})]})}):e.jsx(le,{featureName:"RFP Studio"})}export{Ye as default};
