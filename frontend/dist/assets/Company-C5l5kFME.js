import{V as B,r as o,j as e,B as p}from"./main-BwGWMDCi.js";import{T as O,a as G,b as i,c}from"./tabs-CUfPoQKT.js";import{O as P,e as U,f as V,g as z,N as D}from"./NotesTab-B_nF1Pwf.js";import{Contact as g,Note as N}from"./entities-CnsKiLH-.js";import{getCompanyOverview as $,getCompanyShipments as q,enrichCompany as F}from"./functions-DLmuSLgl.js";import"./index-v5Hq-Jwm.js";import"./index-B1OJoX7J.js";import"./badge-u5ZeETXz.js";import"./format-DIePDvv_.js";import"./truck-BzQ1-Eds.js";import"./ship-CzOlKfq2.js";import"./select-BVIETwTL.js";import"./input-Dw7a9WQL.js";import"./label-B_k9YyLN.js";import"./loader-circle-C-mQTauK.js";import"./plus-ZQB9w3xX.js";import"./textarea-BtZvDFSN.js";import"./users-rmwcVKVM.js";import"./message-square-DIcLcI0k.js";import"./trash-2-BRf9Ug2A.js";import"./base44Client-C-YMJfZQ.js";function me(){const{id:C}=B(),t=C,[l,h]=o.useState(null),[x,w]=o.useState([]),[S,T]=o.useState([]),[_,E]=o.useState([]),[d,u]=o.useState(!0),[m,y]=o.useState(!1),r=o.useCallback(async()=>{var n,j;if(t){u(!0);try{const[a,s,I,L]=await Promise.all([$({company_id:t}),q({company_id:t,limit:50}),g.filter({company_id:t},"-created_date",50),N.filter({company_id:t},"-created_date",50)]),v=((n=a==null?void 0:a.data)==null?void 0:n.result)??(a==null?void 0:a.result)??(a==null?void 0:a.data)??a??null;v&&h(v);const b=((j=s==null?void 0:s.data)==null?void 0:j.results)??(s==null?void 0:s.results)??(s==null?void 0:s.rows)??[];w(Array.isArray(b)?b:[]),T(I||[]),E(L||[])}catch(a){console.error("Company load error",a)}finally{u(!1)}}},[t]);o.useEffect(()=>{r()},[r]);const k=async n=>{await g.create({...n,company_id:t}),r()},A=async n=>{await N.create({content:n,company_id:t}),r()},f=async()=>{y(!0);try{await F({company_id:t}),await r()}catch(n){console.error("Enrich error",n)}finally{y(!1)}};return!l&&!d?e.jsxs("div",{className:"text-center py-16",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Company not found"}),e.jsx("p",{className:"text-gray-600",children:"This company may not be saved yet. Go back to Search to discover and save companies."}),e.jsx("div",{className:"mt-4",children:e.jsx(p,{variant:"outline",onClick:()=>window.location.href="/app/search",children:"Back to Search"})})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Company"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["ID: ",t]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white hover:from-blue-700 hover:to-purple-700",onClick:()=>{window.location.href=`/app/pre-call?company_id=${t}`},children:"Pre-Call Briefing"}),e.jsx(p,{size:"sm",onClick:f,disabled:m,className:"bg-purple-600 hover:bg-purple-700 text-white",children:m?"Enrichingâ€¦":"Enrich Now"})]})]}),e.jsx("div",{className:"bg-white rounded-xl border shadow-sm",children:e.jsxs(O,{defaultValue:"overview",className:"w-full",children:[e.jsx("div",{className:"px-4 pt-4 border-b",children:e.jsxs(G,{children:[e.jsx(i,{value:"overview",children:"Overview"}),e.jsx(i,{value:"shipments",children:"Shipments"}),e.jsx(i,{value:"contacts",children:"Contacts"}),e.jsx(i,{value:"ai_insights",children:"AI Insights"}),e.jsx(i,{value:"notes",children:"Notes"})]})}),e.jsxs("div",{className:"p-4",children:[e.jsx(c,{value:"overview",children:e.jsx(P,{company:l,shipments:x,isLoading:d})}),e.jsx(c,{value:"shipments",children:e.jsx(U,{shipments:x,isLoading:d})}),e.jsx(c,{value:"contacts",children:e.jsx(V,{contacts:S,companyId:t,company:l,onAddContact:k,isGated:!1,onUnlock:()=>{},isLoading:!1})}),e.jsx(c,{value:"ai_insights",children:e.jsx(z,{company:l||{id:t},onCompanyUpdate:h,user:null,isGated:!1,onUnlock:()=>{},isLoading:!1,onEnrich:f,isEnriching:m})}),e.jsx(c,{value:"notes",children:e.jsx(D,{notes:_,onAddNote:A,isLoading:d})})]})]})})]})}export{me as default};
