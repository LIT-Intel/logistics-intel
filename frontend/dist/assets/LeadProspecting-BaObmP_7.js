import{u as M,r as n,R as V,j as e,C as m,d as $,e as q,b as u,B as y,S as b,a as K}from"./main-DAG5jyQK.js";import{I as g}from"./input-CzLbtKOn.js";import{S as N,b as S,d as C,e as _,f as w}from"./select-Dq2EtcCP.js";import{B as h}from"./badge-BM1WYQvO.js";import{C as k}from"./checkbox-C_XjzIsK.js";import{User as H,Company as J,Contact as W}from"./entities-CpFcElq0.js";import{c as I}from"./index-DR9D_4bA.js";import{searchLeads as Y}from"./functions-D-IsXCuO.js";import{T as G}from"./target-Afmzd7y_.js";import{D as Q}from"./download-CoyY7Nqs.js";import"./index-CUxI3nj3.js";import"./index-B_njSL4M.js";import"./base44Client-C-YMJfZQ.js";function me(){const x=M(),[L,T]=n.useState(null),[t,i]=n.useState({industry:"",employee_count_min:"",employee_count_max:"",revenue_min:"",revenue_max:"",location:"",keywords:"",job_titles:"CEO,President,VP Sales,Sales Manager,Logistics Manager,Operations Manager",company_size:"",technology_used:""}),[c,P]=n.useState([]),[r,o]=n.useState([]),[p,j]=n.useState(!1),[f,v]=n.useState(!1),[D,F]=n.useState(!1);V.useEffect(()=>{(async()=>{try{const a=await H.me();if(a.role!=="admin"){x(I("Dashboard"));return}T(a)}catch{x(I("Dashboard"))}})()},[x]);const R=["Freight Forwarding","Logistics","3PL","Shipping","Transportation","Supply Chain","Warehousing","Manufacturing","Import/Export","Trucking","Ocean Freight","Air Freight","Rail Transport"],U=[{label:"1-10 employees",value:"1,10"},{label:"11-50 employees",value:"11,50"},{label:"51-200 employees",value:"51,200"},{label:"201-1000 employees",value:"201,1000"},{label:"1000+ employees",value:"1000,10000"}],A=async()=>{j(!0);try{const s=await Y(t);s.status===200?(P(s.data.results||[]),F(!0)):alert("Search failed. Please try again.")}catch(s){console.error("Search error:",s),alert("Search failed. Please check your criteria and try again.")}j(!1)},E=s=>{o(s?c.map(a=>a.id):[])},B=(s,a)=>{o(a?[...r,s]:r.filter(d=>d!==s))},O=async()=>{if(r.length===0){alert("Please select companies to import.");return}v(!0);try{const s=c.filter(a=>r.includes(a.id));for(const a of s){const d={name:a.name,domain:a.domain,hq_city:a.city,hq_country:a.country,industry:a.industry,employee_count:a.employee_count,annual_revenue:a.annual_revenue,enrichment_status:"enriched",enrichment_data:{source:"apollo_prospecting",imported_date:new Date().toISOString(),...a}},z=await J.create(d);if(a.contacts&&a.contacts.length>0)for(const l of a.contacts)await W.create({company_id:z.id,full_name:l.name,title:l.title,dept:l.department,email:l.email,phone:l.phone,linkedin:l.linkedin_url,source:"apollo",verified:l.email_verified||!1})}alert(`Successfully imported ${r.length} companies and their contacts.`),o([])}catch(s){console.error("Import error:",s),alert("Import failed. Some companies may have been imported successfully.")}v(!1)};return L?e.jsx("div",{className:"p-6 md:p-8 bg-gradient-to-br from-purple-50 to-pink-50/30 min-h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900",children:"Lead Prospecting"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Search and import potential LIT subscribers from Apollo.io"})]}),e.jsx(h,{className:"bg-red-100 text-red-800",children:"Admin Only"})]}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs(m,{className:"sticky top-4",children:[e.jsx($,{children:e.jsxs(q,{className:"flex items-center gap-2",children:[e.jsx(G,{className:"w-5 h-5"}),"Search Criteria"]})}),e.jsxs(u,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Industry"}),e.jsxs(N,{value:t.industry,onValueChange:s=>i({...t,industry:s}),children:[e.jsx(S,{children:e.jsx(C,{placeholder:"Select industry"})}),e.jsx(_,{children:R.map(s=>e.jsx(w,{value:s,children:s},s))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Company Size"}),e.jsxs(N,{value:t.company_size,onValueChange:s=>i({...t,company_size:s}),children:[e.jsx(S,{children:e.jsx(C,{placeholder:"Select company size"})}),e.jsx(_,{children:U.map(s=>e.jsx(w,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Location"}),e.jsx(g,{placeholder:"e.g., United States, New York",value:t.location,onChange:s=>i({...t,location:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Keywords"}),e.jsx(g,{placeholder:"e.g., freight, logistics, shipping",value:t.keywords,onChange:s=>i({...t,keywords:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Target Job Titles"}),e.jsx(g,{placeholder:"Comma-separated titles",value:t.job_titles,onChange:s=>i({...t,job_titles:s.target.value})}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Default includes decision makers"})]}),e.jsx(y,{onClick:A,disabled:p,className:"w-full",children:p?e.jsx(e.Fragment,{children:"Searching..."}):e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"w-4 h-4 mr-2"}),"Search Leads"]})})]})]})}),e.jsx("div",{className:"lg:col-span-2",children:D?c.length===0?e.jsx(m,{className:"h-64 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(b,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Results Found"}),e.jsx("p",{className:"text-gray-500",children:"Try adjusting your search criteria"})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(m,{children:e.jsx(u,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(k,{checked:r.length===c.length,onCheckedChange:E}),e.jsxs("span",{className:"font-medium",children:[c.length," companies found"]}),r.length>0&&e.jsxs(h,{variant:"secondary",children:[r.length," selected"]})]}),e.jsx(y,{onClick:O,disabled:r.length===0||f,className:"bg-green-600 hover:bg-green-700",children:f?e.jsx(e.Fragment,{children:"Importing..."}):e.jsxs(e.Fragment,{children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),"Import Selected"]})})]})})}),e.jsx("div",{className:"space-y-3",children:c.map(s=>e.jsx(m,{className:"hover:shadow-md transition-shadow",children:e.jsx(u,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(k,{checked:r.includes(s.id),onCheckedChange:a=>B(s.id,a)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"font-semibold text-lg",children:s.name}),e.jsx("div",{className:"flex items-center gap-2",children:s.domain&&e.jsx(h,{variant:"outline",children:s.domain})})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 text-sm text-gray-600",children:[e.jsxs("div",{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Industry:"})," ",s.industry||"Unknown"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Location:"})," ",s.city,", ",s.country]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Employees:"})," ",s.employee_count||"Unknown"]})]}),e.jsxs("div",{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Revenue:"})," ",s.annual_revenue?`$${s.annual_revenue.toLocaleString()}`:"Unknown"]}),s.contacts&&e.jsxs("p",{children:[e.jsx("strong",{children:"Contacts:"})," ",s.contacts.length," found"]})]})]}),s.contacts&&s.contacts.length>0&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Key Contacts:"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.contacts.slice(0,3).map((a,d)=>e.jsxs(h,{variant:"secondary",className:"text-xs",children:[a.name," â€¢ ",a.title]},d)),s.contacts.length>3&&e.jsxs(h,{variant:"secondary",className:"text-xs",children:["+",s.contacts.length-3," more"]})]})]})]})]})})},s.id))})]}):e.jsx(m,{className:"h-64 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(K,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Search for Leads"}),e.jsx("p",{className:"text-gray-500",children:"Configure your search criteria and find potential LIT subscribers"})]})})})]})]})}):e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})}export{me as default};
