var be=t=>{throw TypeError(t)};var Y=(t,e,s)=>e.has(t)||be("Cannot "+s);var i=(t,e,s)=>(Y(t,e,"read from private field"),s?s.call(t):e.get(t)),x=(t,e,s)=>e.has(t)?be("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,s),d=(t,e,s,a)=>(Y(t,e,"write to private field"),a?a.call(t,s):e.set(t,s),s),m=(t,e,s)=>(Y(t,e,"access private method"),s);import{i as Oe,p as ve,k as j,s as ie,l as z,n as re,m as ae,o as ye,t as Me,q as $,v as Qe,w as De,x as Re,y as Ne,r as E,z as Ue,A as Fe,j as r,C as Z,b as ee}from"./main-Co9m5o5q.js";import{b as Se}from"./api-NOv4a-LP.js";import{T as ke,a as Le,b as te,c as se}from"./tabs-DjWj_m8N.js";var y,n,H,b,Q,k,_,T,V,L,P,D,U,O,A,c,B,ne,he,oe,ce,le,ue,de,Ie,Ee,Pe=(Ee=class extends Oe{constructor(e,s){super();x(this,c);x(this,y);x(this,n);x(this,H);x(this,b);x(this,Q);x(this,k);x(this,_);x(this,T);x(this,V);x(this,L);x(this,P);x(this,D);x(this,U);x(this,O);x(this,A,new Set);this.options=s,d(this,y,e),d(this,T,null),d(this,_,ve()),this.bindMethods(),this.setOptions(s)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(i(this,n).addObserver(this),je(i(this,n),this.options)?m(this,c,B).call(this):this.updateResult(),m(this,c,ce).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return fe(i(this,n),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return fe(i(this,n),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,m(this,c,le).call(this),m(this,c,ue).call(this),i(this,n).removeObserver(this)}setOptions(e){const s=this.options,a=i(this,n);if(this.options=i(this,y).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof j(this.options.enabled,i(this,n))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");m(this,c,de).call(this),i(this,n).setOptions(this.options),s._defaulted&&!ie(this.options,s)&&i(this,y).getQueryCache().notify({type:"observerOptionsUpdated",query:i(this,n),observer:this});const h=this.hasListeners();h&&Ce(i(this,n),a,this.options,s)&&m(this,c,B).call(this),this.updateResult(),h&&(i(this,n)!==a||j(this.options.enabled,i(this,n))!==j(s.enabled,i(this,n))||z(this.options.staleTime,i(this,n))!==z(s.staleTime,i(this,n)))&&m(this,c,ne).call(this);const o=m(this,c,he).call(this);h&&(i(this,n)!==a||j(this.options.enabled,i(this,n))!==j(s.enabled,i(this,n))||o!==i(this,O))&&m(this,c,oe).call(this,o)}getOptimisticResult(e){const s=i(this,y).getQueryCache().build(i(this,y),e),a=this.createResult(s,e);return Be(this,a)&&(d(this,b,a),d(this,k,this.options),d(this,Q,i(this,n).state)),a}getCurrentResult(){return i(this,b)}trackResult(e,s){return new Proxy(e,{get:(a,h)=>(this.trackProp(h),s==null||s(h),h==="promise"&&!this.options.experimental_prefetchInRender&&i(this,_).status==="pending"&&i(this,_).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),Reflect.get(a,h))})}trackProp(e){i(this,A).add(e)}getCurrentQuery(){return i(this,n)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const s=i(this,y).defaultQueryOptions(e),a=i(this,y).getQueryCache().build(i(this,y),s);return a.fetch().then(()=>this.createResult(a,s))}fetch(e){return m(this,c,B).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),i(this,b)))}createResult(e,s){var xe;const a=i(this,n),h=this.options,o=i(this,b),l=i(this,Q),C=i(this,k),v=e!==a?e.state:i(this,H),{state:N}=e;let u={...N},I=!1,p;if(s._optimisticResults){const S=this.hasListeners(),q=!S&&je(e,s),F=S&&Ce(e,a,s,h);(q||F)&&(u={...u,...De(N.data,e.options)}),s._optimisticResults==="isRestoring"&&(u.fetchStatus="idle")}let{error:g,errorUpdatedAt:M,status:R}=u;p=u.data;let W=!1;if(s.placeholderData!==void 0&&p===void 0&&R==="pending"){let S;o!=null&&o.isPlaceholderData&&s.placeholderData===(C==null?void 0:C.placeholderData)?(S=o.data,W=!0):S=typeof s.placeholderData=="function"?s.placeholderData((xe=i(this,P))==null?void 0:xe.state.data,i(this,P)):s.placeholderData,S!==void 0&&(R="success",p=Re(o==null?void 0:o.data,S,s),I=!0)}if(s.select&&p!==void 0&&!W)if(o&&p===(l==null?void 0:l.data)&&s.select===i(this,V))p=i(this,L);else try{d(this,V,s.select),p=s.select(p),p=Re(o==null?void 0:o.data,p,s),d(this,L,p),d(this,T,null)}catch(S){d(this,T,S)}i(this,T)&&(g=i(this,T),p=i(this,L),M=Date.now(),R="error");const G=u.fetchStatus==="fetching",J=R==="pending",X=R==="error",me=J&&G,ge=p!==void 0,w={status:R,fetchStatus:u.fetchStatus,isPending:J,isSuccess:R==="success",isError:X,isInitialLoading:me,isLoading:me,data:p,dataUpdatedAt:u.dataUpdatedAt,error:g,errorUpdatedAt:M,failureCount:u.fetchFailureCount,failureReason:u.fetchFailureReason,errorUpdateCount:u.errorUpdateCount,isFetched:u.dataUpdateCount>0||u.errorUpdateCount>0,isFetchedAfterMount:u.dataUpdateCount>v.dataUpdateCount||u.errorUpdateCount>v.errorUpdateCount,isFetching:G,isRefetching:G&&!J,isLoadingError:X&&!ge,isPaused:u.fetchStatus==="paused",isPlaceholderData:I,isRefetchError:X&&ge,isStale:pe(e,s),refetch:this.refetch,promise:i(this,_),isEnabled:j(s.enabled,e)!==!1};if(this.options.experimental_prefetchInRender){const S=K=>{w.status==="error"?K.reject(w.error):w.data!==void 0&&K.resolve(w.data)},q=()=>{const K=d(this,_,w.promise=ve());S(K)},F=i(this,_);switch(F.status){case"pending":e.queryHash===a.queryHash&&S(F);break;case"fulfilled":(w.status==="error"||w.data!==F.value)&&q();break;case"rejected":(w.status!=="error"||w.error!==F.reason)&&q();break}}return w}updateResult(){const e=i(this,b),s=this.createResult(i(this,n),this.options);if(d(this,Q,i(this,n).state),d(this,k,this.options),i(this,Q).data!==void 0&&d(this,P,i(this,n)),ie(s,e))return;d(this,b,s);const a=()=>{if(!e)return!0;const{notifyOnChangeProps:h}=this.options,o=typeof h=="function"?h():h;if(o==="all"||!o&&!i(this,A).size)return!0;const l=new Set(o??i(this,A));return this.options.throwOnError&&l.add("error"),Object.keys(i(this,b)).some(C=>{const f=C;return i(this,b)[f]!==e[f]&&l.has(f)})};m(this,c,Ie).call(this,{listeners:a()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&m(this,c,ce).call(this)}},y=new WeakMap,n=new WeakMap,H=new WeakMap,b=new WeakMap,Q=new WeakMap,k=new WeakMap,_=new WeakMap,T=new WeakMap,V=new WeakMap,L=new WeakMap,P=new WeakMap,D=new WeakMap,U=new WeakMap,O=new WeakMap,A=new WeakMap,c=new WeakSet,B=function(e){m(this,c,de).call(this);let s=i(this,n).fetch(this.options,e);return e!=null&&e.throwOnError||(s=s.catch(re)),s},ne=function(){m(this,c,le).call(this);const e=z(this.options.staleTime,i(this,n));if(ae||i(this,b).isStale||!ye(e))return;const a=Me(i(this,b).dataUpdatedAt,e)+1;d(this,D,$.setTimeout(()=>{i(this,b).isStale||this.updateResult()},a))},he=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(i(this,n)):this.options.refetchInterval)??!1},oe=function(e){m(this,c,ue).call(this),d(this,O,e),!(ae||j(this.options.enabled,i(this,n))===!1||!ye(i(this,O))||i(this,O)===0)&&d(this,U,$.setInterval(()=>{(this.options.refetchIntervalInBackground||Qe.isFocused())&&m(this,c,B).call(this)},i(this,O)))},ce=function(){m(this,c,ne).call(this),m(this,c,oe).call(this,m(this,c,he).call(this))},le=function(){i(this,D)&&($.clearTimeout(i(this,D)),d(this,D,void 0))},ue=function(){i(this,U)&&($.clearInterval(i(this,U)),d(this,U,void 0))},de=function(){const e=i(this,y).getQueryCache().build(i(this,y),this.options);if(e===i(this,n))return;const s=i(this,n);d(this,n,e),d(this,H,e.state),this.hasListeners()&&(s==null||s.removeObserver(this),e.addObserver(this))},Ie=function(e){Ne.batch(()=>{e.listeners&&this.listeners.forEach(s=>{s(i(this,b))}),i(this,y).getQueryCache().notify({query:i(this,n),type:"observerResultsUpdated"})})},Ee);function Ae(t,e){return j(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function je(t,e){return Ae(t,e)||t.state.data!==void 0&&fe(t,e,e.refetchOnMount)}function fe(t,e,s){if(j(e.enabled,t)!==!1&&z(e.staleTime,t)!=="static"){const a=typeof s=="function"?s(t):s;return a==="always"||a!==!1&&pe(t,e)}return!1}function Ce(t,e,s,a){return(t!==e||j(a.enabled,t)===!1)&&(!s.suspense||t.state.status!=="error")&&pe(t,s)}function pe(t,e){return j(e.enabled,t)!==!1&&t.isStaleByTime(z(e.staleTime,t))}function Be(t,e){return!ie(t.getCurrentResult(),e)}var Te=E.createContext(!1),ze=()=>E.useContext(Te);Te.Provider;function He(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var Ve=E.createContext(He()),We=()=>E.useContext(Ve),qe=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},Ke=t=>{E.useEffect(()=>{t.clearReset()},[t])},$e=({result:t,errorResetBoundary:e,throwOnError:s,query:a,suspense:h})=>t.isError&&!e.isReset()&&!t.isFetching&&a&&(h&&t.data===void 0||Ue(s,[t.error,a])),Ge=t=>{if(t.suspense){const s=h=>h==="static"?h:Math.max(h??1e3,1e3),a=t.staleTime;t.staleTime=typeof a=="function"?(...h)=>s(a(...h)):s(a),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},Je=(t,e)=>t.isLoading&&t.isFetching&&!e,Xe=(t,e)=>(t==null?void 0:t.suspense)&&e.isPending,we=(t,e,s)=>e.fetchOptimistic(t).catch(()=>{s.clearReset()});function Ye(t,e,s){var u,I,p,g,M;const a=ze(),h=We(),o=Fe(),l=o.defaultQueryOptions(t);(I=(u=o.getDefaultOptions().queries)==null?void 0:u._experimental_beforeQuery)==null||I.call(u,l),l._optimisticResults=a?"isRestoring":"optimistic",Ge(l),qe(l,h),Ke(h);const C=!o.getQueryCache().get(l.queryHash),[f]=E.useState(()=>new e(o,l)),v=f.getOptimisticResult(l),N=!a&&t.subscribed!==!1;if(E.useSyncExternalStore(E.useCallback(R=>{const W=N?f.subscribe(Ne.batchCalls(R)):re;return f.updateResult(),W},[f,N]),()=>f.getCurrentResult(),()=>f.getCurrentResult()),E.useEffect(()=>{f.setOptions(l)},[l,f]),Xe(l,v))throw we(l,f,h);if($e({result:v,errorResetBoundary:h,throwOnError:l.throwOnError,query:o.getQueryCache().get(l.queryHash),suspense:l.suspense}))throw v.error;if((g=(p=o.getDefaultOptions().queries)==null?void 0:p._experimental_afterQuery)==null||g.call(p,l,v),l.experimental_prefetchInRender&&!ae&&Je(v,a)){const R=C?we(l,f,h):(M=o.getQueryCache().get(l.queryHash))==null?void 0:M.promise;R==null||R.catch(re).finally(()=>{f.updateResult()})}return l.notifyOnChangeProps?v:f.trackResult(v)}function _e(t,e){return Ye(t,Pe)}function rt({id:t,open:e,onOpenChange:s}){var l,C,f,v,N,u,I,p;const a=_e({queryKey:["companyDetails",t],queryFn:()=>Se.get(`/public/getCompanyDetails?company_id=${t}`),enabled:e&&!!t}),h=_e({queryKey:["companyShipments",t],queryFn:()=>Se.get(`/public/getCompanyShipments?company_id=${t}&limit=25&offset=0`),enabled:e&&!!t}),o=((l=a.data)==null?void 0:l.kpis)||{shipments_12m:0,last_activity:"—",top_route:void 0,top_carrier:void 0};return r.jsxs("div",{className:`fixed inset-0 z-50 ${e?"":"hidden"}`,children:[r.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>s(!1)}),r.jsxs("div",{className:"absolute right-0 top-0 h-full w-full md:w-[720px] bg-white rounded-l-2xl shadow-xl overflow-auto",children:[r.jsxs("div",{className:"p-4 border-b",children:[r.jsx("div",{className:"text-lg font-semibold truncate",children:((C=a.data)==null?void 0:C.name)||t}),r.jsxs("div",{className:"text-xs text-gray-500",children:["Last activity ",o.last_activity||"—"]})]}),r.jsx("div",{className:"p-4",children:r.jsxs(ke,{defaultValue:"overview",children:[r.jsxs(Le,{children:[r.jsx(te,{value:"overview",children:"Overview"}),r.jsx(te,{value:"shipments",children:"Shipments"}),r.jsx(te,{value:"ai",children:"AI Insights"})]}),r.jsx(se,{value:"overview",children:r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[r.jsx(Z,{children:r.jsxs(ee,{className:"p-4",children:[r.jsx("div",{className:"text-xs text-gray-500",children:"Shipments (12m)"}),r.jsx("div",{className:"text-xl font-bold",children:((v=(f=o.shipments_12m)==null?void 0:f.toLocaleString)==null?void 0:v.call(f))||0})]})}),r.jsx(Z,{children:r.jsxs(ee,{className:"p-4",children:[r.jsx("div",{className:"text-xs text-gray-500",children:"Top Route"}),r.jsx("div",{className:"text-sm font-medium",children:o.top_route||"—"})]})}),r.jsx(Z,{children:r.jsxs(ee,{className:"p-4",children:[r.jsx("div",{className:"text-xs text-gray-500",children:"Top Carrier"}),r.jsx("div",{className:"text-sm font-medium",children:o.top_carrier||"—"})]})})]})}),r.jsx(se,{value:"shipments",children:r.jsx("div",{className:"overflow-auto rounded border",children:r.jsxs("table",{className:"w-full text-sm",children:[r.jsx("thead",{className:"sticky top-0 bg-white",children:r.jsxs("tr",{className:"[&>th]:py-2 [&>th]:text-left",children:[r.jsx("th",{children:"Date"}),r.jsx("th",{children:"Mode"}),r.jsx("th",{children:"Origin"}),r.jsx("th",{children:"Destination"}),r.jsx("th",{children:"Carrier"}),r.jsx("th",{children:"Value (USD)"}),r.jsx("th",{children:"Weight (kg)"})]})}),r.jsxs("tbody",{children:[(u=(N=h.data)==null?void 0:N.rows)==null?void 0:u.map((g,M)=>r.jsxs("tr",{className:"border-t",children:[r.jsx("td",{children:g.shipped_on}),r.jsx("td",{className:"capitalize",children:String(g.mode||"").toLowerCase()}),r.jsx("td",{children:g.origin}),r.jsx("td",{children:g.destination}),r.jsx("td",{children:g.carrier||"—"}),r.jsx("td",{children:typeof g.value_usd=="number"||typeof g.value_usd=="string"&&g.value_usd?Number(g.value_usd).toLocaleString():"—"}),r.jsx("td",{children:typeof g.weight_kg=="number"||typeof g.weight_kg=="string"&&g.weight_kg?Number(g.weight_kg).toLocaleString():"—"})]},M)),!((p=(I=h.data)==null?void 0:I.rows)!=null&&p.length)&&r.jsx("tr",{children:r.jsx("td",{colSpan:7,className:"py-8 text-center text-gray-500",children:"No shipments for this range."})})]})]})})}),r.jsx(se,{value:"ai",children:r.jsx("div",{className:"text-sm text-gray-600",children:"Generate briefing coming soon."})})]})})]})]})}export{rt as C,_e as u};
