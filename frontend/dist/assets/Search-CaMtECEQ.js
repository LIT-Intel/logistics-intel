var bt=t=>{throw TypeError(t)};var De=(t,s,r)=>s.has(t)||bt("Cannot "+r);var d=(t,s,r)=>(De(t,s,"read from private field"),r?r.call(t):s.get(t)),L=(t,s,r)=>s.has(t)?bt("Cannot add the same private member more than once"):s instanceof WeakSet?s.add(t):s.set(t,r),M=(t,s,r,n)=>(De(t,s,"write to private field"),n?n.call(t,r):s.set(t,r),r),I=(t,s,r)=>(De(t,s,"access private method"),r);import{f as _s,p as yt,g as q,s as Le,h as ye,n as ze,i as Ue,k as vt,t as Ns,l as Re,m as Cs,o as Rs,q as jt,v as Dt,r as c,w as Es,x as ks,c as Pt,j as e,C as Pe,b as Ie,y as fe,z as Ts,a as St,T as It,B as Y,u as Ms,A as As,S as wt}from"./main-D9DXAbCC.js";import{a as _t,g as Ds,k as Ft,p as Nt,s as Ps}from"./api-CSGOmWCZ.js";import{T as Is,a as Fs,b as Fe,c as Oe}from"./tabs-V8uPiLi3.js";import{I as Os}from"./input-BsJUwWpA.js";import{c as Ct}from"./index-DR9D_4bA.js";import{S as Rt}from"./skeleton-CLrvrvri.js";import"./checkbox-D0OsHySK.js";import{c as Ot,u as Ls,a as zs}from"./select-CqIuqxEs.js";import{u as Us,c as Bs,a as $s,b as de,P as Se,d as Vs}from"./index-DgsJrVff.js";import{C as Lt}from"./circle-alert-DEmju-5t.js";import{B as zt,C as Qs}from"./CompanyDetailModal-B5EvL-eZ.js";import{B as Ut}from"./badge-Cd16Jk0o.js";import{M as Ks,i as Hs,u as Bt,P as qs,a as Ws,b as Gs,L as Ys,m as Ze}from"./proxy-Beh7DhnC.js";import{C as $t}from"./calendar-Db9N5JPE.js";import{S as Vt}from"./ship-v_wNJm4u.js";import{L as Qt}from"./loader-circle-BxITRAlg.js";import{B as Kt,C as Xs}from"./NotesTab-BwYsuFc3.js";import{f as Ht}from"./format-DIePDvv_.js";import{L as Zs}from"./list-CuBgOiNB.js";import{U as Js}from"./UpgradePrompt-DCWe-O-w.js";import"./index-D1arpfRs.js";import"./dialog-C7Iz2UWn.js";import"./entities-CpFcElq0.js";import"./base44Client-C-YMJfZQ.js";import"./lock-CVhN_yV9.js";import"./truck-CT6_qBbd.js";import"./label-UsKfc5n3.js";import"./functions-DEVKMBrm.js";import"./plus-C23sFSLt.js";import"./users-C_C_FvVa.js";import"./message-square-DH3IP1uj.js";import"./trash-2-Bx19LHVm.js";import"./textarea-BB5ygcid.js";import"./crown-DSQ7S-Sz.js";import"./zap-DJVadSUB.js";import"./arrow-right-dAAhsVOu.js";var V,j,ve,U,oe,ue,ee,ie,je,he,me,le,ce,ae,pe,_,be,Be,$e,Ve,Qe,Ke,He,qe,qt,At,er=(At=class extends _s{constructor(s,r){super();L(this,_);L(this,V);L(this,j);L(this,ve);L(this,U);L(this,oe);L(this,ue);L(this,ee);L(this,ie);L(this,je);L(this,he);L(this,me);L(this,le);L(this,ce);L(this,ae);L(this,pe,new Set);this.options=r,M(this,V,s),M(this,ie,null),M(this,ee,yt()),this.bindMethods(),this.setOptions(r)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(d(this,j).addObserver(this),Et(d(this,j),this.options)?I(this,_,be).call(this):this.updateResult(),I(this,_,Qe).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return We(d(this,j),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return We(d(this,j),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,I(this,_,Ke).call(this),I(this,_,He).call(this),d(this,j).removeObserver(this)}setOptions(s){const r=this.options,n=d(this,j);if(this.options=d(this,V).defaultQueryOptions(s),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof q(this.options.enabled,d(this,j))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");I(this,_,qe).call(this),d(this,j).setOptions(this.options),r._defaulted&&!Le(this.options,r)&&d(this,V).getQueryCache().notify({type:"observerOptionsUpdated",query:d(this,j),observer:this});const a=this.hasListeners();a&&kt(d(this,j),n,this.options,r)&&I(this,_,be).call(this),this.updateResult(),a&&(d(this,j)!==n||q(this.options.enabled,d(this,j))!==q(r.enabled,d(this,j))||ye(this.options.staleTime,d(this,j))!==ye(r.staleTime,d(this,j)))&&I(this,_,Be).call(this);const o=I(this,_,$e).call(this);a&&(d(this,j)!==n||q(this.options.enabled,d(this,j))!==q(r.enabled,d(this,j))||o!==d(this,ae))&&I(this,_,Ve).call(this,o)}getOptimisticResult(s){const r=d(this,V).getQueryCache().build(d(this,V),s),n=this.createResult(r,s);return sr(this,n)&&(M(this,U,n),M(this,ue,this.options),M(this,oe,d(this,j).state)),n}getCurrentResult(){return d(this,U)}trackResult(s,r){return new Proxy(s,{get:(n,a)=>(this.trackProp(a),r==null||r(a),a==="promise"&&!this.options.experimental_prefetchInRender&&d(this,ee).status==="pending"&&d(this,ee).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),Reflect.get(n,a))})}trackProp(s){d(this,pe).add(s)}getCurrentQuery(){return d(this,j)}refetch({...s}={}){return this.fetch({...s})}fetchOptimistic(s){const r=d(this,V).defaultQueryOptions(s),n=d(this,V).getQueryCache().build(d(this,V),r);return n.fetch().then(()=>this.createResult(n,r))}fetch(s){return I(this,_,be).call(this,{...s,cancelRefetch:s.cancelRefetch??!0}).then(()=>(this.updateResult(),d(this,U)))}createResult(s,r){var H;const n=d(this,j),a=this.options,o=d(this,U),l=d(this,oe),f=d(this,ue),x=s!==n?s.state:d(this,ve),{state:g}=s;let i={...g},m=!1,u;if(r._optimisticResults){const E=this.hasListeners(),k=!E&&Et(s,r),O=E&&kt(s,n,r,a);(k||O)&&(i={...i,...Rs(g.data,s.options)}),r._optimisticResults==="isRestoring"&&(i.fetchStatus="idle")}let{error:p,errorUpdatedAt:b,status:y}=i;u=i.data;let S=!1;if(r.placeholderData!==void 0&&u===void 0&&y==="pending"){let E;o!=null&&o.isPlaceholderData&&r.placeholderData===(f==null?void 0:f.placeholderData)?(E=o.data,S=!0):E=typeof r.placeholderData=="function"?r.placeholderData((H=d(this,me))==null?void 0:H.state.data,d(this,me)):r.placeholderData,E!==void 0&&(y="success",u=jt(o==null?void 0:o.data,E,r),m=!0)}if(r.select&&u!==void 0&&!S)if(o&&u===(l==null?void 0:l.data)&&r.select===d(this,je))u=d(this,he);else try{M(this,je,r.select),u=r.select(u),u=jt(o==null?void 0:o.data,u,r),M(this,he,u),M(this,ie,null)}catch(E){M(this,ie,E)}d(this,ie)&&(p=d(this,ie),u=d(this,he),b=Date.now(),y="error");const N=i.fetchStatus==="fetching",R=y==="pending",w=y==="error",F=R&&N,A=u!==void 0,T={status:y,fetchStatus:i.fetchStatus,isPending:R,isSuccess:y==="success",isError:w,isInitialLoading:F,isLoading:F,data:u,dataUpdatedAt:i.dataUpdatedAt,error:p,errorUpdatedAt:b,failureCount:i.fetchFailureCount,failureReason:i.fetchFailureReason,errorUpdateCount:i.errorUpdateCount,isFetched:i.dataUpdateCount>0||i.errorUpdateCount>0,isFetchedAfterMount:i.dataUpdateCount>x.dataUpdateCount||i.errorUpdateCount>x.errorUpdateCount,isFetching:N,isRefetching:N&&!R,isLoadingError:w&&!A,isPaused:i.fetchStatus==="paused",isPlaceholderData:m,isRefetchError:w&&A,isStale:Je(s,r),refetch:this.refetch,promise:d(this,ee),isEnabled:q(r.enabled,s)!==!1};if(this.options.experimental_prefetchInRender){const E=B=>{T.status==="error"?B.reject(T.error):T.data!==void 0&&B.resolve(T.data)},k=()=>{const B=M(this,ee,T.promise=yt());E(B)},O=d(this,ee);switch(O.status){case"pending":s.queryHash===n.queryHash&&E(O);break;case"fulfilled":(T.status==="error"||T.data!==O.value)&&k();break;case"rejected":(T.status!=="error"||T.error!==O.reason)&&k();break}}return T}updateResult(){const s=d(this,U),r=this.createResult(d(this,j),this.options);if(M(this,oe,d(this,j).state),M(this,ue,this.options),d(this,oe).data!==void 0&&M(this,me,d(this,j)),Le(r,s))return;M(this,U,r);const n=()=>{if(!s)return!0;const{notifyOnChangeProps:a}=this.options,o=typeof a=="function"?a():a;if(o==="all"||!o&&!d(this,pe).size)return!0;const l=new Set(o??d(this,pe));return this.options.throwOnError&&l.add("error"),Object.keys(d(this,U)).some(f=>{const h=f;return d(this,U)[h]!==s[h]&&l.has(h)})};I(this,_,qt).call(this,{listeners:n()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&I(this,_,Qe).call(this)}},V=new WeakMap,j=new WeakMap,ve=new WeakMap,U=new WeakMap,oe=new WeakMap,ue=new WeakMap,ee=new WeakMap,ie=new WeakMap,je=new WeakMap,he=new WeakMap,me=new WeakMap,le=new WeakMap,ce=new WeakMap,ae=new WeakMap,pe=new WeakMap,_=new WeakSet,be=function(s){I(this,_,qe).call(this);let r=d(this,j).fetch(this.options,s);return s!=null&&s.throwOnError||(r=r.catch(ze)),r},Be=function(){I(this,_,Ke).call(this);const s=ye(this.options.staleTime,d(this,j));if(Ue||d(this,U).isStale||!vt(s))return;const n=Ns(d(this,U).dataUpdatedAt,s)+1;M(this,le,Re.setTimeout(()=>{d(this,U).isStale||this.updateResult()},n))},$e=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(d(this,j)):this.options.refetchInterval)??!1},Ve=function(s){I(this,_,He).call(this),M(this,ae,s),!(Ue||q(this.options.enabled,d(this,j))===!1||!vt(d(this,ae))||d(this,ae)===0)&&M(this,ce,Re.setInterval(()=>{(this.options.refetchIntervalInBackground||Cs.isFocused())&&I(this,_,be).call(this)},d(this,ae)))},Qe=function(){I(this,_,Be).call(this),I(this,_,Ve).call(this,I(this,_,$e).call(this))},Ke=function(){d(this,le)&&(Re.clearTimeout(d(this,le)),M(this,le,void 0))},He=function(){d(this,ce)&&(Re.clearInterval(d(this,ce)),M(this,ce,void 0))},qe=function(){const s=d(this,V).getQueryCache().build(d(this,V),this.options);if(s===d(this,j))return;const r=d(this,j);M(this,j,s),M(this,ve,s.state),this.hasListeners()&&(r==null||r.removeObserver(this),s.addObserver(this))},qt=function(s){Dt.batch(()=>{s.listeners&&this.listeners.forEach(r=>{r(d(this,U))}),d(this,V).getQueryCache().notify({query:d(this,j),type:"observerResultsUpdated"})})},At);function tr(t,s){return q(s.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&s.retryOnMount===!1)}function Et(t,s){return tr(t,s)||t.state.data!==void 0&&We(t,s,s.refetchOnMount)}function We(t,s,r){if(q(s.enabled,t)!==!1&&ye(s.staleTime,t)!=="static"){const n=typeof r=="function"?r(t):r;return n==="always"||n!==!1&&Je(t,s)}return!1}function kt(t,s,r,n){return(t!==s||q(n.enabled,t)===!1)&&(!r.suspense||t.state.status!=="error")&&Je(t,r)}function Je(t,s){return q(s.enabled,t)!==!1&&t.isStaleByTime(ye(s.staleTime,t))}function sr(t,s){return!Le(t.getCurrentResult(),s)}var Wt=c.createContext(!1),rr=()=>c.useContext(Wt);Wt.Provider;function ir(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var ar=c.createContext(ir()),nr=()=>c.useContext(ar),or=(t,s)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(s.isReset()||(t.retryOnMount=!1))},lr=t=>{c.useEffect(()=>{t.clearReset()},[t])},cr=({result:t,errorResetBoundary:s,throwOnError:r,query:n,suspense:a})=>t.isError&&!s.isReset()&&!t.isFetching&&n&&(a&&t.data===void 0||Es(r,[t.error,n])),dr=t=>{if(t.suspense){const r=a=>a==="static"?a:Math.max(a??1e3,1e3),n=t.staleTime;t.staleTime=typeof n=="function"?(...a)=>r(n(...a)):r(n),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},ur=(t,s)=>t.isLoading&&t.isFetching&&!s,hr=(t,s)=>(t==null?void 0:t.suspense)&&s.isPending,Tt=(t,s,r)=>s.fetchOptimistic(t).catch(()=>{r.clearReset()});function mr(t,s,r){var i,m,u,p,b;const n=rr(),a=nr(),o=ks(),l=o.defaultQueryOptions(t);(m=(i=o.getDefaultOptions().queries)==null?void 0:i._experimental_beforeQuery)==null||m.call(i,l),l._optimisticResults=n?"isRestoring":"optimistic",dr(l),or(l,a),lr(a);const f=!o.getQueryCache().get(l.queryHash),[h]=c.useState(()=>new s(o,l)),x=h.getOptimisticResult(l),g=!n&&t.subscribed!==!1;if(c.useSyncExternalStore(c.useCallback(y=>{const S=g?h.subscribe(Dt.batchCalls(y)):ze;return h.updateResult(),S},[h,g]),()=>h.getCurrentResult(),()=>h.getCurrentResult()),c.useEffect(()=>{h.setOptions(l)},[l,h]),hr(l,x))throw Tt(l,h,a);if(cr({result:x,errorResetBoundary:a,throwOnError:l.throwOnError,query:o.getQueryCache().get(l.queryHash),suspense:l.suspense}))throw x.error;if((p=(u=o.getDefaultOptions().queries)==null?void 0:u._experimental_afterQuery)==null||p.call(u,l,x),l.experimental_prefetchInRender&&!Ue&&ur(x,n)){const y=f?Tt(l,h,a):(b=o.getQueryCache().get(l.queryHash))==null?void 0:b.promise;y==null||y.catch(ze).finally(()=>{h.updateResult()})}return l.notifyOnChangeProps?x:h.trackResult(x)}function ke(t,s){return mr(t,er)}/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pr=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],fr=Pt("ChevronLeft",pr);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xr=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],gr=Pt("LayoutGrid",xr);class br extends c.Component{getSnapshotBeforeUpdate(s){const r=this.props.childRef.current;if(r&&s.isPresent&&!this.props.isPresent){const n=r.offsetParent,a=Hs(n)&&n.offsetWidth||0,o=this.props.sizeRef.current;o.height=r.offsetHeight||0,o.width=r.offsetWidth||0,o.top=r.offsetTop,o.left=r.offsetLeft,o.right=a-o.width-o.left}return null}componentDidUpdate(){}render(){return this.props.children}}function yr({children:t,isPresent:s,anchorX:r,root:n}){const a=c.useId(),o=c.useRef(null),l=c.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:f}=c.useContext(Ks);return c.useInsertionEffect(()=>{const{width:h,height:x,top:g,left:i,right:m}=l.current;if(s||!o.current||!h||!x)return;const u=r==="left"?`left: ${i}`:`right: ${m}`;o.current.dataset.motionPopId=a;const p=document.createElement("style");f&&(p.nonce=f);const b=n??document.head;return b.appendChild(p),p.sheet&&p.sheet.insertRule(`
          [data-motion-pop-id="${a}"] {
            position: absolute !important;
            width: ${h}px !important;
            height: ${x}px !important;
            ${u}px !important;
            top: ${g}px !important;
          }
        `),()=>{b.contains(p)&&b.removeChild(p)}},[s]),e.jsx(br,{isPresent:s,childRef:o,sizeRef:l,children:c.cloneElement(t,{ref:o})})}const vr=({children:t,initial:s,isPresent:r,onExitComplete:n,custom:a,presenceAffectsLayout:o,mode:l,anchorX:f,root:h})=>{const x=Bt(jr),g=c.useId();let i=!0,m=c.useMemo(()=>(i=!1,{id:g,initial:s,isPresent:r,custom:a,onExitComplete:u=>{x.set(u,!0);for(const p of x.values())if(!p)return;n&&n()},register:u=>(x.set(u,!1),()=>x.delete(u))}),[r,x,n]);return o&&i&&(m={...m}),c.useMemo(()=>{x.forEach((u,p)=>x.set(p,!1))},[r]),c.useEffect(()=>{!r&&!x.size&&n&&n()},[r]),l==="popLayout"&&(t=e.jsx(yr,{isPresent:r,anchorX:f,root:h,children:t})),e.jsx(qs.Provider,{value:m,children:t})};function jr(){return new Map}const Ee=t=>t.key||"";function Mt(t){const s=[];return c.Children.forEach(t,r=>{c.isValidElement(r)&&s.push(r)}),s}const Sr=({children:t,custom:s,initial:r=!0,onExitComplete:n,presenceAffectsLayout:a=!0,mode:o="sync",propagate:l=!1,anchorX:f="left",root:h})=>{const[x,g]=Ws(l),i=c.useMemo(()=>Mt(t),[t]),m=l&&!x?[]:i.map(Ee),u=c.useRef(!0),p=c.useRef(i),b=Bt(()=>new Map),[y,S]=c.useState(i),[N,R]=c.useState(i);Gs(()=>{u.current=!1,p.current=i;for(let A=0;A<N.length;A++){const D=Ee(N[A]);m.includes(D)?b.delete(D):b.get(D)!==!0&&b.set(D,!1)}},[N,m.length,m.join("-")]);const w=[];if(i!==y){let A=[...i];for(let D=0;D<N.length;D++){const T=N[D],H=Ee(T);m.includes(H)||(A.splice(D,0,T),w.push(T))}return o==="wait"&&w.length&&(A=w),R(Mt(A)),S(i),null}const{forceRender:F}=c.useContext(Ys);return e.jsx(e.Fragment,{children:N.map(A=>{const D=Ee(A),T=l&&!x?!1:i===N||m.includes(D),H=()=>{if(b.has(D))b.set(D,!0);else return;let E=!0;b.forEach(k=>{k||(E=!1)}),E&&(F==null||F(),R(p.current),l&&(g==null||g()),n&&n())};return e.jsx(vr,{isPresent:T,initial:!u.current||r?void 0:!1,custom:s,presenceAffectsLayout:a,mode:o,root:h,onExitComplete:T?void 0:H,anchorX:f,children:A},D)})})};function wr({id:t,open:s,onOpenChange:r}){var l,f,h,x,g,i,m,u;const n=ke({queryKey:["companyDetails",t],queryFn:()=>_t.get(`/public/getCompanyDetails?company_id=${t}`),enabled:s&&!!t}),a=ke({queryKey:["companyShipments",t],queryFn:()=>_t.get(`/public/getCompanyShipments?company_id=${t}&limit=25&offset=0`),enabled:s&&!!t}),o=((l=n.data)==null?void 0:l.kpis)||{shipments_12m:0,last_activity:"—",top_route:void 0,top_carrier:void 0};return e.jsxs("div",{className:`fixed inset-0 z-50 ${s?"":"hidden"}`,children:[e.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>r(!1)}),e.jsxs("div",{className:"absolute right-0 top-0 h-full w-full md:w-[720px] bg-white rounded-l-2xl shadow-xl overflow-auto",children:[e.jsxs("div",{className:"p-4 border-b",children:[e.jsx("div",{className:"text-lg font-semibold truncate",children:((f=n.data)==null?void 0:f.name)||t}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Last activity ",o.last_activity||"—"]})]}),e.jsx("div",{className:"p-4",children:e.jsxs(Is,{defaultValue:"overview",children:[e.jsxs(Fs,{children:[e.jsx(Fe,{value:"overview",children:"Overview"}),e.jsx(Fe,{value:"shipments",children:"Shipments"}),e.jsx(Fe,{value:"ai",children:"AI Insights"})]}),e.jsx(Oe,{value:"overview",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsx(Pe,{children:e.jsxs(Ie,{className:"p-4",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Shipments (12m)"}),e.jsx("div",{className:"text-xl font-bold",children:((x=(h=o.shipments_12m)==null?void 0:h.toLocaleString)==null?void 0:x.call(h))||0})]})}),e.jsx(Pe,{children:e.jsxs(Ie,{className:"p-4",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Top Route"}),e.jsx("div",{className:"text-sm font-medium",children:o.top_route||"—"})]})}),e.jsx(Pe,{children:e.jsxs(Ie,{className:"p-4",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Top Carrier"}),e.jsx("div",{className:"text-sm font-medium",children:o.top_carrier||"—"})]})})]})}),e.jsx(Oe,{value:"shipments",children:e.jsx("div",{className:"overflow-auto rounded border",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"sticky top-0 bg-white",children:e.jsxs("tr",{className:"[&>th]:py-2 [&>th]:text-left",children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Mode"}),e.jsx("th",{children:"Origin"}),e.jsx("th",{children:"Destination"}),e.jsx("th",{children:"Carrier"}),e.jsx("th",{children:"Value (USD)"}),e.jsx("th",{children:"Weight (kg)"})]})}),e.jsxs("tbody",{children:[(i=(g=a.data)==null?void 0:g.rows)==null?void 0:i.map((p,b)=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{children:p.shipped_on}),e.jsx("td",{className:"capitalize",children:String(p.mode||"").toLowerCase()}),e.jsx("td",{children:p.origin}),e.jsx("td",{children:p.destination}),e.jsx("td",{children:p.carrier||"—"}),e.jsx("td",{children:typeof p.value_usd=="number"||typeof p.value_usd=="string"&&p.value_usd?Number(p.value_usd).toLocaleString():"—"}),e.jsx("td",{children:typeof p.weight_kg=="number"||typeof p.weight_kg=="string"&&p.weight_kg?Number(p.weight_kg).toLocaleString():"—"})]},b)),!((u=(m=a.data)==null?void 0:m.rows)!=null&&u.length)&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"py-8 text-center text-gray-500",children:"No shipments for this range."})})]})]})})}),e.jsx(Oe,{value:"ai",children:e.jsx("div",{className:"text-sm text-gray-600",children:"Generate briefing coming soon."})})]})})]})]})}var Gt=["PageUp","PageDown"],Yt=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],Xt={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},xe="Slider",[Ge,_r,Nr]=$s(xe),[Zt,Ti]=Bs(xe,[Nr]),[Cr,Te]=Zt(xe),Jt=c.forwardRef((t,s)=>{const{name:r,min:n=0,max:a=100,step:o=1,orientation:l="horizontal",disabled:f=!1,minStepsBetweenThumbs:h=0,defaultValue:x=[n],value:g,onValueChange:i=()=>{},onValueCommit:m=()=>{},inverted:u=!1,form:p,...b}=t,y=c.useRef(new Set),S=c.useRef(0),R=l==="horizontal"?Rr:Er,[w=[],F]=Us({prop:g,defaultProp:x,onChange:k=>{var B;(B=[...y.current][S.current])==null||B.focus(),i(k)}}),A=c.useRef(w);function D(k){const O=Dr(w,k);E(k,O)}function T(k){E(k,S.current)}function H(){const k=A.current[S.current];w[S.current]!==k&&m(w)}function E(k,O,{commit:B}={commit:!1}){const we=Or(o),ge=Lr(Math.round((k-n)/o)*o+n,we),ne=Ot(ge,[n,a]);F((X=[])=>{const Z=Mr(X,ne,O);if(Fr(Z,h*o)){S.current=Z.indexOf(ne);const _e=String(Z)!==String(X);return _e&&B&&m(Z),_e?Z:X}else return X})}return e.jsx(Cr,{scope:t.__scopeSlider,name:r,disabled:f,min:n,max:a,valueIndexToChangeRef:S,thumbs:y.current,values:w,orientation:l,form:p,children:e.jsx(Ge.Provider,{scope:t.__scopeSlider,children:e.jsx(Ge.Slot,{scope:t.__scopeSlider,children:e.jsx(R,{"aria-disabled":f,"data-disabled":f?"":void 0,...b,ref:s,onPointerDown:de(b.onPointerDown,()=>{f||(A.current=w)}),min:n,max:a,inverted:u,onSlideStart:f?void 0:D,onSlideMove:f?void 0:T,onSlideEnd:f?void 0:H,onHomeKeyDown:()=>!f&&E(n,0,{commit:!0}),onEndKeyDown:()=>!f&&E(a,w.length-1,{commit:!0}),onStepKeyDown:({event:k,direction:O})=>{if(!f){const ge=Gt.includes(k.key)||k.shiftKey&&Yt.includes(k.key)?10:1,ne=S.current,X=w[ne],Z=o*ge*O;E(X+Z,ne,{commit:!0})}}})})})})});Jt.displayName=xe;var[es,ts]=Zt(xe,{startEdge:"left",endEdge:"right",size:"width",direction:1}),Rr=c.forwardRef((t,s)=>{const{min:r,max:n,dir:a,inverted:o,onSlideStart:l,onSlideMove:f,onSlideEnd:h,onStepKeyDown:x,...g}=t,[i,m]=c.useState(null),u=fe(s,R=>m(R)),p=c.useRef(void 0),b=Vs(a),y=b==="ltr",S=y&&!o||!y&&o;function N(R){const w=p.current||i.getBoundingClientRect(),F=[0,w.width],D=et(F,S?[r,n]:[n,r]);return p.current=w,D(R-w.left)}return e.jsx(es,{scope:t.__scopeSlider,startEdge:S?"left":"right",endEdge:S?"right":"left",direction:S?1:-1,size:"width",children:e.jsx(ss,{dir:b,"data-orientation":"horizontal",...g,ref:u,style:{...g.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:R=>{const w=N(R.clientX);l==null||l(w)},onSlideMove:R=>{const w=N(R.clientX);f==null||f(w)},onSlideEnd:()=>{p.current=void 0,h==null||h()},onStepKeyDown:R=>{const F=Xt[S?"from-left":"from-right"].includes(R.key);x==null||x({event:R,direction:F?-1:1})}})})}),Er=c.forwardRef((t,s)=>{const{min:r,max:n,inverted:a,onSlideStart:o,onSlideMove:l,onSlideEnd:f,onStepKeyDown:h,...x}=t,g=c.useRef(null),i=fe(s,g),m=c.useRef(void 0),u=!a;function p(b){const y=m.current||g.current.getBoundingClientRect(),S=[0,y.height],R=et(S,u?[n,r]:[r,n]);return m.current=y,R(b-y.top)}return e.jsx(es,{scope:t.__scopeSlider,startEdge:u?"bottom":"top",endEdge:u?"top":"bottom",size:"height",direction:u?1:-1,children:e.jsx(ss,{"data-orientation":"vertical",...x,ref:i,style:{...x.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:b=>{const y=p(b.clientY);o==null||o(y)},onSlideMove:b=>{const y=p(b.clientY);l==null||l(y)},onSlideEnd:()=>{m.current=void 0,f==null||f()},onStepKeyDown:b=>{const S=Xt[u?"from-bottom":"from-top"].includes(b.key);h==null||h({event:b,direction:S?-1:1})}})})}),ss=c.forwardRef((t,s)=>{const{__scopeSlider:r,onSlideStart:n,onSlideMove:a,onSlideEnd:o,onHomeKeyDown:l,onEndKeyDown:f,onStepKeyDown:h,...x}=t,g=Te(xe,r);return e.jsx(Se.span,{...x,ref:s,onKeyDown:de(t.onKeyDown,i=>{i.key==="Home"?(l(i),i.preventDefault()):i.key==="End"?(f(i),i.preventDefault()):Gt.concat(Yt).includes(i.key)&&(h(i),i.preventDefault())}),onPointerDown:de(t.onPointerDown,i=>{const m=i.target;m.setPointerCapture(i.pointerId),i.preventDefault(),g.thumbs.has(m)?m.focus():n(i)}),onPointerMove:de(t.onPointerMove,i=>{i.target.hasPointerCapture(i.pointerId)&&a(i)}),onPointerUp:de(t.onPointerUp,i=>{const m=i.target;m.hasPointerCapture(i.pointerId)&&(m.releasePointerCapture(i.pointerId),o(i))})})}),rs="SliderTrack",is=c.forwardRef((t,s)=>{const{__scopeSlider:r,...n}=t,a=Te(rs,r);return e.jsx(Se.span,{"data-disabled":a.disabled?"":void 0,"data-orientation":a.orientation,...n,ref:s})});is.displayName=rs;var Ye="SliderRange",as=c.forwardRef((t,s)=>{const{__scopeSlider:r,...n}=t,a=Te(Ye,r),o=ts(Ye,r),l=c.useRef(null),f=fe(s,l),h=a.values.length,x=a.values.map(m=>ls(m,a.min,a.max)),g=h>1?Math.min(...x):0,i=100-Math.max(...x);return e.jsx(Se.span,{"data-orientation":a.orientation,"data-disabled":a.disabled?"":void 0,...n,ref:f,style:{...t.style,[o.startEdge]:g+"%",[o.endEdge]:i+"%"}})});as.displayName=Ye;var Xe="SliderThumb",ns=c.forwardRef((t,s)=>{const r=_r(t.__scopeSlider),[n,a]=c.useState(null),o=fe(s,f=>a(f)),l=c.useMemo(()=>n?r().findIndex(f=>f.ref.current===n):-1,[r,n]);return e.jsx(kr,{...t,ref:o,index:l})}),kr=c.forwardRef((t,s)=>{const{__scopeSlider:r,index:n,name:a,...o}=t,l=Te(Xe,r),f=ts(Xe,r),[h,x]=c.useState(null),g=fe(s,N=>x(N)),i=h?l.form||!!h.closest("form"):!0,m=Ls(h),u=l.values[n],p=u===void 0?0:ls(u,l.min,l.max),b=Ar(n,l.values.length),y=m==null?void 0:m[f.size],S=y?Pr(y,p,f.direction):0;return c.useEffect(()=>{if(h)return l.thumbs.add(h),()=>{l.thumbs.delete(h)}},[h,l.thumbs]),e.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[f.startEdge]:`calc(${p}% + ${S}px)`},children:[e.jsx(Ge.ItemSlot,{scope:t.__scopeSlider,children:e.jsx(Se.span,{role:"slider","aria-label":t["aria-label"]||b,"aria-valuemin":l.min,"aria-valuenow":u,"aria-valuemax":l.max,"aria-orientation":l.orientation,"data-orientation":l.orientation,"data-disabled":l.disabled?"":void 0,tabIndex:l.disabled?void 0:0,...o,ref:g,style:u===void 0?{display:"none"}:t.style,onFocus:de(t.onFocus,()=>{l.valueIndexToChangeRef.current=n})})}),i&&e.jsx(os,{name:a??(l.name?l.name+(l.values.length>1?"[]":""):void 0),form:l.form,value:u},n)]})});ns.displayName=Xe;var Tr="RadioBubbleInput",os=c.forwardRef(({__scopeSlider:t,value:s,...r},n)=>{const a=c.useRef(null),o=fe(a,n),l=zs(s);return c.useEffect(()=>{const f=a.current;if(!f)return;const h=window.HTMLInputElement.prototype,g=Object.getOwnPropertyDescriptor(h,"value").set;if(l!==s&&g){const i=new Event("input",{bubbles:!0});g.call(f,s),f.dispatchEvent(i)}},[l,s]),e.jsx(Se.input,{style:{display:"none"},...r,ref:o,defaultValue:s})});os.displayName=Tr;function Mr(t=[],s,r){const n=[...t];return n[r]=s,n.sort((a,o)=>a-o)}function ls(t,s,r){const o=100/(r-s)*(t-s);return Ot(o,[0,100])}function Ar(t,s){return s>2?`Value ${t+1} of ${s}`:s===2?["Minimum","Maximum"][t]:void 0}function Dr(t,s){if(t.length===1)return 0;const r=t.map(a=>Math.abs(a-s)),n=Math.min(...r);return r.indexOf(n)}function Pr(t,s,r){const n=t/2,o=et([0,50],[0,n]);return(n-o(s)*r)*r}function Ir(t){return t.slice(0,-1).map((s,r)=>t[r+1]-s)}function Fr(t,s){if(s>0){const r=Ir(t);return Math.min(...r)>=s}return!0}function et(t,s){return r=>{if(t[0]===t[1]||s[0]===s[1])return s[0];const n=(s[1]-s[0])/(t[1]-t[0]);return s[0]+n*(r-t[0])}}function Or(t){return(String(t).split(".")[1]||"").length}function Lr(t,s){const r=Math.pow(10,s);return Math.round(t*r)/r}var cs=Jt,zr=is,Ur=as,Br=ns;const ds=c.forwardRef(({className:t,...s},r)=>e.jsxs(cs,{ref:r,className:Ts("relative flex w-full touch-none select-none items-center",t),...s,children:[e.jsx(zr,{className:"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20",children:e.jsx(Ur,{className:"absolute h-full bg-primary"})}),e.jsx(Br,{className:"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"})]}));ds.displayName=cs.displayName;function $r(t){if(!t)return{};const s=t.data?t.data:t;return{origin_countries:Array.isArray(s.origin_countries)?s.origin_countries:Array.isArray(s.origins)?s.origins:[],destination_countries:Array.isArray(s.destination_countries)?s.destination_countries:Array.isArray(s.destinations)?s.destinations:[],modes:Array.isArray(s.modes)?s.modes:[],carriers:Array.isArray(s.carriers)?s.carriers:[],hs_prefixes:Array.isArray(s.hs_prefixes)?s.hs_prefixes:Array.isArray(s.hs_codes)?s.hs_codes:[]}}function Vr({onChange:t}){const[s,r]=c.useState({origins:[],destinations:[],modes:[],carriers:[],hs:[]}),[n,a]=c.useState(!1),[o,l]=c.useState({origin:"",destination:"",mode:"any",date_start:"",date_end:"",carrier:"",hs:[],hs_text:"",origin_city:"",origin_state:"",origin_zip:"",dest_city:"",dest_state:"",dest_zip:"",value_min:0,value_max:0}),{data:f,isLoading:h,error:x}=ke({queryKey:["filter-options"],queryFn:()=>Ds({}),staleTime:1e3*60*10});c.useEffect(()=>{if(f){const i=$r(f);r({origins:i.origin_countries.sort(),destinations:i.destination_countries.sort(),modes:i.modes.sort(),carriers:i.carriers.sort(),hs:i.hs_prefixes.sort()})}},[f]),c.useEffect(()=>{const i=setTimeout(()=>{t==null||t(o)},300);return()=>clearTimeout(i)},[o,t]);const g=(i,m)=>{if(i==="origin_city"||i==="dest_city"){l(u=>({...u,[i]:m}));return}if(i==="origin_state"||i==="dest_state"){const u=(m||"").toUpperCase().slice(0,2);l(p=>({...p,[i]:u}));return}if(i==="origin_zip"||i==="dest_zip"){const u=String(m||"").replace(/[^0-9]/g,"").slice(0,10);l(p=>({...p,[i]:u}));return}l(u=>({...u,[i]:m}))};return x?e.jsx("div",{className:"bg-red-50 border-l-4 border-red-400 p-4 rounded-md my-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Lt,{className:"h-5 w-5 text-red-400","aria-hidden":"true"})}),e.jsx("div",{className:"ml-3",children:e.jsxs("p",{className:"text-sm text-red-700",children:["Could not load search filters. Please try again later. (",x.message||String(x),")"]})})]})}):h?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6",children:Array.from({length:5}).map((i,m)=>e.jsxs("div",{className:"space-y-2",children:[e.jsx(Rt,{className:"h-4 w-24"}),e.jsx(Rt,{className:"h-10 w-full"})]},m))}):e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("button",{type:"button",className:"md:hidden inline-flex items-center px-3 py-2 text-sm rounded-lg border bg-white",onClick:()=>a(i=>!i),children:n?"Hide Filters":"Show Filters"}),e.jsx("div",{})]}),e.jsxs("div",{className:`${n?"grid":"hidden"} md:grid grid-cols-1 md:grid-cols-6 gap-4`,children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"origin",className:"block text-sm font-medium text-gray-700 mb-1",children:"Origin Country"}),e.jsxs("select",{id:"origin",value:o.origin,onChange:i=>g("origin",i.target.value),disabled:h,className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",children:[e.jsx("option",{value:"",children:"Any Origin"}),s.origins.map(i=>e.jsx("option",{value:i,children:i},i))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"destination",className:"block text-sm font-medium text-gray-700 mb-1",children:"Destination Country"}),e.jsxs("select",{id:"destination",value:o.destination,onChange:i=>g("destination",i.target.value),disabled:h,className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",children:[e.jsx("option",{value:"",children:"Any Destination"}),s.destinations.map(i=>e.jsx("option",{value:i,children:i},i))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"origin_city",className:"block text-sm font-medium text-gray-700 mb-1",children:"Origin City"}),e.jsx("input",{id:"origin_city",type:"text",value:o.origin_city,onChange:i=>g("origin_city",i.target.value),disabled:h,className:"block w-full pl-3 pr-2 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",placeholder:"e.g., Los Angeles"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"origin_state",className:"block text-sm font-medium text-gray-700 mb-1",children:"Origin State"}),e.jsx("input",{id:"origin_state",type:"text",value:o.origin_state,onChange:i=>g("origin_state",i.target.value.toUpperCase().slice(0,2)),disabled:h,className:"block w-full pl-3 pr-2 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",placeholder:"e.g., CA"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"origin_zip",className:"block text-sm font-medium text-gray-700 mb-1",children:"Origin ZIP"}),e.jsx("input",{id:"origin_zip",type:"text",inputMode:"numeric",pattern:"\\\\d*",value:o.origin_zip,onChange:i=>g("origin_zip",i.target.value.replace(/[^0-9]/g,"").slice(0,10)),disabled:h,className:"block w-full pl-3 pr-2 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",placeholder:"e.g., 90001"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"dest_city",className:"block text-sm font-medium text-gray-700 mb-1",children:"Destination City"}),e.jsx("input",{id:"dest_city",type:"text",value:o.dest_city,onChange:i=>g("dest_city",i.target.value),disabled:h,className:"block w-full pl-3 pr-2 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",placeholder:"e.g., Shanghai"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"dest_state",className:"block text-sm font-medium text-gray-700 mb-1",children:"Destination State"}),e.jsx("input",{id:"dest_state",type:"text",value:o.dest_state,onChange:i=>g("dest_state",i.target.value.toUpperCase().slice(0,2)),disabled:h,className:"block w-full pl-3 pr-2 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",placeholder:"e.g., NY"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"dest_zip",className:"block text-sm font-medium text-gray-700 mb-1",children:"Destination ZIP"}),e.jsx("input",{id:"dest_zip",type:"text",inputMode:"numeric",pattern:"\\\\d*",value:o.dest_zip,onChange:i=>g("dest_zip",i.target.value.replace(/[^0-9]/g,"").slice(0,10)),disabled:h,className:"block w-full pl-3 pr-2 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",placeholder:"e.g., 10001"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mode"}),e.jsx("div",{className:"flex items-center gap-4 text-sm",children:["any","air","ocean"].map(i=>e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"mode",value:i,checked:o.mode===i,onChange:m=>g("mode",m.target.value)}),e.jsx("span",{className:"capitalize",children:i})]},i))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"carrier",className:"block text-sm font-medium text-gray-700 mb-1",children:"Carrier"}),e.jsxs("select",{id:"carrier",value:o.carrier,onChange:i=>g("carrier",i.target.value),disabled:h,className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",children:[e.jsx("option",{value:"",children:"Any Carrier"}),s.carriers.map(i=>e.jsx("option",{value:i,children:i},i))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"hs_text",className:"block text-sm font-medium text-gray-700 mb-1",children:"HS Codes"}),e.jsx("input",{id:"hs_text",type:"text",value:o.hs_text,onChange:i=>g("hs_text",i.target.value),placeholder:"Enter HS codes (comma-separated), e.g., 8471, 8517, 9403",className:"block w-full pl-3 pr-2 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("div",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Shipment Value (USD)"}),e.jsxs("div",{className:"px-2",children:[e.jsx(ds,{min:0,max:1e6,step:1e4,value:[o.value_min,o.value_max||1e6],onValueChange:([i,m])=>l(u=>({...u,value_min:i,value_max:m}))}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-600 mt-1",children:[e.jsxs("span",{children:["$","{",o.value_min.toLocaleString(),"}"]}),e.jsxs("span",{children:["$","{",(o.value_max||1e6).toLocaleString(),"}"]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"date_start",className:"block text-sm font-medium text-gray-700 mb-1",children:"Date Start"}),e.jsx("input",{type:"date",id:"date_start",value:o.date_start,onChange:i=>g("date_start",i.target.value),className:"block w-full pl-3 pr-2 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"date_end",className:"block text-sm font-medium text-gray-700 mb-1",children:"Date End"}),e.jsx("input",{type:"date",id:"date_end",value:o.date_end,onChange:i=>g("date_end",i.target.value),className:"block w-full pl-3 pr-2 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md"})]})]})]})}function Qr({company:t,onSelect:s,onSave:r,isSaving:n,isSaved:a,isNew:o,onStartOutreach:l,onDraftRFP:f,savingCompanyId:h}){const x=b=>b?b>=1e6?`${(b/1e6).toFixed(1)}M`:b>=1e3?`${(b/1e3).toFixed(0)}K`:b.toLocaleString():"0",g=h===t.id,{shipments12m:i,lastActivity:m,originsTop:u,carriersTop:p}=Ft({company_id:t.company_id||t.id||null,company_name:t.company_name||t.name||"Unknown",shipments_12m:t.shipments_12m,shipments12m:t.shipments_12m,shipments:t.shipments,last_activity:t.last_seen,lastActivity:t.last_seen,lastShipmentDate:t.last_seen,origins_top:t.origins_top,originsTop:t.originsTop,dests_top:t.dests_top,destsTop:t.destsTop,carriers_top:t.carriers_top,carriersTop:t.carriersTop});return e.jsxs(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},whileHover:{y:-2},className:"bg-white/90 backdrop-blur-sm rounded-2xl p-4 md:p-5 shadow-lg border border-gray-200/60 hover:shadow-xl transition-all duration-300 cursor-pointer",onClick:()=>s(t),children:[o&&e.jsx("div",{className:"mb-3",children:e.jsx(Ut,{className:"bg-gradient-to-r from-green-500 to-emerald-500 text-white",children:"New Shipper"})}),e.jsx("div",{className:"flex justify-between items-start mb-4",children:e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-bold text-gray-900 truncate text-lg mb-1",children:t.name}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(St,{className:"w-3 h-3"}),e.jsxs("span",{children:["ID: ",t.id]})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-600 font-medium mb-1",children:[e.jsx(It,{className:"w-3 h-3"}),"Shipments (12M)"]}),e.jsx("div",{className:"text-lg font-bold text-blue-900",children:x(i)})]}),e.jsxs("div",{className:"bg-purple-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-purple-600 font-medium mb-1",children:[e.jsx($t,{className:"w-3 h-3"}),"Last Activity"]}),e.jsx("div",{className:"text-sm font-bold text-purple-900",children:m?Ht(new Date(m),"MMM d"):"N/A"})]})]}),e.jsxs("div",{className:"space-y-2 mb-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Vt,{className:"w-3 h-3 text-gray-500"}),e.jsx("span",{className:"text-gray-600",children:"Top Route:"}),e.jsx("span",{className:"font-medium text-gray-900 truncate flex-1",children:u!=null&&u[0]?`${u[0]} → `:t.origin&&t.destination?`${t.origin} → ${t.destination}`:"Various routes"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(St,{className:"w-3 h-3 text-gray-500"}),e.jsx("span",{className:"text-gray-600",children:"Top Carrier:"}),e.jsx("span",{className:"font-medium text-gray-900 truncate flex-1",children:(p==null?void 0:p[0])||"Multiple carriers"})]})]}),e.jsxs("div",{className:"flex gap-2 mt-1",onClick:b=>b.stopPropagation(),children:[e.jsxs(Y,{size:"sm",variant:"outline",onClick:()=>r(t),disabled:g||a,className:"flex-1",children:[g&&e.jsx(Qt,{className:"mr-2 h-3 w-3 animate-spin"}),a?e.jsx(zt,{className:"w-3 h-3 mr-1 text-blue-600"}):e.jsx(Kt,{className:"w-3 h-3 mr-1"}),a?"Saved":"Save"]}),e.jsx(Y,{size:"sm",onClick:b=>{b.stopPropagation(),a?window.location.href=`/app/companies/${t.id||t.company_id}`:s(t)},className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white",children:"View"})]})]})}function Kr({company:t,onSelect:s,onSave:r,isSaving:n,isSaved:a,isNew:o,onStartOutreach:l,onDraftRFP:f,savingCompanyId:h,index:x=0}){const g=y=>y?y>=1e6?`${(y/1e6).toFixed(1)}M`:y>=1e3?`${(y/1e3).toFixed(0)}K`:y.toLocaleString():"0",i=h===t.id,{shipments12m:m,lastActivity:u,originsTop:p,carriersTop:b}=Ft({company_id:t.company_id||t.id||null,company_name:t.company_name||t.name||"Unknown",shipments_12m:t.shipments_12m,shipments12m:t.shipments_12m,shipments:t.shipments,last_activity:t.last_seen,lastActivity:t.last_seen,lastShipmentDate:t.last_seen,origins_top:t.origins_top,originsTop:t.originsTop,dests_top:t.dests_top,destsTop:t.destsTop,carriers_top:t.carriers_top,carriersTop:t.carriersTop});return e.jsx(Ze.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:x*.05},className:"p-4 hover:bg-gray-50 transition-all duration-200 cursor-pointer border-b border-gray-100 last:border-b-0",onClick:()=>s(t),children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0 pr-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900 truncate",children:t.company_name||t.name}),o&&e.jsx(Ut,{className:"bg-gradient-to-r from-green-500 to-emerald-500 text-white text-xs",children:"New"})]}),e.jsxs("p",{className:"text-xs text-gray-600 mb-2",children:["ID: ",t.company_id||t.id]}),e.jsx("p",{className:"text-sm text-gray-700 line-clamp-2 mb-2",children:(t.summary||t.description||`Top route ${t.top_route||"various"}; top carrier ${t.top_carrier||"various"}.`).toString()}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-xs text-gray-600",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(It,{className:"w-3 h-3"})," Shipments (12M): ",e.jsx("b",{className:"text-gray-900 ml-1",children:g(m)})]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx($t,{className:"w-3 h-3"})," Last: ",e.jsx("b",{className:"text-gray-900 ml-1",children:u?Ht(new Date(u),"MMM d"):"N/A"})]}),e.jsxs("span",{className:"hidden md:flex items-center gap-1",children:[e.jsx(Vt,{className:"w-3 h-3"})," Route: ",e.jsx("b",{className:"text-gray-900 ml-1 truncate max-w-[220px]",children:(p==null?void 0:p[0])||t.top_route||"Various"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",onClick:y=>y.stopPropagation(),children:[e.jsxs(Y,{size:"sm",variant:"outline",onClick:()=>r(t),disabled:i||a,children:[i&&e.jsx(Qt,{className:"mr-2 h-3 w-3 animate-spin"}),a?e.jsx(zt,{className:"w-3 h-3 mr-1 text-blue-600"}):e.jsx(Kt,{className:"w-3 h-3 mr-1"}),a?"Saved":"Save"]}),e.jsx(Y,{size:"sm",onClick:()=>{a?window.location.href=`/app/companies/${t.id||t.company_id}`:s(t)},className:"bg-blue-600 hover:bg-blue-700 text-white",children:"View"})]})]})})}function Hr({searchResults:t,totalResults:s,isLoading:r,onCompanySelect:n,onSave:a,onStartOutreach:o,onDraftRFP:l,user:f,newShipperEvents:h,savedCompanyIds:x,savingCompanyId:g,viewMode:i,setViewMode:m,currentPage:u,totalPages:p,onPageChange:b}){const y=t&&t.length>0;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Search Results"}),!r&&e.jsxs("p",{className:"text-gray-500 text-sm mt-1",children:["Found ",Number(s||0).toLocaleString()," companies • Showing ",(t==null?void 0:t.length)||0," on this page"]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-1 bg-gray-100 p-1 rounded-lg",children:[e.jsxs(Y,{size:"sm",variant:i==="grid"?"secondary":"ghost",onClick:()=>m("grid"),className:"h-8 px-3",children:[e.jsx(gr,{className:"w-4 h-4 mr-1"}),"Cards"]}),e.jsxs(Y,{size:"sm",variant:i==="list"?"secondary":"ghost",onClick:()=>m("list"),className:"h-8 px-3",children:[e.jsx(Zs,{className:"w-4 h-4 mr-1"}),"List"]})]}),p>1&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Y,{variant:"outline",size:"sm",onClick:()=>b(u-1),disabled:u===1||r,className:"h-8",children:e.jsx(fr,{className:"h-4 w-4"})}),e.jsxs("span",{className:"text-sm text-gray-600 px-2",children:["Page ",u," of ",p]}),e.jsx(Y,{variant:"outline",size:"sm",onClick:()=>b(u+1),disabled:u>=p||r,className:"h-8",children:e.jsx(Xs,{className:"h-4 w-4"})})]})]})]}),r?e.jsx("div",{className:`grid gap-4 md:gap-6 ${i==="grid"?"grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4":"grid-cols-1"}`,children:Array.from({length:12}).map((S,N)=>e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-4"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2 mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/3 mb-4"}),e.jsx("div",{className:"h-16 bg-gray-200 rounded mb-4"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded flex-1"}),e.jsx("div",{className:"h-8 bg-gray-200 rounded flex-1"})]})]},N))}):y?e.jsxs("div",{className:`grid gap-4 md:gap-6 ${i==="grid"?"grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4":"grid-cols-1"}`,children:[e.jsx(Sr,{children:t.map(S=>{const N=S.company_id||S.id,R=g===N,w=x.has(N),F=h.includes(N);return i==="grid"?e.jsx(Qr,{company:S,onSelect:n,onSave:a,isSaving:R,isSaved:w,isNew:F,onStartOutreach:o,onDraftRFP:l,savingCompanyId:g},N):e.jsx(Kr,{company:S,onSelect:n,onSave:a,isSaving:R,isSaved:w,isNew:F,onStartOutreach:o,onDraftRFP:l,savingCompanyId:g},N)})}),u<p&&e.jsx("div",{className:"col-span-full flex justify-center mt-2",children:e.jsx(Y,{variant:"outline",onClick:()=>b(u+1),disabled:r,children:"Load More"})})]}):e.jsxs(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center py-16 bg-white rounded-2xl border border-dashed border-gray-300",children:[e.jsx(Lt,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-4 text-lg font-medium text-gray-900",children:"No results found"}),e.jsx("p",{className:"mt-2 text-sm text-gray-500 max-w-sm mx-auto",children:"Try adjusting your search query or filters to find companies."})]})]})}const J=50;function Mi(){var rt,it,at,nt,ot;const t=Ms(),{user:s}=As(),[r,n]=c.useState(""),[a,o]=c.useState({mode:"any",origin:"",destination:"",carrier:"",hs:[],date_start:null,date_end:null}),[l,f]=c.useState([]),[h,x]=c.useState(!1),[g,i]=c.useState(""),[m,u]=c.useState(null),[p,b]=c.useState(!1),[y,S]=c.useState(!1),[N,R]=c.useState(""),[w,F]=c.useState(1),[A,D]=c.useState(0),[T,H]=c.useState(new Set),[E,k]=c.useState(null),[O,B]=c.useState(null),[we,ge]=c.useState("grid"),[ne,X]=c.useState(!1),[Z,_e]=c.useState(""),[Me,us]=c.useState(!1);c.useEffect(()=>{const v=setTimeout(()=>i(r),300);return()=>clearTimeout(v)},[r]),c.useEffect(()=>{Me&&Ne(1)},[g,a]);const hs=c.useMemo(()=>Math.max(1,Math.ceil((A||0)/J)),[A]),Ne=c.useCallback(async v=>{const z=v||1;x(!0),B(null),F(z),us(!0);try{const $=(z-1)*J,K=P=>String(P).replace(/["']/g,"").trim(),Q=(a.hs_text||"").split(",").map(K).filter(Boolean),G=((Array.isArray(a.hs)?Array.from(new Set([...a.hs,...Q])):Q)||[]).map(P=>P.replace(/[^0-9]/g,"")).filter(Boolean),te=a.mode&&a.mode!=="any"?a.mode==="air"?"air":"ocean":void 0,se=a.origin?[K(a.origin)]:[],gs=a.destination?[K(a.destination)]:[],lt=K(r||""),bs={...lt?{q:lt}:{},...te?{mode:te}:{},origin:se,dest:gs,hs:G,limit:J,offset:$},re=await Nt(bs),ct=Array.isArray(re==null?void 0:re.items)?re.items:[],ys=typeof(re==null?void 0:re.total)=="number"?re.total:ct.length,vs=ct.map(P=>{var ut,ht,mt,pt,ft,xt,gt;const Ce=P.company_id||P.id||((pt=(ht=(ut=P.company_name||"").toLowerCase)==null?void 0:(mt=ht.call(ut)).replace)==null?void 0:pt.call(mt,/[^a-z0-9]+/g,"-"))||void 0,js=P.company_name||"Unknown",Ss=Array.isArray(P.originsTop)&&Array.isArray(P.destsTop)?`${((ft=P.originsTop[0])==null?void 0:ft.v)||""} → ${((xt=P.destsTop[0])==null?void 0:xt.v)||""}`.trim():void 0,ws=Array.isArray(P.carriersTop)&&((gt=P.carriersTop[0])==null?void 0:gt.v)||void 0;return{id:Ce,company_id:P.company_id||null,name:js,shipments_12m:P.shipments||0,last_seen:P.lastShipmentDate||null,top_route:Ss,top_carrier:ws}}),dt=new Set,Ae=[];for(const P of vs){const Ce=P.company_id||`name:${P.name}`;if(!dt.has(Ce)&&(dt.add(Ce),Ae.push(P),Ae.length>=J))break}f(Ae),D(ys)}catch($){console.error("Search error:",$),B(($==null?void 0:$.message)&&String($.message)||"Search failed. Please try again."),f([]),D(0)}finally{x(!1)}},[r,a]),tt=c.useMemo(()=>{const v=se=>String(se).replace(/["']/g,"").trim(),z=(a.hs_text||"").split(",").map(v).filter(Boolean),K=((Array.isArray(a.hs)?Array.from(new Set([...a.hs,...z])):z)||[]).map(se=>se.replace(/[^0-9]/g,"")).filter(Boolean),Q=a.mode&&a.mode!=="any"?a.mode==="air"?"AIR":"OCEAN":void 0,C=a.origin?[v(a.origin)]:void 0,G=a.destination?[v(a.destination)]:void 0,te=v(r||"");return{...te?{q:te}:{},...Q?{mode:Q}:{},...C?{origin:C}:{},...G?{dest:G}:{},...K.length?{hs:K}:{},limit:J,offset:(w-1)*J}},[a,w,r]),W=ke({queryKey:["searchCompanies",tt],queryFn:async()=>{const v=await Nt(tt),$=(Array.isArray(v==null?void 0:v.items)?v.items:[]).map(C=>{var G,te,se;return{id:C.company_id||(C.company_name||"").toLowerCase().replace(/[^a-z0-9]+/g,"-"),company_id:C.company_id||null,name:C.company_name||"Unknown",shipments_12m:C.shipments||0,last_seen:C.lastShipmentDate||null,top_route:Array.isArray(C.originsTop)&&Array.isArray(C.destsTop)?`${((G=C.originsTop[0])==null?void 0:G.v)||""} → ${((te=C.destsTop[0])==null?void 0:te.v)||""}`.trim():void 0,top_carrier:Array.isArray(C.carriersTop)&&((se=C.carriersTop[0])==null?void 0:se.v)||void 0}}),K=new Set,Q=[];for(const C of $){const G=C.company_id||`name:${C.name}`;if(!K.has(G)&&(K.add(G),Q.push(C),Q.length>=J))break}return{rows:Q,meta:{total:v.total||Q.length,page:w,page_size:J}}},keepPreviousData:!0,enabled:Me}),ms=c.useCallback(v=>{u(v),_e(String((v==null?void 0:v.id)||(v==null?void 0:v.company_id)||"")),X(!0)},[]),st=async v=>{if(E)return;const z=v.id;k(z);const $=new Set(T),K=$.has(z),Q=new Set($);K||Q.add(z),H(Q);try{const C=await Ps({company_id:String(v.company_id||v.id||""),company_name:String(v.name||v.company_name||"Unknown"),source:"search"});if(!C||!(C.status==="created"||C.status==="exists"))throw new Error("Save failed")}catch(C){console.error("Failed to save company:",C),H($),alert("Failed to save company. Please try again.")}finally{k(null)}},ps=v=>{const z=v.id;z&&t(Ct("EmailCenter?company_id="+z))},fs=v=>{const z=v.id;z&&t(Ct("RFPStudio?company_id="+z))},xs=v=>{v>=1&&v<=hs&&!h&&Ne(v)};return e.jsxs("div",{className:"p-4 md:p-6 lg:p-8 bg-gradient-to-br from-gray-50 to-blue-50/30 min-h-screen",children:[e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center mb-6 lg:mb-8 gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl lg:text-4xl font-bold text-gray-900",children:"Trade Intelligence Discovery"}),e.jsx("p",{className:"text-gray-600 mt-2 text-sm md:text-base",children:"Search companies by trade activity, routes, commodities, and shipping patterns"})]})}),e.jsx("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg p-4 md:p-6 mb-6 md:mb-8 border border-gray-200/60",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Os,{value:r,onChange:v=>n(v.target.value),placeholder:"Search by company name or alias (e.g., UPS, Maersk)...",className:"pl-4 pr-12 py-3 text-base md:text-lg bg-gray-50 border-0 rounded-xl",onKeyDown:v=>{v.key==="Enter"&&Ne(1)}}),e.jsx(wt,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"})]}),e.jsx(Y,{onClick:()=>Ne(1),disabled:h,className:"px-6 md:px-8 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white font-semibold rounded-xl",children:h?"Searching...":"Search"})]})}),e.jsx(Vr,{onChange:o}),O&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 mb-6",children:e.jsxs("div",{className:"flex items-center gap-2 text-red-800",children:[e.jsx("span",{className:"font-semibold",children:"Search Error:"}),e.jsx("span",{children:O})]})}),Me?e.jsx(Hr,{searchResults:(rt=W.data)!=null&&rt.rows&&W.data.rows.length>0?W.data.rows:l,totalResults:(at=(it=W.data)==null?void 0:it.meta)!=null&&at.total&&W.data.meta.total>0?W.data.meta.total:A,isLoading:h||W.isLoading,onCompanySelect:ms,onSave:st,onStartOutreach:ps,onDraftRFP:fs,user:s,newShipperEvents:[],savedCompanyIds:T,savingCompanyId:E,viewMode:we,setViewMode:ge,currentPage:w,totalPages:Math.max(1,Math.ceil(((ot=(nt=W.data)==null?void 0:nt.meta)!=null&&ot.total&&W.data.meta.total>0?W.data.meta.total:A)/J||1)),onPageChange:xs}):e.jsxs("div",{className:"text-center py-16 bg-white rounded-2xl border border-dashed border-gray-300",children:[e.jsx(wt,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Ready to Search"}),e.jsx("p",{className:"text-sm text-gray-500 max-w-sm mx-auto",children:"Enter a company name or use the filters above to search for trade intelligence data."})]}),e.jsx(Js,{isOpen:y,onClose:()=>S(!1),feature:N,currentPlan:s==null?void 0:s.plan}),e.jsx(Qs,{company:m,isOpen:p,onClose:()=>b(!1),onSave:st,user:s,isSaved:T.has(m==null?void 0:m.id)})]}),e.jsx(wr,{id:Z,open:ne,onOpenChange:X})]})}export{Mi as default};
