import{r as l,j as e,C as N,d as S,e as $,b as w,B as c}from"./main-BZRqBlOv.js";import{I as o}from"./input-Da-JHSvk.js";import{S as Q,b as O,d as D,e as E,f as I}from"./select-gPitKIWD.js";import{calcTariff as H,generateQuote as B}from"./api-Dja8NWTl.js";import{sendEmail as G}from"./functions-BRl0ajzq.js";import"./index-3bglh6Gv.js";function z(){const[d,u]=l.useState({hsCode:"",origin:"",destination:"",valueUsd:""}),[v,L]=l.useState(null),[f,j]=l.useState(!1),[h,U]=l.useState(""),[x,m]=l.useState([{origin:"",destination:"",mode:"ocean"}]),[p,T]=l.useState(""),[s,k]=l.useState(null),[y,C]=l.useState(!1),b=l.useMemo(()=>{var t,n;const a=((s==null?void 0:s.items)||[]).map(r=>`${r.origin} → ${r.destination} (${r.mode}) - $${r.priceUsd}`).join("<br/>");return`<!doctype html><meta charset="utf-8"><title>Quote ${(s==null?void 0:s.quoteId)||""}</title><style>body{font-family:Inter,system-ui,-apple-system,sans-serif;padding:24px;color:#111}</style><h1>Quote ${(s==null?void 0:s.quoteId)||""}</h1><div>Company: ${h||"—"}</div><div>Notes: ${p||"—"}</div><h2>Lanes</h2><div>${a||"No lanes"}</div><div>Total: ${((t=s==null?void 0:s.totals)==null?void 0:t.currency)||"USD"} ${((n=s==null?void 0:s.totals)==null?void 0:n.amount)||0}</div>`},[s,h,p]);return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Widgets"})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(N,{className:"rounded-lg shadow-md border border-gray-200",children:[e.jsx(S,{children:e.jsx($,{children:"Tariff Calculator"})}),e.jsxs(w,{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsx(o,{placeholder:"HS Code",value:d.hsCode,onChange:a=>u(t=>({...t,hsCode:a.target.value}))}),e.jsx(o,{placeholder:"Value (USD)",type:"number",value:d.valueUsd,onChange:a=>u(t=>({...t,valueUsd:Number(a.target.value||0)}))}),e.jsx(o,{placeholder:"Origin (Country)",value:d.origin,onChange:a=>u(t=>({...t,origin:a.target.value}))}),e.jsx(o,{placeholder:"Destination (Country)",value:d.destination,onChange:a=>u(t=>({...t,destination:a.target.value}))})]}),e.jsx(c,{onClick:async()=>{try{j(!0);const a=await H({...d,valueUsd:Number(d.valueUsd)||0});L(a)}finally{j(!1)}},disabled:f,className:"bg-blue-600 text-white hover:bg-blue-700",children:f?"Calculating…":"Calculate"}),v&&e.jsx("pre",{className:"text-xs bg-gray-50 border rounded p-3 overflow-auto",children:JSON.stringify(v,null,2)})]})]}),e.jsxs(N,{className:"rounded-lg shadow-md border border-gray-200",children:[e.jsx(S,{children:e.jsx($,{children:"Quote Generator"})}),e.jsxs(w,{className:"space-y-3",children:[e.jsx(o,{placeholder:"Company ID (optional)",value:h,onChange:a=>U(a.target.value)}),e.jsxs("div",{className:"space-y-2",children:[x.map((a,t)=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:[e.jsx(o,{placeholder:"Origin",value:a.origin,onChange:n=>m(r=>r.map((i,g)=>g===t?{...i,origin:n.target.value}:i))}),e.jsx(o,{placeholder:"Destination",value:a.destination,onChange:n=>m(r=>r.map((i,g)=>g===t?{...i,destination:n.target.value}:i))}),e.jsxs(Q,{value:a.mode,onValueChange:n=>m(r=>r.map((i,g)=>g===t?{...i,mode:n}:i)),children:[e.jsx(O,{children:e.jsx(D,{placeholder:"Mode"})}),e.jsxs(E,{children:[e.jsx(I,{value:"ocean",children:"Ocean"}),e.jsx(I,{value:"air",children:"Air"})]})]})]},t)),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(c,{variant:"outline",onClick:()=>m(a=>[...a,{origin:"",destination:"",mode:"ocean"}]),children:"Add Lane"}),x.length>1&&e.jsx(c,{variant:"outline",onClick:()=>m(a=>a.slice(0,-1)),children:"Remove"})]})]}),e.jsx(o,{placeholder:"Notes (optional)",value:p,onChange:a=>T(a.target.value)}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(c,{onClick:async()=>{try{C(!0);const a=await B({companyId:h,lanes:x,notes:p});k(a)}finally{C(!1)}},disabled:y,className:"bg-green-600 text-white hover:bg-green-700",children:y?"Generating…":"Generate Quote"}),s&&e.jsxs(e.Fragment,{children:[e.jsx(c,{variant:"outline",onClick:()=>{const a=new Blob([b],{type:"text/html"}),t=URL.createObjectURL(a),n=document.createElement("a");n.href=t,n.download=`quote-${(s==null?void 0:s.quoteId)||"draft"}.html`,n.click(),URL.revokeObjectURL(t)},children:"Download HTML"}),e.jsx(c,{variant:"outline",onClick:async()=>{try{await G({subject:`Quote ${(s==null?void 0:s.quoteId)||""}`,html:b,to:[]}),alert("Email sent (if configured)")}catch{alert("Failed to send email")}},children:"Email"})]})]}),s&&e.jsx("pre",{className:"text-xs bg-gray-50 border rounded p-3 overflow-auto",children:JSON.stringify(s,null,2)})]})]})]})]})}export{z as default};
